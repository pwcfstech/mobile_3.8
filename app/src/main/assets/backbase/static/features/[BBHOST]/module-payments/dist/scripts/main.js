!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t(require("base"),require("core"),require("ui")):"function"==typeof define&&define.amd?define(["base","core","ui"],t):"object"==typeof exports?exports["module-payments"]=t(require("base"),require("core"),require("ui")):e["module-payments"]=t(e.base,e.core,e.ui)}(this,function(e,t,n){return function(e){function t(a){if(n[a])return n[a].exports;var r=n[a]={exports:{},id:a,loaded:!1};return e[a].call(r.exports,r,r.exports,t),r.loaded=!0,r.exports}var n={};return t.m=e,t.c=n,t.p="",t(0)}([function(e,t,n){var a;(function(e){a=function(e,t,a){"use strict";a.name="module-payments";var r=n(2),i=[n(3).name,n(4).name,n(8).name,n(10).name,n(13).name];a.exports=r.createModule(a.name,i).constant(n(30)).provider(n(31)).provider(n(32)).service(n(33))}.call(t,n,t,e),!(void 0!==a&&(e.exports=a))}).call(t,n(1)(e))},function(e,t){e.exports=function(e){return e.webpackPolyfill||(e.deprecate=function(){},e.paths=[],e.children=[],e.webpackPolyfill=1),e}},function(t,n){t.exports=e},function(e,n){e.exports=t},function(e,t,n){var a;(function(e){a=function(e,t,a){"use strict";a.name="scheduled-transfer";var r=n(2),i=n(3),o=n(5),s=[i.name,o.name];a.exports=r.createModule(a.name,s).directive(n(6))}.call(t,n,t,e),!(void 0!==a&&(e.exports=a))}).call(t,n(1)(e))},function(e,t){e.exports=n},function(e,t,n){var a;a=function(e,t,a){"use strict";var r=n(7);t.lpScheduledTransfer=function(e){function t(e,t,n,a){var i,o=a[0],s=a[1],c=function(){return e.scheduledTransfer.frequency===e.frequenciesEnum.WEEKLY||e.scheduledTransfer.frequency===e.frequenciesEnum.MONTHLY||e.scheduledTransfer.frequency===e.frequenciesEnum.YEARLY},l=function(){var t=!1;if(e.scheduledTransfer.intervals.length>0&&e.scheduledTransfer.frequency===e.frequenciesEnum.MONTHLY)for(var n=28;31>n;n++)e.dates[n].active&&(t=!0);e.dateWarning=t},u=function(){var t=!0;t=e.scheduledTransfer.intervals.length>0?!0:!1,t=e.customOrder?t:!0,t=e.isScheduledTransfer?t:!0,o.$setValidity("intervalsRequired",t)},d=function(){var t,n;for(e.scheduledTransfer.intervals=[],t=0,n=e.days.length;n>t;t++)e.days[t].active=!1;for(t=0,n=e.dates.length;n>t;t++)e.dates[t].active=!1;for(t=0,n=e.months.length;n>t;t++)e.months[t].active=!1},p=function(){e.todaysDate=new Date,e.minEndDate=new Date,e.frequenciesEnum={START_OF_THE_MONTH:"START_OF_THE_MONTH",END_OF_THE_MONTH:"END_OF_THE_MONTH",LAST_FRIDAY_OF_THE_MONTH:"LAST_FRIDAY_OF_THE_MONTH",WEEKLY:"WEEKLY",MONTHLY:"MONTHLY",YEARLY:"YEARLY"},i=new r({frequencies:e.frequenciesEnum}),e.frequencies||(e.frequencies=[{id:e.frequenciesEnum.START_OF_THE_MONTH,value:"First of the month",group:"apreset"},{id:e.frequenciesEnum.END_OF_THE_MONTH,value:"End of the month",group:"apreset"},{id:e.frequenciesEnum.LAST_FRIDAY_OF_THE_MONTH,value:"Last Friday of the month",group:"apreset"},{id:e.frequenciesEnum.WEEKLY,value:"Weekly",group:"bcustom"},{id:e.frequenciesEnum.MONTHLY,value:"Monthly",group:"bcustom"},{id:e.frequenciesEnum.YEARLY,value:"Yearly",group:"bcustom"}]),e.days=[{id:1,value:"M",label:"Monday",active:!1},{id:2,value:"T",label:"Tuesday",active:!1},{id:3,value:"W",label:"Wednesday",active:!1},{id:4,value:"T",label:"Thursday",active:!1},{id:5,value:"F",label:"Friday",active:!1},{id:6,value:"S",label:"Saturday",active:!1},{id:7,value:"S",label:"Sunday",active:!1}],e.months=[{id:1,value:"Jan",label:"January",active:!1},{id:2,value:"Feb",label:"February",active:!1},{id:3,value:"Mar",label:"March",active:!1},{id:4,value:"Apr",label:"April",active:!1},{id:5,value:"May",label:"May",active:!1},{id:6,value:"Jun",label:"June",active:!1},{id:7,value:"Jul",label:"July",active:!1},{id:8,value:"Aug",label:"August",active:!1},{id:9,value:"Sep",label:"September",active:!1},{id:10,value:"Oct",label:"October",active:!1},{id:11,value:"Nov",label:"November",active:!1},{id:12,value:"Dec",label:"December",active:!1}],e.dates=[];for(var t=1;32>t;t++)e.dates.push({id:t,value:t,label:t,active:!1});e.endOptions||(e.endOptions=[{id:"after",value:"After"},{id:"onDate",value:"On date"}]),e.scheduledTransfer.endOn=e.endOptions[0].id,e.customOrder=!1,e.dateWarning=!1,e.calendar={startCalendarOpen:!1,endCalendarOpen:!1},e.endDateOptions={"show-weeks":!1},e.startDateOptions={"show-weeks":!1},e.timesEndDate=e.scheduledTransfer.endDate,e.setEndDate()};o.$name="scheduledTransfer",s.$addControl(o),o.$formatters.push(function(t){if(t.intervals.length>0){var n,a;if(t.frequency===e.frequenciesEnum.WEEKLY){for(n=0;n<t.intervals.length;n++)for(a=0;a<e.days.length;a++)if(t.intervals[n]===e.days[a].id){e.days[a].active=!0;break}}else if(t.frequency===e.frequenciesEnum.MONTHLY){for(n=0;n<t.intervals.length;n++)for(a=0;a<e.dates.length;a++)if(t.intervals[n]===e.dates[a].id){e.dates[a].active=!0;break}}else if(t.frequency===e.frequenciesEnum.YEARLY)for(n=0;n<t.intervals.length;n++)for(a=0;a<e.months.length;a++)if(t.intervals[n]===e.months[a].id){e.months[a].active=!0;break}}e.scheduledTransfer.frequency=""===t.frequency?e.frequencies[0].id:t.frequency,c()?e.customOrder=!0:e.customOrder=!1,l(),e.setTransferPeriodDates()}),e.frequencyChanged=function(){d(),e.setTransferPeriodDates(),c()?(e.customOrder=!0,u(),e.scheduledTransfer.customOrder=!0):(e.customOrder=!1,o.$setValidity("intervalsRequired",!0),e.scheduledTransfer.customOrder=!1),l()},e.toggleInterval=function(t){var n,a;if(e.scheduledTransfer.frequency===e.frequenciesEnum.WEEKLY?n=e.days:e.scheduledTransfer.frequency===e.frequenciesEnum.MONTHLY?n=e.dates:e.scheduledTransfer.frequency===e.frequenciesEnum.YEARLY&&(n=e.months),a=n[t],a.active){var r=e.scheduledTransfer.intervals.indexOf(a.id);e.scheduledTransfer.intervals.splice(r,1)}else e.scheduledTransfer.intervals.push(a.id);a.active=!a.active,u(),l(),e.setEndDate()},e.openStartCalendar=function(t){("click"===t.type||32===t.which||13===t.which)&&(t.preventDefault(),t.stopPropagation(),e.calendar.endCalendarOpen=!1,e.calendar.startCalendarOpen=!e.calendar.startCalendarOpen)},e.openEndCalendar=function(t){("click"===t.type||32===t.which||13===t.which)&&(t.preventDefault(),t.stopPropagation(),e.calendar.startCalendarOpen=!1,e.calendar.endCalendarOpen=!e.calendar.endCalendarOpen)},e.setTransferPeriodDates=function(){"object"!=typeof e.scheduledTransfer.startDate&&(c()?e.scheduledTransfer.startDate=new Date(e.todaysDate.getTime()):e.scheduledTransfer.frequency===e.frequenciesEnum.END_OF_THE_MONTH?e.scheduledTransfer.startDate=i.getLastDayOfMonth():e.scheduledTransfer.frequency===e.frequenciesEnum.START_OF_THE_MONTH?e.scheduledTransfer.startDate=i.getFirstDayOfMonth():e.scheduledTransfer.frequency===e.frequenciesEnum.LAST_FRIDAY_OF_THE_MONTH&&(e.scheduledTransfer.startDate=i.getLastFridayOfMonth())),e.setEndDate()},e.setEndDate=function(){var t;if(e.scheduledTransfer.startDate){var n=new Date(e.scheduledTransfer.startDate.getTime());c()?(t=e.scheduledTransfer.timesToRepeat*e.scheduledTransfer.every,e.scheduledTransfer.frequency===e.frequenciesEnum.WEEKLY?n=i.addWeeksToDate(n,t):e.scheduledTransfer.frequency===e.frequenciesEnum.MONTHLY?n=i.addMonthsToDate(n,t):e.scheduledTransfer.frequency===e.frequenciesEnum.YEARLY&&(n=i.addYearsToDate(n,t))):(t=e.scheduledTransfer.timesToRepeat,t=e.scheduledTransfer.timesToRepeat,e.scheduledTransfer.frequency===e.frequenciesEnum.END_OF_THE_MONTH?n=i.getLastDayOfMonthPlusTime(n,t):e.scheduledTransfer.frequency===e.frequenciesEnum.START_OF_THE_MONTH?n=i.getFirstDayOfMonthPlusTime(n,t):e.scheduledTransfer.frequency===e.frequenciesEnum.LAST_FRIDAY_OF_THE_MONTH&&(n=i.getLastFridayOfMonthPlusTime(n,t))),e.scheduledTransfer.endDate=n,e.minEndDate=i.calculateMinimumEndDate(e.scheduledTransfer.frequency,e.scheduledTransfer.every,new Date(e.scheduledTransfer.startDate.getTime())),e.timesEndDate=new Date(e.scheduledTransfer.endDate.getTime()).toString("d-MMM-yyyy")}},e.$watch("isScheduledTransfer",function(e){u()}),e.$on("reset",function(){e.scheduledTransfer.frequency=e.frequencies[0].id,e.customOrder=!1,e.scheduledTransfer.customOrder=!1}),p()}return e.put("scheduled-transfer.html",'<div class="lp-scheduled-transfer">    <div class="lp-st-frequency lp-st-section clearfix">        <div class="pull-left lp-st-caption">Frequency1</div>        <div class="pull-left lp-st-control">            <div class="lp-st-frequency-dropdown" aria-label="frequency" dropdown-select="dropdown-select" ng-change="frequencyChanged()" ng-model="scheduledTransfer.frequency" ng-options="val.id as val.value group by val.group for val in frequencies"></div>        </div>    </div>    <div class="lp-st-start-date lp-st-section clearfix">        <div class="pull-left lp-st-caption">Start1</div>        <div class="pull-left lp-st-control calendar">            <input ng-click="openStartCalendar($event)" aria-label="start date" type="text" ng-required="isScheduledTransfer === true" name="startDate" ng-model="scheduledTransfer.startDate" datepicker-popup="d-MMM-yyyy" readonly="readonly" is-open="calendar.startCalendarOpen" datepicker-options="startDateOptions" min-date="todaysDate" class="form-control" lp-future-time="" show-button-bar="false" tabindex="0" ng-change="setEndDate()" ng-keypress="openStartCalendar($event)" />            <span ng-click="openStartCalendar($event)" class="lp-icon lp-icon-calendar calendar-icon"></span>        </div>    </div>    <div class="lp-st-end-on lp-st-section clearfix">        <div class="pull-left lp-st-caption">End</div>        <div class="pull-left lp-st-control">            <div class="lp-st-end-on-dropdown" aria-label="end on" dropdown-select="dropdown-select" ng-change="endOnChanged()" ng-model="scheduledTransfer.endOn" ng-options="val.id as val.value for val in endOptions"></div>        </div>    </div>    <div class="lp-st-end-after lp-st-section clearfix" ng-if="scheduledTransfer.endOn === \'after\'">        <div class="pull-left lp-st-caption">Repeat</div>        <div class="pull-left lp-st-control">            <input type="tel" lp-number-input="lp-number-input" lp-max-length="2" min="1" step="0" non-zero="non-zero" class="form-control" aria-label="times to repeat" name="timesToRepeat" aria-required="true" required="required" tabindex="0" ng-model="scheduledTransfer.timesToRepeat" ng-change="setEndDate()"  />        </div>    </div>    <p class="text-muted" ng-if="scheduledTransfer.endOn === \'after\' && timesEndDate.length > 0">Completion date: {{timesEndDate}}</p>    <div class="lp-st-end-date lp-st-section clearfix" ng-if="scheduledTransfer.endOn === \'onDate\'">        <div class="pull-left lp-st-caption">End date</div>        <div class="pull-left lp-st-control calendar">            <input ng-click="openEndCalendar($event)" aria-label="end date" type="text" ng-required="isScheduledTransfer === true" name="endDate" ng-model="scheduledTransfer.endDate" readonly="readonly" datepicker-popup="d-MMM-yyyy" is-open="calendar.endCalendarOpen" datepicker-options="endDateOptions" min-date="minEndDate"  class="form-control" lp-future-time="" show-button-bar="false" tabindex="0" ng-keypress="openEndCalendar($event)" />            <span ng-click="openEndCalendar($event)" class="lp-icon lp-icon-calendar calendar-icon"></span>        </div>    </div>    <p ng-if="dateWarning">Transfer will be put through on the last day of the month if the month is not long enough</p></div>'),{restrict:"AE",replace:!0,require:["ngModel","^form"],template:e.get("scheduled-transfer.html"),scope:{scheduledTransfer:"=ngModel",isScheduledTransfer:"=lpIsScheduledTransfer"},link:t}},t.lpScheduledTransfer.$inject=["$templateCache"]}.call(t,n,t,e),!(void 0!==a&&(e.exports=a))},function(e,t,n){var a;a=function(e,t,a){"use strict";var r=n(2),i=r.inject("lpCoreUtils",n(3).name),o=a.exports=function(e){var t=this;t.frequencies=e.frequencies};o.prototype.addWeeksToDate=function(e,t){return i.date(e).add(t,"weeks").toDate()},o.prototype.addMonthsToDate=function(e,t){return i.date(e).add(t,"months").toDate()},o.prototype.addYearsToDate=function(e,t){return i.date(e).add(t,"years").toDate()},o.prototype.getLastDayOfMonth=function(){return i.date().endOf("month").toDate()},o.prototype.getFirstDayOfMonth=function(){var e=i.date();return 1!==e.date()&&e.add(1,"month").startOf("month"),e.toDate()},o.prototype.getLastFridayOfMonth=function(){var e=i.date().endOf("month");return e.day()>=5?e.subtract(e.day()-5,"days"):e.subtract(e.day()+2,"days"),e.toDate()},o.prototype.getLastDayOfMonthPlusTime=function(e,t){return i.date(e).add(t-1,"month").endOf("month").toDate()},o.prototype.getFirstDayOfMonthPlusTime=function(e,t){var n=i.date(e).clone();return 0===n.day()?(n.add(t-1,"months").startOf("month"),e=n.isBefore(e)?n.add(1,"months"):n):e=i.date(e).add(t,"months").startOf("month"),e.toDate()},o.prototype.getLastFridayOfMonthPlusTime=function(e,t){var n=i.date(e).clone(),a=function(e){return e.subtract(1,"week").endOf("week").subtract(1,"days")};return 5!==n.endOf("month").day()?(a(n),n.isBefore(e)?n.add(t,"months"):n.add(t-1,"months"),5!==n.endOf("month").day()&&a(n)):(n.add(t-1,"months").endOf("month"),5!==n.day()&&a(n)),n.toDate()},o.prototype.calculateMinimumEndDate=function(e,t,n){switch(e){case this.frequencies.WEEKLY:n=i.date(n).add(1*t,"weeks").toDate();break;case this.frequencies.MONTHLY:n=i.date(n).add(1*t,"months").toDate();break;case this.frequencies.YEARLY:n=i.date(n).add(1*t,"years").toDate();break;case this.frequencies.LAST_FRIDAY_OF_THE_MONTH:n=this.getLastFridayOfMonthPlusTime(n,1);break;case this.frequencies.START_OF_THE_MONTH:n=this.getFirstDayOfMonthPlusTime(n,1);break;case this.frequencies.END_OF_THE_MONTH:n=this.getLastDayOfMonthPlusTime(n,1)}return n}}.call(t,n,t,e),!(void 0!==a&&(e.exports=a))},function(e,t,n){var a;(function(e){a=function(e,t,a){"use strict";a.name="lp-amount-input";var r=n(2),i=n(3),o=n(5),s=[i.name,o.name];a.exports=r.createModule(a.name,s).directive(n(9))}.call(t,n,t,e),!(void 0!==a&&(e.exports=a))}).call(t,n(1)(e))},function(e,t,n){var a;a=function(e,t,n){"use strict";var a={decimals:2,hideGroupSep:!1,allowNegative:!1,currencySymbol:""};t.lpAmountInput=function(e,t,n){function r(r,o,s,c){function l(e){var t=e>0?m+new Array(e+1).join("0"):"",n=h+" #"+y+"##0"+t;return new i(n,{reverse:!0})}function u(t){if(!t)return"";var n=f.allowNegative&&0>t?"-":"",a=e.prepareNumberToFormatter(t,f.decimals);return n+p.apply(a)}function d(e){if(!e)return"";var t,n=e.replace(/[^\d]+/g,"");if(n=n.replace(/^[0]+([1-9])/,"$1"),t=p.apply(n),f.allowNegative){var a="-"===e[0],r="-"===e.slice(-1);r^a&&n&&(n*=-1,t="-"+t)}return e!==t&&(c.$setViewValue(t),c.$render()),t=t?parseInt(t.replace(/[^\d\-]+/g,""),10)/Math.pow(10,f.decimals):null}s.lpAmountInput&&(s.lpAmountInput=n(s.lpAmountInput)(r));var p,f=e.defaults(s.lpAmountInput||{},a),m=t.NUMBER_FORMATS.DECIMAL_SEP,y=t.NUMBER_FORMATS.GROUP_SEP,h=f.currencySymbol||t.NUMBER_FORMATS.CURRENCY_SYM;f.hideGroupSep&&(y=""),p=l(f.decimals),s.$observe("lpAmountInput",function(e){e=n(e)(r),null!==e&&"object"==typeof e&&(""!==e.currencySymbol&&(h=e.currencySymbol),p=l(f.decimals),d(c.$viewValue))}),c.$formatters.push(u),c.$parsers.push(d)}var i=e.StringMask;return{require:"ngModel",restrict:"A",link:r}},t.lpAmountInput.$inject=["lpUIUtils","$locale","$parse"]}.call(t,n,t,e),!(void 0!==a&&(e.exports=a))},function(e,t,n){var a;(function(e){a=function(e,t,a){"use strict";a.name="module-payments-deprecated";var r=n(2),i=[];a.exports=r.createModule(a.name,i).factory(n(11)).directive(n(12))}.call(t,n,t,e),!(void 0!==a&&(e.exports=a))}).call(t,n(1)(e))},function(e,t,n){var a;a=function(e,t,n){"use strict";t.ScheduledDateCalculator=function(e){var t=function(e){var t=this;t.frequencies=e.frequencies};return t.prototype.addWeeksToDate=function(t,n){return e.date(t).add(n,"weeks").toDate()},t.prototype.addMonthsToDate=function(t,n){return e.date(t).add(n,"months").toDate()},t.prototype.addYearsToDate=function(t,n){return e.date(t).add(n,"years").toDate()},t.prototype.getLastDayOfMonth=function(){return e.date().endOf("month").toDate()},t.prototype.getFirstDayOfMonth=function(){var t=e.date();return 1!==t.date()&&t.add(1,"month").startOf("month"),t.toDate()},t.prototype.getLastFridayOfMonth=function(){var t=e.date().endOf("month");return t.day()>=5?t.subtract(t.day()-5,"days"):t.subtract(t.day()+2,"days"),t.toDate()},t.prototype.getLastDayOfMonthPlusTime=function(t,n){return e.date(t).add(n-1,"month").endOf("month").toDate()},t.prototype.getFirstDayOfMonthPlusTime=function(t,n){var a=e.date(t).clone();return 0===a.day()?(a.add(n-1,"months").startOf("month"),t=a.isBefore(t)?a.add(1,"months"):a):t=e.date(t).add(n,"months").startOf("month"),t.toDate()},t.prototype.getLastFridayOfMonthPlusTime=function(t,n){var a=e.date(t).clone(),r=function(e){return e.subtract(1,"week").endOf("week").subtract(1,"days")};return 5!==a.endOf("month").day()?(r(a),a.isBefore(t)?a.add(n,"months"):a.add(n-1,"months"),5!==a.endOf("month").day()&&r(a)):(a.add(n-1,"months").endOf("month"),5!==a.day()&&r(a)),t=a.toDate(),t=a.toDate()},t.prototype.calculateMinimumEndDate=function(t,n,a){switch(t){case this.frequencies.WEEKLY:a=e.date(a).add(1*n,"weeks").toDate();break;case this.frequencies.MONTHLY:a=e.date(a).add(1*n,"months").toDate();break;case this.frequencies.YEARLY:a=e.date(a).add(1*n,"years").toDate();break;case this.frequencies.LAST_FRIDAY_OF_THE_MONTH:a=this.getLastFridayOfMonthPlusTime(a,1);break;case this.frequencies.START_OF_THE_MONTH:a=this.getFirstDayOfMonthPlusTime(a,1);break;case this.frequencies.END_OF_THE_MONTH:a=this.getLastDayOfMonthPlusTime(a,1)}return a},{getInstance:function(e){return new t(e)}}},t.ScheduledDateCalculator.$inject=["lpCoreUtils"]}.call(t,n,t,e),!(void 0!==a&&(e.exports=a))},function(e,t,n){var a;a=function(e,t,n){"use strict";t.scheduledTransfer=function(e){var t="";return t+='<div class="lp-scheduled-transfer">',t+='    <div class="lp-st-frequency lp-st-section clearfix">',t+='        <div class="pull-left lp-st-caption">Frequency</div>',t+='        <div class="pull-left lp-st-control">',t+='            <div class="lp-st-frequency-dropdown" aria-label="frequency" dropdown-select="dropdown-select" ng-change="frequencyChanged()" ng-model="paymentOrder.scheduledTransfer.frequency" ng-options="val.id as val.value group by val.group for val in frequencies"></div>',t+="        </div>",t+="    </div>",t+='    <div class="lp-st-start-date lp-st-section clearfix">',t+='        <div class="pull-left lp-st-caption"><span ng-hide="paymentOrder.scheduledTransfer.frequency === frequenciesEnum.ONETIME">Start&nbsp;</span><span>Date</span></div>',t+='        <div class="pull-left lp-st-control calendar">',t+='            <input ng-click="openStartCalendar($event)" aria-label="start date" type="text" ng-required="paymentOrder.isScheduledTransfer === true" name="startDate" ng-model="paymentOrder.scheduledTransfer.startDate" datepicker-popup="d-MMM-yyyy" readonly="readonly" is-open="calendar.startCalendarOpen" datepicker-options="startDateOptions" min-date="todaysDate" class="form-control" lp-future-time="" show-button-bar="false" tabindex="0" ng-change="setEndDate()" ng-keypress="openStartCalendar($event)" />',t+='            <span ng-click="openStartCalendar($event)" class="lp-icon lp-icon-calendar calendar-icon"></span>',t+="        </div>",t+="    </div>",t+='    <div class="lp-st-end-on lp-st-section clearfix" ng-hide="paymentOrder.scheduledTransfer.frequency === frequenciesEnum.ONETIME">',t+='        <div class="pull-left lp-st-caption">End</div>',t+='        <div class="pull-left lp-st-control">',t+='            <div class="lp-st-end-on-dropdown" aria-label="end on" dropdown-select="dropdown-select" ng-change="endOnChanged()" ng-model="paymentOrder.scheduledTransfer.endOn" ng-options="val.id as val.value for val in endOptions"></div>',t+="        </div>",t+="    </div>",t+='    <div class="lp-st-end-after lp-st-section clearfix" ng-if="paymentOrder.scheduledTransfer.endOn === \'after\'">',t+='        <div class="pull-left lp-st-caption">Repeat</div>',t+='        <div class="pull-left lp-st-control">',t+='            <input type="tel" lp-number-input="lp-number-input" lp-max-length="2" min="1" step="0" non-zero="non-zero" class="form-control" aria-label="times to repeat" name="timesToRepeat" aria-required="true" required="required" tabindex="0" ng-model="paymentOrder.scheduledTransfer.timesToRepeat" ng-change="setEndDate()"  />',t+="        </div>",t+="",t+="    </div>",t+='    <p class="text-muted" style="padding: 0 10px;" ng-if="paymentOrder.scheduledTransfer.endOn === \'after\' && timesEndDate">Completion date: {{timesEndDate | date : \'EEEE, dd MMM, yyyy\'}}</p>',t+='    <div class="lp-st-end-date lp-st-section clearfix" ng-hide="paymentOrder.scheduledTransfer.frequency === frequenciesEnum.ONETIME" ng-if="paymentOrder.scheduledTransfer.endOn === \'onDate\'">',t+='        <div class="pull-left lp-st-caption">End date</div>',t+='        <div class="pull-left lp-st-control calendar">',t+='<input ng-click="openEndCalendar($event)" aria-label="end date" type="text" ng-required="paymentOrder.isScheduledTransfer === true" name="endDate" ng-model="paymentOrder.scheduledTransfer.endDate" readonly="readonly" datepicker-popup="d-MMM-yyyy" is-open="calendar.endCalendarOpen" datepicker-options="endDateOptions" min-date="minEndDate" class="form-control" lp-future-time="" show-button-bar="false" tabindex="0" ng-keypress="openEndCalendar($event)" />',t+='            <span ng-click="openEndCalendar($event)" class="lp-icon lp-icon-calendar calendar-icon"></span>',t+="        </div>",t+="    </div>",t+='    <p ng-if="dateWarning">Transfer will be put through on the last day of the month if the month is not long enough</p>',t+="</div>",t+="",{restrict:"AE",replace:!0,require:["ngModel","^form"],template:t,link:function(t,n,a,r){var i,o=function(){t.todaysDate=new Date,t.minEndDate=new Date((new Date).getTime()+864e5),t.frequenciesEnum={ONETIME:"ONETIME",WEEKLY:"WEEKLY",MONTHLY:"MONTHLY",START_OF_THE_MONTH:"QUARTERLY",END_OF_THE_MONTH:"HALF YEARLY",YEARLY:"YEARLY"},i=e.getInstance({frequencies:t.frequenciesEnum}),t.frequencies||(t.frequencies=[{id:t.frequenciesEnum.ONETIME,value:"One-Time",group:"apreset"},{id:t.frequenciesEnum.WEEKLY,value:"Weekly",group:"apreset"},{id:t.frequenciesEnum.MONTHLY,value:"Monthly",group:"apreset"},{id:t.frequenciesEnum.START_OF_THE_MONTH,value:"Quarterly",group:"apreset"},{id:t.frequenciesEnum.END_OF_THE_MONTH,value:"Half Yearly",group:"apreset"},{id:t.frequenciesEnum.YEARLY,value:"Yearly",group:"apreset"}]),t.days=[{id:1,value:"M",label:"Monday",active:!1},{id:2,value:"T",label:"Tuesday",active:!1},{id:3,value:"W",label:"Wednesday",active:!1},{id:4,value:"T",label:"Thursday",active:!1},{id:5,value:"F",label:"Friday",active:!1},{id:6,value:"S",label:"Saturday",active:!1},{id:7,value:"S",label:"Sunday",active:!1}],t.months=[{id:1,value:"Jan",label:"January",active:!1},{id:2,value:"Feb",label:"February",active:!1},{id:3,value:"Mar",label:"March",active:!1},{id:4,value:"Apr",label:"April",active:!1},{id:5,value:"May",label:"May",active:!1},{id:6,value:"Jun",label:"June",active:!1},{id:7,value:"Jul",label:"July",active:!1},{id:8,value:"Aug",label:"August",active:!1},{id:9,value:"Sep",label:"September",active:!1},{id:10,value:"Oct",label:"October",active:!1},{id:11,value:"Nov",label:"November",active:!1},{id:12,value:"Dec",label:"December",active:!1}],t.dates=[];for(var n=1;32>n;n++)t.dates.push({id:n,value:n,label:n,active:!1});t.endOptions||(t.endOptions=[{id:"after",value:"After"},{id:"onDate",value:"On date"}]),t.paymentOrder.scheduledTransfer.endOn=t.endOptions[0].id,t.customOrder=!1,t.dateWarning=!1,t.calendar={startCalendarOpen:!1,endCalendarOpen:!1},t.endDateOptions={"show-weeks":!1},t.startDateOptions={"show-weeks":!1},t.timesEndDate=t.paymentOrder.scheduledTransfer.endDate,t.paymentOrder.update||t.setEndDate()},s=r[0],c=r[1];s.$name="scheduledTransfer",c.$addControl(s),s.$formatters.push(function(e){if(e.intervals.length>0){var n,a;if(e.frequency===t.frequenciesEnum.WEEKLY){for(n=0;n<e.intervals.length;n++)for(a=0;a<t.days.length;a++)if(e.intervals[n]===t.days[a].id){t.days[a].active=!0;break}}else if(e.frequency===t.frequenciesEnum.MONTHLY){for(n=0;n<e.intervals.length;n++)for(a=0;a<t.dates.length;a++)if(e.intervals[n]===t.dates[a].id){t.dates[a].active=!0;break}}else if(e.frequency===t.frequenciesEnum.YEARLY)for(n=0;n<e.intervals.length;n++)for(a=0;a<t.months.length;a++)if(e.intervals[n]===t.months[a].id){t.months[a].active=!0;break}}t.paymentOrder.scheduledTransfer.frequency=""===e.frequency?t.frequencies[0].id:e.frequency,p()?t.customOrder=!0:t.customOrder=!1,d(),t.setTransferPeriodDates()}),t.frequencyChanged=function(){u(),t.setTransferPeriodDates(),p()?(t.customOrder=!0,l(),t.paymentOrder.scheduledTransfer.customOrder=!0):(t.customOrder=!1,s.$setValidity("intervalsRequired",!0),t.paymentOrder.scheduledTransfer.customOrder=!1),d()},t.toggleInterval=function(e){var n,a;if(t.paymentOrder.scheduledTransfer.frequency===t.frequenciesEnum.WEEKLY?n=t.days:t.paymentOrder.scheduledTransfer.frequency===t.frequenciesEnum.MONTHLY?n=t.dates:t.paymentOrder.scheduledTransfer.frequency===t.frequenciesEnum.YEARLY&&(n=t.months),a=n[e],a.active){var r=t.paymentOrder.scheduledTransfer.intervals.indexOf(a.id);t.paymentOrder.scheduledTransfer.intervals.splice(r,1)}else t.paymentOrder.scheduledTransfer.intervals.push(a.id);a.active=!a.active,l(),d(),t.setEndDate()};var l=function(){var e=!0;e=t.paymentOrder.scheduledTransfer.intervals.length>0?!0:!1,t.customOrder=!1,e=t.customOrder?e:!0,e=t.paymentOrder.isScheduledTransfer?e:!0,s.$setValidity("intervalsRequired",e)},u=function(){t.paymentOrder.scheduledTransfer.intervals=[];var e;for(e=0;e<t.days.length;e++)t.days[e].active=!1;for(e=0;e<t.dates.length;e++)t.dates[e].active=!1;for(e=0;e<t.months.length;e++)t.months[e].active=!1};t.openStartCalendar=function(e){("click"===e.type||32===e.which||13===e.which)&&(e.preventDefault(),e.stopPropagation(),t.calendar.endCalendarOpen=!1,t.calendar.startCalendarOpen=!t.calendar.startCalendarOpen)},t.openEndCalendar=function(e){("click"===e.type||32===e.which||13===e.which)&&(e.preventDefault(),e.stopPropagation(),t.calendar.startCalendarOpen=!1,t.calendar.endCalendarOpen=!t.calendar.endCalendarOpen)},t.setTransferPeriodDates=function(){"object"!=typeof t.paymentOrder.scheduledTransfer.startDate&&(p()?t.paymentOrder.update||(t.paymentOrder.scheduledTransfer.startDate=new Date(t.todaysDate.getTime())):t.paymentOrder.scheduledTransfer.frequency===t.frequenciesEnum.END_OF_THE_MONTH?t.paymentOrder.update||(t.paymentOrder.scheduledTransfer.startDate=new Date(t.todaysDate.getTime())):t.paymentOrder.scheduledTransfer.frequency===t.frequenciesEnum.START_OF_THE_MONTH?t.paymentOrder.update||(t.paymentOrder.scheduledTransfer.startDate=new Date(t.todaysDate.getTime())):t.paymentOrder.scheduledTransfer.frequency===t.frequenciesEnum.LAST_FRIDAY_OF_THE_MONTH&&(t.paymentOrder.scheduledTransfer.startDate=i.getLastFridayOfMonth())),t.paymentOrder.update?(t.paymentOrder.scheduledTransfer.endOn=t.endOptions[1].id,t.timesEndDate=t.paymentOrder.scheduledTransfer.endDate):(t.paymentOrder.scheduledTransfer.endOn=t.endOptions[1].id,t.setEndDate())},t.endOnChanged=function(){"undefined"==typeof t.paymentOrder.scheduledTransfer.timesToRepeat&&(t.paymentOrder.scheduledTransfer.timesToRepeat=1,t.setEndDate())},t.setEndDate=function(){var e;if("undefined"==typeof t.paymentOrder.scheduledTransfer.timesToRepeat)t.timesEndDate="The number of times to repeat the standing order is required.";else if(t.paymentOrder.scheduledTransfer.startDate){var n=new Date(t.paymentOrder.scheduledTransfer.startDate.getTime());p()?(e=t.paymentOrder.scheduledTransfer.timesToRepeat*t.paymentOrder.scheduledTransfer.every,t.paymentOrder.scheduledTransfer.frequency===t.frequenciesEnum.WEEKLY?n=i.addWeeksToDate(n,e):t.paymentOrder.scheduledTransfer.frequency===t.frequenciesEnum.MONTHLY?n=i.addMonthsToDate(n,e):t.paymentOrder.scheduledTransfer.frequency===t.frequenciesEnum.YEARLY&&(n=i.addYearsToDate(n,e))):(e=t.paymentOrder.scheduledTransfer.timesToRepeat,e=t.paymentOrder.scheduledTransfer.timesToRepeat,t.paymentOrder.scheduledTransfer.frequency===t.frequenciesEnum.END_OF_THE_MONTH?(e=6*e,n=i.addMonthsToDate(n,e)):t.paymentOrder.scheduledTransfer.frequency===t.frequenciesEnum.START_OF_THE_MONTH?(e=3*e,n=i.addMonthsToDate(n,e)):t.paymentOrder.scheduledTransfer.frequency===t.frequenciesEnum.ONETIME?t.paymentOrder.scheduledTransfer.endDate=t.paymentOrder.scheduledTransfer.startDate:t.paymentOrder.scheduledTransfer.frequency===t.frequenciesEnum.LAST_FRIDAY_OF_THE_MONTH&&(n=i.getLastFridayOfMonthPlusTime(n,e))),t.paymentOrder.scheduledTransfer.endDate=n,t.minEndDate=i.calculateMinimumEndDate(t.paymentOrder.scheduledTransfer.frequency,t.paymentOrder.scheduledTransfer.every,new Date(t.paymentOrder.scheduledTransfer.startDate.getTime())),t.timesEndDate=new Date(t.paymentOrder.scheduledTransfer.endDate.getTime())}};var d=function(){var e=!1;if(t.paymentOrder.scheduledTransfer.intervals.length>0&&t.paymentOrder.scheduledTransfer.frequency===t.frequenciesEnum.MONTHLY)for(var n=28;31>n;n++)t.dates[n].active&&(e=!0);t.dateWarning=e};t.$watch("paymentOrder.isScheduledTransfer",function(e){l()}),t.$on("reset",function(){t.paymentOrder.scheduledTransfer.frequency=t.frequencies[0].id,t.customOrder=!1,t.paymentOrder.scheduledTransfer.customOrder=!1});var p=function(){return t.paymentOrder.scheduledTransfer.frequency===t.frequenciesEnum.WEEKLY||t.paymentOrder.scheduledTransfer.frequency===t.frequenciesEnum.MONTHLY||t.paymentOrder.scheduledTransfer.frequency===t.frequenciesEnum.YEARLY};o()}}},t.scheduledTransfer.$inject=["ScheduledDateCalculator"]}.call(t,n,t,e),!(void 0!==a&&(e.exports=a))},function(e,t,n){var a;(function(e){a=function(e,t,a){"use strict";a.name="module-payments-migration";var r=n(2),i=[];a.exports=r.createModule(a.name,i).directive(n(14)).directive(n(15)).directive(n(16)).directive(n(17)).directive(n(18)).filter(n(19)).factory(n(20)).directive(n(21)).directive(n(22)).directive(n(23)).directive(n(24)).directive(n(25)).directive(n(26)).directive(n(27)).directive(n(28)).directive(n(29))}.call(t,n,t,e),!(void 0!==a&&(e.exports=a))}).call(t,n(1)(e))},function(e,t,n){var a;a=function(e,t,n){"use strict";t.addressTransfer=function(e,t){return e.put("$addressTransferTemplate.html",'<div class="lp-address-transfer"><div class="col-xs-12"><input type="input" class="form-control" ng-model="address.addressOne" placeholder="Address Line 1" aria-label="Address Line One" /><input type="input" class="form-control" ng-model="address.addressTwo" placeholder="Address Line 2" aria-label="Address Line Two"  /></div><div class="col-xs-12"><input type="input" class="form-control" ng-model="address.city" placeholder="City" aria-label="City" /></div><div class="col-xs-12"><div class="col-xs-5"><input type="input" class="form-control" ng-model="address.state" placeholder="State" aria-label="State" /></div><div ng-class="{\'col-xs-offset-1\': true, \'col-xs-6\': true, \'has-feedback\': address.zip.length > 0, \'has-error\': address.zip.length > 0 && !validZip, \'has-success\': address.zip.length > 0 && validZip}"><input type="input" class="form-control" ng-model="address.zip" placeholder="Zip" aria-label="Zip" /><span ng-if="validZip && address.zip.length > 0" class="glyphicon glyphicon-ok form-control-feedback"></span><span ng-if="!validZip && address.zip.length > 0" ng-click="clear()" class="glyphicon glyphicon-remove form-control-feedback"></span></div></div><div class="warning"><span>Selecting this means a cheque will be printed and posted on your behalf. Can take 7-14 days.</span></div></div>'),{restrict:"EA",replace:!0,require:["ngModel","^form"],scope:{counterpartyAddress:"=ngModel",transferType:"=lpTransferType"},template:e.get("$addressTransferTemplate.html"),link:function(e,n,a,r){var i=function(){e.address={addressOne:"",addressTwo:"",city:"",state:"",zip:""},d(e.transferType)},o=r[0],s=r[1],c=t.p2pAddress;o.$name=a.name,s.$addControl(o),o.$formatters.push(function(e){
return l(e),e});var l=function(t){var n=!0,a=!0,r=!0,i=!0,s=!0;if(t){var c=t.split(", ");e.address.addressOne=c[0],e.address.addressTwo=c[1],e.address.city=c[2],e.address.state=c[3],e.address.zip=c[4],0===c[0].length&&(n=!1),0===c[2].length&&(a=!1),0===c[3].length&&(r=!1),0===c[4].length?i=!1:s=u(c[4])}o.$setValidity("addressLineOne",n),o.$setValidity("addressCity",a),o.$setValidity("addressState",r),o.$setValidity("addressZip",i),o.$setValidity("addressValidZip",s)},u=function(t){var n=/^\d{5}(-\d{4})?$/,a=n.test(t);return e.validZip=a,a};e.$watch("address",function(t,n){t!==n&&(e.counterpartyAddress=t.addressOne+", "+t.addressTwo+", "+t.city+", "+t.state+", "+t.zip)},!0),e.$watch("transferType",function(e,t){e!==t&&d(e)});var d=function(t){t===c?l(e.counterpartyAddress||""):(o.$setValidity("addressLineOne",!0),o.$setValidity("addressCity",!0),o.$setValidity("addressState",!0),o.$setValidity("addressZip",!0),o.$setValidity("addressValidZip",!0))};i()}}},t.addressTransfer.$inject=["$templateCache","transferTypes"]}.call(t,n,t,e),!(void 0!==a&&(e.exports=a))},function(e,t,n){var a;a=function(e,t,a){"use strict";var r=window.jQuery,i=n(2),o=i.ng,s=i.inject("lpUIUtils",n(5).name);t.counterPartyFilter=function(e,t,n,a,i,c,l,u,d,p){return e.put("$counterPartyFilter.html",'<div class="lp-counter-party-filter"><div class="input-group has-clear"><input placeholder = "Select Beneficiary Name" ng-class="{\'ddopen\':showContacts && (counterpartyList | filter:counterpartyName).length > 0}" class="name-field form-control" style="background-color: white;" type="text" ng-model="counterpartyName" ng-disabled="true" ng-click="showContactList()" ng-keydown="showContactList($event)" aria-label="Counterparty Name" /><span class="input-group-btn" style="position: absolute;left: 80%;width: 20%;"><button type="button" role="button" style="outline: none !important;box-shadow: none;background-color: transparent;" aria-label="Auto Suggest" tabindex="0" class="btn btn-default dropdown-toggle new-transfer-icon newTransfer-showContacts" ng-click="toggleShowContacts()"><div class="lp-icon newTranfer-contactIcon" style="color: transparent !important;"></div></button></span></div><div class="dropdown"><ul id="ftBeneficiaryList" ng-show="showContacts && (counterpartyList | filter:counterpartyName).length > 0" class="col-xs-12 dropdown-menu filter-list" style="display: block;"><li class="contact" ng-repeat="contact in counterpartyList | filter: counterpartyName track by $index" ><div class="filter-contact clearfix" ng-class="{\'single-account-selection\': contact.accounts.length === 1}" ng-click="prepareSelection(contact)" ng-keydown="handleContactAccountToggleKeyDown(contact, $event)" dynamic-focus="contact"><div class="pull-left photo-container" style="width: 23%;"><img class="contact-photo media-object" ng-src="{{getProfileImageByName(contact.photoUrl,contact.name)}}" /></div><div class="contact-info pull-left contact-details" style="width: 76%;overflow:hidden;text-overflow: ellipsis;"><span class="contact-name">{{contact.name}}</span><p class="account-info">{{contact.bankName}}</p><p class="account-info" ng-if="contact.accounts.length > 1">{{contact.accounts.length}} Account(s)</p><p class="account-info" ng-if="contact.accounts.length === 1">{{contact.accounts[0].account}}</p></div><div ng-if="contact.accounts.length > 1" class="pull-left contact-account-list"><p tabindex="0" class="toggle-accounts" ng-show="!contact.open" ng-click="toggleContactAccounts(contact)" ng-keydown="handleContactAccountToggleKeyDown(contact, $event)"  aria-label="View accounts for {{contact.name}}" style="color:rgb(57,202,116);">View all accounts <span class="caret"></span></p><p tabindex="0" class="toggle-accounts" ng-show="contact.open" ng-click="toggleContactAccounts(contact)" ng-keydown="handleContactAccountToggleKeyDown(contact, $event)" aria-label="Close accounts for {{contact.name}}" style="color:red;">Minimize <span class="caret"></span></p><div class="contact-accounts" ng-class="{\'contact-accounts-open\': contact.open}"><div tabindex="0" ng-show="contact.open" ng-repeat="account in contact.accounts track by $index" id="contact-single-account-details" class="contact-single-account" ng-click="prepareSelection(contact, account)" ng-keydown="handleSingleAccountKeyDown(contact, account, $event)" dynamic-aria-label="dynamic-aria-label" aria-contact="contact" aria-account="account"><div id="bulletSubMenu" class="col-xs-2"></div><div class="col-xs-10"><p ng-if="account.name">{{account.name}}</p><p class="singleAccountNumber">{{account.account}}</p></div></div></div></div></div></li></ul></div><div id="benId" style="display:none">{{benId}}</div><div id="counterpartyIFSCCode" style="display:none">{{counterpartyIFSCCode}}</div><div id="counterpartyLimit" style="display:none">{{counterpartyLimit}}</div><div id="counterpartyNickName" style="display:none">{{counterpartyNickName}}</div><div id="counterpartycreationDate" style="display:none">{{counterpartycreationDate}}</div></div>'),{restrict:"A",scope:{counterpartyName:"=ngModel",contacts:"=lpContacts",accounts:"=lpAccounts",onSelect:"="},require:["ngModel","^form"],template:e.get("$counterPartyFilter.html"),link:function(e,a,f,m){var y=m[0],h=m[1];y.$name=f.name,h.$addControl(y);var v=o.element(a.find("input")),g=a.get(0),T={up:38,down:40,enter:13},b={email:t.p2pEmail,account:t.bank},O=function(){e.counterpartyList=[],e.showContacts=!1,e.accntFlag=!1,e.flagContactsLoaded=!1,e.ownAccountsPrev={},e.deregisterContactsWatch=e.$watch("accounts",function(t){if(!e.accntFlag){var n=this;n.ownContactDetailsService=l.getInstance({endpoint:u.getPreference("accountsDataSrc")}),e.contactsModel=new p({contacts:c.resolvePortalPlaceholders(u.getPreference("contactListDataSrc")),contactData:c.resolvePortalPlaceholders(u.getPreference("contactDataSrc")),contactDetails:c.resolvePortalPlaceholders(u.getPreference("contactDetailsDataSrc"))});var a=n.ownContactDetailsService.read();a.success(function(t){e.ownAccountsData=t,e.accntFlag=!0,0==e.contacts.length?e.contactsModel.loadContacts().success(function(){w(t,d.getProperty()),e.contacts=D(e.contacts),E(e.contacts)}):(w(t,d.getProperty()),e.contacts=D(e.contacts),E(e.contacts))})}}),e.accountsConfigured=!1,e.contactsConfigured=!1};y.$formatters.push(function(e){return e.length>0?y.$setValidity("required",!0):y.$setValidity("required",!1),e}),y.$parsers.push(function(e){return e.length>0?y.$setValidity("required",!0):y.$setValidity("required",!1),e});var D=function(e){for(var t=0;t<e.length;t++)e[t].coolingPeriod&&(e.splice(t,1),t-=1);return e},E=function(t){var n;if(!e.flagContactsLoaded)for(var a=0;a<t.length;a++){n=t[a],n.open=!1,n.accounts=[];for(var r in n)n.hasOwnProperty(r)&&b[r]&&n[r]&&n.accounts.push({type:b[r],account:n[r]});e.counterpartyList.push(n),e.flagContactsLoaded=!0}},w=function(n,a){if(n.length>1){var r={};r.name="Own Accounts",r.open=!1,r.ownAccounts=!0,r.accounts=[];for(var i=0;i<n.length;i++)n[i].id!==a&&r.accounts.push({type:t.bank,account:n[i].id,name:n[i].alias});e.counterpartyList.shift(e.ownAccountsPrev),e.counterpartyList.unshift(r),e.ownAccountsPrev=r}},C=function(){n.bind("click",function(t){g.contains(t.target)||(e.$apply(function(){e.showContacts=!1,e.clearCounterParty()}),A())}),e.clearCounterParty()},A=function(){n.unbind("click")},$=function(){return r(a.find(".contact")[0])},q=function(e){var t;e=o.element(event.target),e.next().hasClass("toggle-accounts")?t=e.next():e.prev().hasClass("toggle-accounts")&&(t=e.prev()),t&&setTimeout(function(){t.focus()},0)},M=function(e){return e.find(".toggle-accounts")},N=function(e){var t;t="block"===r(e[0]).css("display")?e[0]:e[1],t&&setTimeout(function(){t.focus()},0)},S=function(e){return e.parents(".contact")};e.toggleShowContacts=function(){w(e.ownAccountsData,d.getProperty()),e.showContacts=!e.showContacts,e.showContacts?C():A()},e.clearCounterParty=function(){e.counterpartyName="",e.showContacts=!0,e.onSelect(),a.find(v)[0].focus()},e.$on("reset",function(){e.showContacts=!1}),e.activeTransferTab="",e.showContactList=function(t){if(w(e.ownAccountsData,d.getProperty()),A(),e.benefeciaryListSize=r("#ftBeneficiaryList").children().length,e.$watch("benefeciaryListSize",function(t,n){t>0?r("#testip2").val("false"):r("#testip2").val("true"),e.activeTransferTab.bank=!1,e.activeTransferTab.newBeneficiary=!0}),!t||t.which===T.enter||t.which===T.down||t.which===T.up)if(t&&(t.preventDefault(),t.stopPropagation()),C(),e.showContacts)if(t&&t.which===T.down){var n=$(),a=M(n);a.length>0?N(a):n.find(".filter-contact").focus()}else!t||t.which!==T.up&&t.which!==T.enter||(e.showContacts=!1,A());else e.showContacts=!0},e.toggleContactAccounts=function(t){for(var n=0;n<e.counterpartyList.length;n++)e.counterpartyList[n]===t?e.counterpartyList[n].open=!e.counterpartyList[n].open:e.counterpartyList[n].open=!1},e.handleContactAccountToggleKeyDown=function(t,n){n.preventDefault(),n.stopPropagation(),n.which===T.enter?1===t.accounts.length?e.prepareSelection(t):(e.toggleContactAccounts(t),q(n.target)):(n.which===T.down||n.which===T.up)&&e.keyToNextAccountToggle(n)},e.handleSingleAccountKeyDown=function(t,n,a){a.preventDefault(),a.stopPropagation(),a.which===T.enter?e.prepareSelection(t,n):(a.which===T.down||a.which===T.up)&&e.keyToNextAccount(a)},e.keyToNextAccountToggle=function(e){var t,n=r(e.target),a=S(n);if(e.which===T.down)if(n.next("div").length>0)a.find(".contact-single-account")[0].focus();else{var i=a.next(".contact");t=M(i),t.length>0?N(t):i.find(".filter-contact").focus()}else if(e.which===T.up){var o=a.prev(".contact");t=M(o),t.length>0?N(t):o.find(".filter-contact").length>0?o.find(".filter-contact").focus():v.focus()}},e.keyToNextAccount=function(e){var t,n,a,i=r(e.target);e.which===T.down?1===i.next(".contact-single-account").length&&(t=i.next(".contact-single-account")):e.which===T.up&&(1===i.prev(".contact-single-account").length?t=i.prev(".contact-single-account"):(n=S(i),a=M(n),a.length>0&&N(a))),t&&setTimeout(function(){t.trigger("focus")},0)},e.prepareSelection=function(t,n){if(!n){if(t.accounts.length>1)return;n=t.accounts[0]}e.deregisterContactsWatch=e.$watch("accounts",function(n){e.benId=t.id,e.counterpartycreationDate=t.creationDate,e.getBeneficiaryDetailsById(e.benId),"IDFC LIMITED"===t.bankName.toUpperCase?r("#transferMode").hide():r("#transferMode").show()}),e.showContacts=!1,A(),y.$setViewValue(t.name),e.onSelect(n),setTimeout(function(){v.focus()},0)},e.getBeneficiaryDetailsById=function(t){var n=this;n.contactDetailsService=l.getInstance({endpoint:u.getPreference("contactDetailsDataSrc"),urlVars:{contactId:t,bizObjId:t}});var a=n.contactDetailsService.read();a.success(function(t){t&&"null"!==t&&(e.counterpartyIFSCCode=t.ifscCode,e.counterpartyLimit=t.transferLimit,e.counterpartyNickName=t.nickName)}),a.error(function(e){checkTimeout(e),checkGlobalError(e)})},e.getProfileImageByName=function(e,t){return e?s.decodePhotoUrl(e):t?s.getDefaultProfileImage(t,100,100):(i.throwException("Expected a name but got "+t),"")},O()}}},t.counterPartyFilter.$inject=["$templateCache","transferTypes","$document","lpUserDetails","lpCoreError","lpCoreUtils","httpService","lpWidget","sharedProperties","ContactsModel"]}.call(t,n,t,e),!(void 0!==a&&(e.exports=a))},function(e,t,n){var a;a=function(e,t,n){"use strict";t.dynamicAriaLabel=function(){return{restrict:"A",scope:{contact:"=ariaContact",account:"=ariaAccount"},link:function(e,t){var n="";if(n+=e.contact.name+" ",e.account.name)n+=e.account.name+" ";else{var a=e.account.type.toLowerCase();a=a.replace("_"," "),n+=a+" "}n+=e.account.account,t.attr("aria-label",n)}}}}.call(t,n,t,e),!(void 0!==a&&(e.exports=a))},function(e,t,n){var a;a=function(e,t,n){"use strict";t.dynamicFocus=function(){return{restrict:"A",scope:{contact:"=dynamicFocus"},link:function(e,t){1===e.contact.accounts.length&&(t.attr("tabindex","0"),t.attr("aria-label",e.contact.name+" "+e.contact.accounts[0].type.toLowerCase()+" "+e.contact.accounts[0].account))}}}}.call(t,n,t,e),!(void 0!==a&&(e.exports=a))},function(e,t,n){var a;a=function(e,t,a){"use strict";var r=n(2),i=r.ng,o=r.inject("lpCoreUtils",n(3).name);t.emailTransfer=function(e,t){return e.put("$emailTransferTemplate.html","<div class=\"lp-email-transfer\"><div ng-class=\"{'email-input': true, 'has-feedback': email.length > 0, 'has-success': email.length > 0 && validEmail, 'has-error': email.length > 0 && !validEmail}\">"+'<input type="input" ng-model="email" ng-keyup="handleAutoSuggest($event)" placeholder="Email address" class="form-control" aria-label="Email Address" /><span ng-if="validEmail && email.length > 0" class="glyphicon glyphicon-ok form-control-feedback"></span><span ng-if="!validEmail && email.length > 0" ng-click="clear()" style="cursor: pointer;" class="glyphicon glyphicon-remove form-control-feedback"></span></div><span ng-if="autoSuggestActive">Did you mean <span ng-click="doAutoSuggest()" class="auto-correct-suggestion">{{autoSuggestion}}</span>?<br /></span><span class="text-muted" style="font-size: 13px;">Transfers up to $10.00 will be free of charge. For transfers above $10.00 a fee of $0.25 per transaction will be charged and debited from your account</span></div>'),{restrict:"EA",replace:!0,require:["ngModel","^form"],scope:{email:"=ngModel",transferType:"=lpTransferType"},template:e.get("$emailTransferTemplate.html"),link:function(e,n,a,r){var s,c=function(){e.validEmail=!1,e.autoSuggestActive=!1,e.autoSuggestion="",s=i.element(n.find("input")[0]);var t={gmail:"gmail",yahoo:"yahoo",backbase:"backbase"};e.suggestionsMap={gmaik:t.gmail,gmain:t.gmail,gmal:t.gmail,gmakl:t.gmail,mgail:t.gmail,yaho:t.yahoo,yahooo:t.yahoo,yagoo:t.yahoo,bakbase:t.backbase,backbas:t.backbase,baclbase:t.backbase}},l=r[0],u=r[1],d=t.p2pEmail;l.$name=a.name,u.$addControl(l),l.$formatters.push(function(t){return(void 0!==t||null!==t)&&(e.validEmail=p(t?t.toLowerCase():"")),t&&-1===t.indexOf("@")&&(e.autoSuggestActive=!1),t}),e.clear=function(){e.email=""},e.handleAutoSuggest=function(t){var n,a;190===t.which?e.email.indexOf("@")>-1&&(n=e.email.split("@"),n[1]&&""!==n[1]&&(a=f(n[1]),void 0!==e.suggestionsMap[a]&&(e.autoSuggestion=e.suggestionsMap[a],e.autoSuggestActive=!0))):"[object KeyboardEvent]"===t.originalEvent.toString()&&8===t.which&&e.email.indexOf("@")>-1&&(n=e.email.split("@"),n[1]&&""!==n[1]&&(a=f(n[1]),void 0===e.suggestionsMap[a]&&(e.autoSuggestion="",e.autoSuggestActive=!1)))},e.doAutoSuggest=function(){var t=e.email.split("@");if(t[1]){var n=f(t[1]);t[1]=t[1].replace(n,e.autoSuggestion),e.email=t.join("@"),e.autoSuggestActive=!1,e.autoSuggestion=""}};var p=function(t){if(0===t.length&&e.transferType===d)return l.$setValidity("emailRequired",!1),!1;if(e.transferType===d){l.$setValidity("emailRequired",!0);var n=o.isValidEmail(t);return l.$setValidity("validEmailRequired",n),n}},f=function(e){var t,n=e.indexOf(".");return t=n>-1?e.substring(0,n):e};e.$watch("transferType",function(t,n){t!==d?(l.$setValidity("emailRequired",!0),l.$setValidity("validEmailRequired",!0)):e.validEmail=p(e.email)}),c()}}},t.emailTransfer.$inject=["$templateCache","transferTypes"]}.call(t,n,t,e),!(void 0!==a&&(e.exports=a))},function(e,t,n){var a;a=function(e,t,n){"use strict";t.addSeperator=function(){var e=" ",t=function(t){return 4===t.length&&(t+=e),t};return function(n){if(n){n=n.split(e).join(""),n=n.toUpperCase();for(var a=n.match(/.{1,4}/g),r="",i=0;i<a.length;i++)i!==a.length-1&&(a[i]=t(a[i])),r+=a[i];return r}}},t.addSeperator=function(){var e=" ",t=function(t){return 4===t.length&&(t+=e),t};return function(n){if(n){n=n.split(e).join(""),n=n.toUpperCase();for(var a=n.match(/.{1,4}/g),r="",i=0;i<a.length;i++)i!==a.length-1&&(a[i]=t(a[i])),r+=a[i];return r}}}}.call(t,n,t,e),!(void 0!==a&&(e.exports=a))},function(e,t,n){var a;a=function(e,t,a){"use strict";var r=n(2),i=r.ng,o=r.inject("lpCoreUtils",n(3).name);t.IbanModel=function(e){var t=function(t){this.enableCountrySearch=t.enableCountrySearch,this.countryListService=e.getInstance({endpoint:t.countryListEndpoint}),this.value="",this.valid=!1,this.countryList=[],this.selectedCountry={}};return t.prototype.loadCountryList=function(){var e=this,t=e.countryListService.read();return t.then(function(t){e.countryList=t.data},function(){e.error="countryListServiceError"}),t},t.prototype.getCountryCode=function(e){var t=this,n=null,a=e||t.value;if(a.match(/^[A-Za-z]{2}/g)){var r=a.substr(0,2);i.forEach(t.countryList,function(e){return e.country_code===r.toUpperCase()?(n=r,void(t.selectedCountry=e)):void 0})}return n},t.prototype.normalizeIban=function(e){return e&&(e=e.toUpperCase(),e=e.replace(/[\-\. ]/g,"")),e||""},t.prototype.validate=function(){if(this.value.length!==parseInt(this.selectedCountry.iban_length,10))return this.valid=!1,!1;var e=new RegExp(this.selectedCountry.iban_regex);return e.test(this.value)&&o.isValidISO7064Checksum(this.value)?(this.valid=!0,!0):(this.valid=!1,!1)},{getInstance:function(e){return new t(e)}}},t.IbanModel.$inject=["httpService"]}.call(t,n,t,e),!(void 0!==a&&(e.exports=a))},function(e,t,n){var a;a=function(e,t,n){"use strict";var a=function(e){var t=function(){e.wholeAmount="",e.decimalAmount="",e.amountInDomesticCurrency="0.00",e.fieldLength=8};t()};a.$inject=["$scope"],t.lpCurrencyAmountInput=function(e){return e.put("$currencyAmountTemplate.html",'<div class="lp-currency-amount-input"><div class="clearfix"><div class="amount-area pull-left""><input name="wholeAmountInput" type="tel" lp-number-input="lp-number-input" lp-max-length="fieldLength" min="0" step="1" class="form-control whole-amount-input pull-left" ng-model="wholeAmount" aria-required="true" aria-label="amount" /><span class="currencyRuppes" ></span><div  class="pull-left decimal"><span class="decimal-point">.</span></div><input type="tel" pattern="[0-9]" lp-number-input="lp-number-input" lp-max-length="2" min="0" step="1" class="form-control pull-left decimal-amount-input" ng-model="decimalAmount" placeholder="00"  aria-required="true" aria-label="decimal amount" /></div></div></div>'),{restrict:"EA",scope:{amount:"=ngModel",lpCurrencyList:"=",lpPaymentOrder:"=",lpDisableCurrencySelection:"=",lpAmountLabel:"@",lpAmountPlaceholder:"@",toggleExchangeRateModal:"=modal"},require:"ngModel",replace:!0,controller:a,template:e.get("$currencyAmountTemplate.html"),link:function(e,t,n,a){var r=t.find(".decimal-amount-input");a.$formatters.push(function(t){if(!t)return t;var n=s();if("0.00"!==t&&""!==t&&t!==n){var a=t.split(".");e.wholeAmount=parseInt(a[0],10),"00"!==a[1]&&(e.decimalAmount=a[1])}return t});var i=function(){var t=e.amount;t/=e.lpCurrencyList.selected.exchange_rate,t=c(t),e.amountInDomesticCurrency=t},o=function(){var t=s(),n=parseInt(e.wholeAmount,10);e.fieldLength&&n.toString().length>e.fieldLength?a.$setValidity("lpCurrencyMaxLength",!1):a.$setValidity("lpCurrencyMaxLength",!0),"0.00"===t?a.$setValidity("lpAmountRequired",!1):t.length>0&&a.$setValidity("lpAmountRequired",!0),e.amount=t,e.lpCurrencyList&&e.lpCurrencyList.orderedCurrencies.length>0&&i()},s=function(){var t=e.decimalAmount,n=parseInt(e.wholeAmount,10),a=/^0[0-9].*$/;n=isNaN(n)?0:n,10>t&&!a.test(t)&&(t="0"+t),t=parseFloat("0."+t);var r=0===t?n:n+t;return r=c(r)},c=function(e){return e.toFixed(2)},l=function(){e.lpPaymentOrder.instructedCurrency=e.lpCurrencyList.selected.currency_code,u()},u=function(){var t=e.fieldLength;e.fieldLength=e.lpCurrencyList.selected.exchange_rate>2?8:6,t>e.fieldLength&&e.wholeAmount.toString().length>8?(e.wholeAmount=parseInt(e.wholeAmount.toString().substring(0,8),10),o()):(""!==e.wholeAmount||""!==e.decimalAmount)&&i()};e.$watchCollection("[wholeAmount, decimalAmount]",function(t){t[0]&&t[0].toString().indexOf(".")>-1&&(e.wholeAmount=parseInt(e.wholeAmount.toString().replace(".",""),10),r.focus()),o()}),e.$watch("lpCurrencyList.selected",function(){e.lpCurrencyList&&e.lpCurrencyList.selected&&e.lpCurrencyList.orderedCurrencies.length>1&&l()}),e.$on("reset",function(){e.wholeAmount="",e.decimalAmount="",e.amountInDomesticCurrency="0.00",e.fieldLength=8})}}},t.lpCurrencyAmountInput.$inject=["$templateCache"]}.call(t,n,t,e),!(void 0!==a&&(e.exports=a))},function(e,t,n){var a;a=function(e,t,n){"use strict";t.lpFormatPaymentReference=function(e){return{restrict:"A",require:"ngModel",link:function(t,n,a,r){var i=function(t){if(t&&t.length>2){var n=t.substring(0,2);"RF"!==n&&(t="RF"+t)}var a=e("addSeperator")(t);return a!==t&&(r.$setViewValue(a),r.$render()),a};r.$parsers.push(i)}}},t.lpFormatPaymentReference.$inject=["$filter"];var a=function(e){var t=function(){e.paymentReference="",e.paymentDescription="",e.showInfoMessage=!1,e.paymentRefDisabled=!1,e.paymentDescDisabled=!1};t()};a.$inject=["$scope"]}.call(t,n,t,e),!(void 0!==a&&(e.exports=a))},function(e,t,n){var a;a=function(e,t,n){"use strict";t.lpFormatUsAccount=function(e){return{restrict:"A",require:"ngModel",link:function(t,n,a,r){var i=function(t){var n=e("addSeperator")(t);return n!==t&&(r.$setViewValue(n),r.$render()),n};r.$parsers.push(i)}}},t.lpFormatUsAccount.$inject=["$filter"]}.call(t,n,t,e),!(void 0!==a&&(e.exports=a))},function(e,t,n){var a;a=function(e,t,a){"use strict";var r=window.jQuery,i=n(2),o=(i.ng,i.inject("lpUIUtils",n(5).name));t.lpIbanInput=function(e,t,n,a){return e.put("$ibanCountryOptionTemplate.html",'<span aria-label="{{option.country_name}}">{{option.country_code}}<span class="country-name"> - {{option.country_name}}</span></span>'),{restrict:"EA",replace:!0,require:["ngModel","^form"],scope:{ibanModel:"=lpCountryList",transferType:"=lpTransferType"},template:'<div><div class="lp-iban"><input name="ibanInputField" ng-required="transferType === \'BANK\'" type="input" class="form-control" lp-input-overflow="lp-input-overflow" ng-model="iban.value"  aria-required="true" ng-keydown="getSelection($event)" ng-keypress="getSelection($event)" ng-mousedown="getSelection($event)" ng-mouseup="getSelection($event)" ng-change="change()" tabindex="0" placeholder="Account Number" aria-label="Account Number"></div></div>',link:function(e,n,a,i){var s=i[0],c=i[1],l=n.find("input")[0],u=[],d=!1,p=0,f=r(n[0]),m="BANK";f.find('div[name="ibaneDropdownField"]').on("keypress",function(e){13===e.which&&t(function(){f.find('input[type="search"]').focus()})}),e.iban={},s.$name=a.name,c.$addControl(s),e.$watch("ibanModel.countryList",function(t){e.change(!0),e.ibanModel.countryList.length&&!e.iban.selectedCountry&&(e.iban.selectedCountry=e.ibanModel.countryList[0].country_code)}),s.$formatters.push(function(t){e.ibanModel.value=t,e.iban.value=v(t);var n=e.ibanModel.getCountryCode();e.ibanModel.validate(),n&&e.change(!0);var a=n?e.ibanModel.valid:!1;return s.$setValidity("validIban",a),t}),s.$parsers.push(function(t){var n=e.ibanModel.getCountryCode()?e.ibanModel.validate():!1;return h(t),n?t:void 0});var y=r(document.createElement("span"));y.addClass("lp-input-cursor-position-offset"),y.css("font-size",n.css("font-size")),r(l).after(y);var h=function(t){if(t!==m)s.$setValidity("validIban",!0),s.$setValidity("required",!0);else{var n=e.ibanModel.getCountryCode()?e.ibanModel.validate():!1;s.$setValidity("validIban",n)}},v=function(e){var t=[];for(t.push(e.substr(0,2)),e=e.substr(2);e.length>0;)t.push(e.substr(0,4)),e=e.substr(4);return t.join("-")};e.setCursorPosition=function(){var n=o.getNewCaretPosition(l,u,p,d);if(d=!1,n>2&&(n++,n>6)){var a=(n-3)/4;parseInt(a,10)===a&&n--,n+=parseInt(a,10)}t(function(){o.setCaretPositionOfInput(l,n,e.paymentReference,y)},20,!1)},e.getSelection=function(e){var t=function(e){var t=0,n=e;return n>2&&(n-=3,t++),t+=parseInt(n/5,10),e-t};u=o.getSelectionPositionOfInput(l,t),"[object KeyboardEvent]"===e.originalEvent.toString()&&8===e.originalEvent.which&&l.value.length&&(d=!0)},e.clear=function(){e.iban.value="",l.focus()},e.change=function(a){if(e.ibanModel.value!==e.ibanModel.normalizeIban(e.iban.selectedCountry+e.iban.value)){var i=e.ibanModel.normalizeIban(e.iban.value);e.ibanModel.getCountryCode(i)||(i=e.iban.selectedCountry+i),p=i.length-e.ibanModel.value.length,e.ibanModel.value=i,s.$setViewValue(i)}var o=e.ibanModel.getCountryCode();o&&(o!==e.iban.selectedCountry&&(e.iban.selectedCountry=o,r(n.find("button")[0]).addClass("lp-country-dropdown-update"),t(function(){r(n.find("button")[0]).removeClass("lp-country-dropdown-update")},200,!1)),e.iban.value=e.ibanModel.value.substr(2)),e.iban.value=v(e.ibanModel.normalizeIban(e.iban.value)),a||e.setCursorPosition()},e.$watch("transferType",function(e,t){h(e)}),h(e.transferType)}}},t.lpIbanInput.$inject=["$templateCache","$timeout","IbanModel","widget"]}.call(t,n,t,e),!(void 0!==a&&(e.exports=a))},function(e,t,n){var a;a=function(e,t,n){"use strict";t.lpInputCurrency=function(e){return{restrict:"A",require:"ngModel",link:function(t,n,a,r){var i=/^\d+((\.|\,)\d+)?$/,o=function(e,t,n){r.$setValidity("lpCurrencyFormat",e),e||(t=!0,n=!0),r.$setValidity("lpCurrencyNonZero",t),r.$setValidity("lpCurrencyMaxLength",n)};r.$parsers.unshift(function(t){return t?(t=t.replace(",","."),o(i.test(t),0!==parseFloat(t),t.length<e)):o(!0,!0,!0),t})}}},t.lpInputCurrency.$inject=["currencyMaxLength"]}.call(t,n,t,e),!(void 0!==a&&(e.exports=a))},function(e,t,n){var a;a=function(e,t,a){"use strict";var r=n(2),i=r.inject("lpUIUtils",n(5).name),o=r.inject("lpCoreUtils",n(3).name);t.lpPaymentRefDescription=function(e,t,n){return e.put("$paymentRefDescription.html",'<div class="lp-payment-ref-description"><div class="lp-payment-description"><textarea class="new-transfer-height" autocomplete="off" aria-label="payment description" class="form-control lp-payment-description-area" placeholder="Description (optional) Maximum number of characters is 35" maxlength="35" ng-model="paymentDescription"></textarea></div><div ng-if="!hidePaymentReference" class="hover-catcher" ng-class="{refDisabled: paymentRefDisabled}" tooltip-placement="top" tooltip="You can only provide a Payment Reference or a Payment Description, not both."></div></div>'),{restrict:"AE",replace:!0,require:["ngModel","^form"],scope:{paymentOrder:"=ngModel",hidePaymentReference:"="},template:e.get("$paymentRefDescription.html"),link:function(e,a,r,s){var c=s[0],l=s[1],u=a.find("input"),d=(a.find(".hover-catcher"),a.find("textarea"),u[0]),p=[],f=!1,m=0;c.$name=r.name;var y=$(document.createElement("span"));y.addClass("lp-input-cursor-position-offset"),y.css("font-size",a.css("font-size")),$(d).after(y),""!==e.paymentOrder.paymentReference?(e.paymentReference=n("addSeperator")(e.paymentOrder.paymentReference),e.paymentDescDisabled=!0):""!==e.paymentOrder.paymentDescription&&(e.paymentDescription=e.paymentOrder.paymentDescription,e.paymentRefDisabled=!0),e.hidePaymentReference&&(e.paymentDescDisabled=!1);var h=function(e){return e.split(" ").join("")},v=function(e){var t=!0;return e.length>25&&(t=!1),e.match(/^RF\d{2}/)||(t=!1),o.isValidISO7064Checksum(e)||(t=!1),t};e.toggleInfoMessage=function(){e.showInfoMessage=!e.showInfoMessage},e.setCursorPosition=function(){var n=i.getNewCaretPosition(d,p,m,f);if(f=!1,n>4){var a=n/4;parseInt(a,10)===a&&n--,n+=parseInt(a,10)}t(function(){i.setCaretPositionOfInput(d,n,e.paymentReference,y)},20,!1)},e.getSelection=function(e){var t=function(e){var t=0;return t+=parseInt(e/5,10),e-t};p=i.getSelectionPositionOfInput(d,t),"[object KeyboardEvent]"===e.originalEvent.toString()&&8===e.originalEvent.which&&d.value.length&&(f=!0)},e.clearRef=function(){e.paymentReference="",d.focus()},e.$watch("paymentReference",function(t,n){if(n!==t){if(n||(n=""),t){if(t.length>0){l[c.$name]||l.$addControl(c);var a=h(t);e.isValid=v(a),c.$setValidity("validRef",e.isValid),m=n?a.length-h(n).length:a.length,e.paymentDescDisabled=!0,c.$modelValue.paymentReference=a}}else c.$modelValue.paymentReference="",e.paymentDescDisabled=!1,l.$removeControl(c);e.setCursorPosition()}},!0),e.$watch("paymentDescription",function(t,n){n!==t&&(t?t.length>0&&(c.$modelValue.paymentDescription=t):(e.paymentRefDisabled=!1,c.$modelValue.paymentDescription=""))},!0),e.$on("reset",function(){e.paymentReference="",e.paymentDescription="",e.showInfoMessage=!1,e.paymentRefDisabled=!1,e.paymentDescDisabled=!1})}}},t.lpPaymentRefDescription.$inject=["$templateCache","$timeout","$filter"]}.call(t,n,t,e),!(void 0!==a&&(e.exports=a))},function(e,t,n){var a;a=function(e,t,n){"use strict";t.nonZero=function(){return{restrict:"A",require:"ngModel",link:function(e,t,n,a){a.$parsers.unshift(function(e){return a.$setValidity("nonZero",0!==parseInt(e,10)),e})}}}}.call(t,n,t,e),!(void 0!==a&&(e.exports=a))},function(e,t,n){var a;a=function(e,t,a){"use strict";var r=n(2),i=r.inject("lpCoreUtils",n(3).name);t.p2pEnrollment=function(e,t){return e.put("$emailTemplate.html",'<div class="lp-p2p-enrollment"><p class="warning">We also need a few details from you to make the transfer</p><div lp-accounts-select="lp-accounts-select" designated-class="lp-normal-account-select-size" ng-model="p2pRegistration.p2pAccount" lp-accounts="accounts" name="p2pAccountSelect" ng-change="onP2PAccountChange()"></div><ul tabset="tabset" class="nav-tabs"><li tab="tab"><span tab-heading="tab-heading" class="tab-heading">Email</span><div ng-class="{\'email-input-form\': true, \'has-feedback\': enrollment.email.length > 0, \'has-success\': enrollment.email.length > 0 && validEmail, \'has-error\': enrollment.email.length > 0 && !validEmail}"><input type="input" class="form-control" ng-model="enrollment.email" placeholder="Confirm your email" ng-change="onEmailChange()" aria-label="Email Address"/><span ng-if="validEmail && enrollment.email.length > 0" class="glyphicon glyphicon-ok form-control-feedback"></span><span ng-if="!validEmail && enrollment.email.length > 0" ng-click="clearEmail()" style="cursor: pointer;" class="glyphicon glyphicon-remove form-control-feedback"></span></div></li></ul><div class="ts-and-cs"><div lp-custom-checkbox="" ng-model="p2pRegistration.userAgrees" ng-change="onAgreementChange()" aria-label="{{\'Do you agree with terms and conditions?\' | translate}}"><span style="display:inline-block" lp-i18n="By registering this mobile number or email address, I agree that I am the email or mobile account holder, and I consent to receive email and automated text message about transfers at this time. Fees from carrier may apply"></span></div></div></div>'),{restrict:"EA",replace:!0,require:["ngModel","^form"],scope:{accounts:"=lpAccounts",enrollment:"=ngModel",transferType:"=lpTransferType"},template:e.get("$emailTemplate.html"),link:function(e,n,a,r){var o=r[0],s=r[1];o.$name=a.name,s.$addControl(o);var c=[t.p2pEmail,t.p2pMobile,t.p2pAddress],l=function(){e.p2pRegistration={p2pAccount:{},userAgrees:!1},d(e.transferType)};e.clearEmail=function(){e.enrollment.email=""},e.onP2PAccountChange=function(){e.enrollment.receivingAccountNumber=e.p2pRegistration.p2pAccount.identifier,o.$setValidity("p2pAccountRequired",!0)},e.onEmailChange=function(){u()},e.onAgreementChange=function(){o.$setValidity("termsAndConditions",e.p2pRegistration.userAgrees)},e.$watch("transferType",function(e,t){e!==t&&d(e)});var u=function(){var t;t=e.enrollment?i.isValidEmail(e.enrollment.email):i.isValidEmail(""),o.$setValidity("validEmailRequired",t),e.validEmail=t},d=function(t){for(var n=!1,a=0;a<c.length;a++)t===c[a]&&(n=!0);n?(o.$setValidity("termsAndConditions",e.p2pRegistration.userAgrees),u(),o.$setValidity("p2pAccountRequired",!1)):(o.$setValidity("termsAndConditions",!0),o.$setValidity("validEmailRequired",!0),o.$setValidity("p2pAccountRequired",!0))};l()}}},t.p2pEnrollment.$inject=["$templateCache","transferTypes"]}.call(t,n,t,e),!(void 0!==a&&(e.exports=a))},function(e,t,n){var a;a=function(e,t,a){"use strict";var r=window.jQuery,i=n(2),o=i.inject("lpUIUtils",n(5).name);t.usAccountInput=function(e,t,n,a){return e.put("$usTransferCountryDropdownOption.html",'<span aria-label="{{option.country_name}}">{{option.country_code}}<span class="country-name"> - {{option.country_name}}</span></span>'),e.put("$usAccountInputTemplate.html",'<div class="lp-us-account-input"><div ng-class="{\'has-success\': isRoutingNoValid && routingNumber.length > 0, \'has-error\': !isRoutingNoValid && routingNumber.length, \'has-feedback\': routingNumber.length}"><input type="input" class="form-control routing-number" ng-model="routingNumber" lp-number-input="lp-number-input" min="0" maxlength="9" placeholder="{{\'Routing Number\'|translate}}" aria-required="true" aria-label="{{\'Routing Number\'|translate}}" /><span ng-if="isRoutingNoValid && routingNumber.length" class="glyphicon glyphicon-ok form-control-feedback"></span><span ng-click="resetRoutingNumber()" ng-if="!isRoutingNoValid && routingNumber.length" class="glyphicon glyphicon-remove form-control-feedback clickable-icon"></span></div><div class="lp-acc-plus-country"><div class="country-select" ng-if="showCountryDropdown"><div dropdown-select="dropdown-select" class="country-select" empty-placeholder-text="US" ng-model="selectedCountry" ng-options="country.country_code as country for country in lpCountryList.countries" option-template-url="$usTransferCountryDropdownOption.html"></div></div><div ng-class="{\'has-success\': isAccNoConfirmed && accountNumber.length > 0, \'has-warning\': !isAccNoConfirmed && accountNumber.length, \'has-feedback\': accountNumber.length, \'account-number\': true}"><input type="input" class="form-control" ng-model="accountNumber" lp-number-input="lp-number-input" maxlength="19" min="0" placeholder="{{\'Account Number\'|translate}}" aria-required="true" aria-label="{{\'Account Number\'|translate}}"ng-keydown="getSelection($event)" ng-keypress="getSelection($event)" ng-mousedown="getSelection($event)" ng-mouseup="getSelection($event)"lp-input-overflow="lp-input-overflow" lp-format-us-account="lp-format-us-account"/><span ng-if="isAccNoConfirmed && accountNumber.length" class="glyphicon glyphicon-ok form-control-feedback"></span><span ng-click="confirmAccountNumber()" ng-keydown="confirmKeydown($event)" tabindex="{{!isAccNoConfirmed && accountNumber.length ? 0 : -1}}" ng-if="!isAccNoConfirmed && accountNumber.length" class="glyphicon glyphicon-warning-sign form-control-feedback clickable-icon" aria-label="Confirm Account Number" role="button"></span><div class="lp-input-dividers clearfix" style="top: 28px;"><div class="separator"></div><div class="separator"></div><div class="separator"></div><div class="separator"></div><div class="separator"></div><div class="separator"></div></div></div></div><span class="lp-routing-info text-muted"><span lp-i18n="Where to find your account number & routing number"></span><i class="lp-icon lp-icon-xxl lp-icon-info-sign open-popup" ng-click="modal()"></i></span></div>'),
{restrict:"EA",replace:!0,require:["ngModel","^form"],scope:{account:"=ngModel",lpCountryList:"=",modal:"=",transferType:"=lpTransferType"},template:e.get("$usAccountInputTemplate.html"),link:function(e,i,s,c){var l=function(){e.isAccNoConfirmed=!1,e.isRoutingNoValid=!1,e.showCountryDropdown=e.lpCountryList?!0:!1,e.showCountryDropdown&&e.lpCountryList.default_country&&(e.selectedCountry=e.lpCountryList.default_country.country_code),E(e.transferType||"")},u=c[0],d=c[1];u.$name=s.name,d.$addControl(u),u.$setValidity("accountNumberRequired",!1),u.$setValidity("routingNumberRequired",!1);var p=i.find("input")[1],f=[],m=!1,y=0,h=a.bank,v=r(document.createElement("span"));v.addClass("lp-input-cursor-position-offset"),v.css("font-size",i.css("font-size")),r(p).after(v),u.$formatters.push(function(t){if(t)if(isNaN(parseInt(t.substring(0,2),10)))e.accountNumber="",e.routingNumber="";else{var a=t.split(" ");e.routingNumber=a[0],e.accountNumber=n("addSeperator")(a[1]),g(e.routingNumber),b(e.accountNumber)}else e.accountNumber="",e.routingNumber="";return t}),u.$parsers.push(function(e){var t=e.split(" ");return g(t[0]),b(t[1]),e}),e.confirmAccountNumber=function(){e.isAccNoConfirmed=!0,u.$setValidity("accountNumberConfirmed",!0)},e.confirmKeydown=function(t){13===t.which&&(t.stopPropagation(),t.preventDefault(),e.confirmAccountNumber(),i.find(".routing-number").focus())},e.resetRoutingNumber=function(){e.routingNumber=""},e.getSelection=function(e){var t=function(e){var t=0;return t+=parseInt(e/5,10),e-t};f=o.getSelectionPositionOfInput(p,t),"[object KeyboardEvent]"===e.originalEvent.toString()&&8===e.originalEvent.which&&p.value.length&&(m=!0)},e.setCursorPosition=function(){var n=o.getNewCaretPosition(p,f,y,m);if(m=!1,n>4){var a=n/4;parseInt(a,10)===a&&n--,n+=parseInt(a,10)}t(function(){o.setCaretPositionOfInput(p,n,e.paymentReference,v)},20,!1)},e.$watch("accountNumber",function(t,n){t!==n&&(e.isAccNoConfirmed=!1,D(),e.setCursorPosition())}),e.$watch("routingNumber",function(e,t){e!==t&&D()}),e.$watch("transferType",function(e,t){e!==t&&E(e)}),e.$on("reset",function(){e.routingNumber="",e.accountNumber=""});var g=function(t){if(t.length<9)return e.isRoutingNoValid=!1,void T(t);var n;if("000000000"===t)n=!1;else{var a=parseInt(t[0],10)+parseInt(t[3],10)+parseInt(t[6],10),r=parseInt(t[1],10)+parseInt(t[4],10)+parseInt(t[7],10),i=parseInt(t[2],10)+parseInt(t[5],10)+parseInt(t[8],10),o=3*a+7*r+i;n=o%10,n=0===n?!0:!1}e.isRoutingNoValid=n,T(t)},T=function(t){var n=t.length>0?!0:!1,a=n&&!e.isRoutingNoValid?!1:!0;u.$setValidity("routingNumberRequired",n),u.$setValidity("invalidRoutingNumber",a)},b=function(t){var n=t&&t.length>0?!0:!1,a=t&&t.length>0&&!e.isAccNoConfirmed?!1:!0;u.$setValidity("accountNumberRequired",n),u.$setValidity("accountNumberConfirmed",a)},O=function(e){return e&&(e=e.replace(/ /g,"")),e||""},D=function(){var t=O(e.routingNumber)+" "+O(e.accountNumber);u.$setViewValue(t)},E=function(t){t!==h?(u.$setValidity("accountNumberRequired",!0),u.$setValidity("accountNumberConfirmed",!0),u.$setValidity("routingNumberRequired",!0),u.$setValidity("invalidRoutingNumber",!0)):(g(e.routingNumber||""),b(e.accountNumber||""))};l()}}},t.usAccountInput.$inject=["$templateCache","$timeout","$filter","transferTypes"]}.call(t,n,t,e),!(void 0!==a&&(e.exports=a))},function(e,t,n){var a;a=function(e,t,n){"use strict";t.transferTypes={bank:"INTERNAL",p2pEmail:"P2P_EMAIL",p2pAddress:"P2P_ADDRESS",p2pMobile:"P2P_MOBILE"},t.pendingPaymentOrdersTimeout=1e4,t.customerId="3",t.currencyMaxLength=15}.call(t,n,t,e),!(void 0!==a&&(e.exports=a))},function(e,t,n){var a;a=function(e,t,n){"use strict";t.lpPayments=function(){this.$get=function(e,t,n){function a(){var a=t(r.paymentsEndpoint,{},{getUnsubmitted:{method:"GET",url:r.paymentsEndpoint,isArray:!0},getSI:{method:"GET",url:r.paymentsEndpoint},create:{method:"PUT"},del:{method:"DELETE",url:r.paymentsEndpoint+"/:paymentId"},submit:{method:"POST",url:r.paymentsEndpoint+"/:paymentId/submit"}});return a.prototype.createOrder=function(t){var n=e.defer();return a.create({paymentId:t.id},t,function(e){n.resolve(e)},function(e){n.reject(e)}),n.promise},a.prototype.send=function(t,n){var r=e.defer();return a.submit(t,n||{},function(e){r.resolve(e)},function(e){r.reject(e)}),r.promise},a.prototype.remove=function(t){var n=e.defer();return a.del({paymentId:t},{},function(e){n.resolve(e)},function(e){n.reject(e)}),n.promise},a.prototype.createModel=function(){return new a({id:n.generateUUID()})},a.prototype.load1=function(e){var t={};return a.getUnsubmitted(t).$promise.then(function(e){return this.pendingOrdersGroups=this.preprocessPendingOrdersGroups(e),this.pendingOrdersGroups}.bind(this))},a.prototype.loadSI=function(){return this.pendingOrdersGroups=[],a.getSI().$promise.then(function(e){return e}.bind(this))},a.prototype.load=function(e,t){if(0==e){var n=this,a="";return t&&"null"!==t?n.pendingOrdersGroups=n.preprocessPendingOrdersGroupsByPassingDB(t):n.pendingOrdersGroups=[],a}return{f:0,l:100,ids:accounts.join()},this.pendingOrdersGroups=this.preprocessPendingOrdersGroups(resp),this.pendingOrdersGroups},a.prototype.preprocessPendingOrdersGroups=function(e){for(var t,n=[],a=function(e){for(var t=!1,a=0;a<n.length;a++)n[a]["@id"]===e&&(t=!0);return t},r=function(e){n.push({"@id":e,paymentOrders:[]})},i=function(e){a(e.accountId)||r(e.accountId);for(var t=0;t<n.length;t++)n[t]["@id"]===e.accountId&&n[t].paymentOrders.push(e)},o=0;o<e.length;o++)t=e[o],t.counterpartyIban&&t.counterpartyIban.length>0?t.accountDetails=t.counterpartyIban:t.counterpartyAccount&&t.counterpartyAccount.length>0?t.accountDetails=t.counterpartyAccount:t.counterpartyEmail&&t.counterpartyEmail.length>0&&(t.accountDetails=t.counterpartyEmail),i(t);return n},a.prototype.preprocessPendingOrdersGroupsByPassingDB=function(e){var t,n=[],a=function(e){for(var t=!1,a=0;a<n.length;a++)n[a]["@id"]===e&&(t=!0);return t},r=function(e){n.push({"@id":e,paymentOrders:[]})},i=function(e){a(e.accountId)||r(e.accountId);for(var t=0;t<n.length;t++)n[t]["@id"]===e.accountId&&n[t].paymentOrders.push(e)};return t=e,t.counterpartyIban&&t.counterpartyIban.length>0?t.accountDetails=t.counterpartyIban:t.counterpartyAccount&&t.counterpartyAccount.length>0?t.accountDetails=t.counterpartyAccount:t.counterpartyEmail&&t.counterpartyEmail.length>0&&(t.accountDetails=t.counterpartyEmail),i(t),n},a.prototype.makeFormObject=function(e,t){var n,a="WEEKLY",r="MONTHLY",i="YEARLY",o="QUARTERLY",s="HALF YEARLY",c="D",l="M",u=new Date(parseInt(e.executionDateTime)),d=new Date(t.startDate),p=new Date(t.endDate),f=new Date(e.executionDateTime);e.schedule.frequency==c&&7==e.schedule.intervals?n=a:e.schedule.frequency==l&&1==e.schedule.intervals?n=r:e.schedule.frequency==l&&3==e.schedule.intervals?n=o:e.schedule.frequency==l&&6==e.schedule.intervals?n=s:e.schedule.frequency==l&&12==e.schedule.intervals&&(n=i);var m={update:!0,uuid:e.id,accountId:e.accountId,isScheduledTransfer:e.schedule.intervals?!0:!1,scheduleDate:f,scheduledTransfer:{frequency:n,intervals:e.schedule.intervals?[e.schedule.intervals]:[],timesToRepeat:e.schedule.timesToRepeat||1,customOrder:e.schedule.customOrder||!0,startDate:null==t.startDate?u:d,endDate:null==t.endDate?u:p},selectedCounter:{name:e.counterpartyName,account:e.counterpartyIban||e.counterpartyEmail},instructedCurrency:e.instructedCurrency,counterpartyName:e.counterpartyName,counterpartyAccount:e.counterpartyAccount,counterpartyIban:e.counterpartyIban,counterpartyEmail:e.counterpartyEmail,instructedAmount:parseFloat(e.instructedAmount).toFixed(2),paymentReference:e.paymentReference||"",paymentDescription:t.desc,counterpartyAddress:e.counterpartyAddress||"",isOpenDate:e.isOpenDate||!1,urgentTransfer:e.urgentTransfer||!1,radioModel:e.transferMode,type:e.type,ifscCode:t.ifscCode,details:{startDate:t.startDate,endDate:t.endDate,beneName:e.counterpartyName,beneId:e.beneId,accountId:t.accountId,intervals:e.schedule.intervals,frequency:e.schedule.frequency,creationDate:t.creationDate,toAcctComnt:t.toAcctComnt,instructedCurrency2:t.instructedCurrency2,sys1:t.sys1,id:t.id,chaseDay:t.chaseDay,action:t.action,priority:t.priority,purpose:t.purpose,hldReqdYN:t.hldReqdYN,paymntTyp:t.paymntTyp,fnlPmt:t.fnlPmt,intrnRefNum:t.intrnRefNum,usrId:t.usrId,cal:t.cal,uniqRefNum:t.uniqRefNum,counterpartySirName:t.counterpartySirName,andOrInstBsbNo:t.andOrInstBsbNo,pmtNum:t.pmtNum,msgTyp:t.msgTyp,opertnMode:t.opertnMode,rmtTyp:t.rmtTyp,transferMode:e.transferMode}};return e.schedule.frequency==c&&1==e.schedule.intervals&&(m.isScheduledTransfer=!1),m},new a}var r={paymentsEndpoint:"/rs/v1/ReviewFutureFundTransferService"};return{setConfig:function(e){return r=n(e).chain().mapValues(n.resolvePortalPlaceholders).defaults(r).value(),this},getConfig:function(e){return e&&n.isString(e)?r[e]:r},api:a}},this.$get.$inject=["$q","$resource","lpCoreUtils"]},t.PaymentOrderModel=t.lpPayments}.call(t,n,t,e),!(void 0!==a&&(e.exports=a))},function(e,t,n){var a;a=function(e,t,n){"use strict";function a(e){var t={"payment-orders":e};return{api:function(e){if("undefined"==typeof t[e])throw new Error("Unknown service "+e+" !!!");return t[e]}}}a.$inject=["PaymentOrders"],t.lpAccountTransfers=function(){this.$get=a}}.call(t,n,t,e),!(void 0!==a&&(e.exports=a))},function(e,t,n){var a;a=function(e,t,a){"use strict";function r(e,t){this.xhr=e,this.config={}}var i=n(2).utils,o={},s={url:"/mock/v2/payment-orders"};r.$inject=["$http","lpCoreError"],o.createModel=function(){return{}},o.createOrder=function(e){return this.xhr({method:"POST",url:this.config.url,data:e})},o.send=function(e,t){var n=this.config.url+"/"+e+"/submit";return this.xhr({method:"POST",url:n,data:t||{}})},o.remove=function(e){var t=this.config.url+"/"+e;return this.xhr({method:"DELETE",url:t})},o.makeFormObject=function(e){var t={update:!0,uuid:e.id,accountId:e.accountId,isScheduledTransfer:e.scheduledTransfer.every?!0:!1,scheduleDate:e.onDate?new Date(e.onDate):new Date,scheduledTransfer:{frequency:e.scheduledTransfer.frequency,every:e.scheduledTransfer.every,intervals:e.scheduledTransfer.intervals?[e.schedule.intervals]:[],timesToRepeat:e.scheduledTransfer.timesToRepeat||1,customOrder:e.scheduledTransfer.customOrder||!0,startDate:e.scheduledTransfer.startDate?new Date(e.scheduledTransfer.startDate):new Date},selectedCounter:{name:e.counterpartyName,account:e.counterpartyIban||e.counterpartyEmail},instructedCurrency:e.instructedCurrency,counterpartyName:e.counterpartyName,counterpartyAccount:e.counterpartyAccount,counterpartyIban:e.counterpartyIban||"",counterpartyEmail:e.counterpartyEmail,instructedAmount:e.instructedAmount.toFixed(2),paymentReference:e.paymentReference||"",paymentDescription:e.paymentDescription||"",counterpartyAddress:e.counterpartyAddress||"",isOpenDate:e.isOpenDate||!1,urgentTransfer:e.urgentTransfer||!1,type:e.type};return t},o.setConfig=function(e){return this.config=i.chain(e).mapValues(i.resolvePortalPlaceholders).defaults(s).value(),this},o.getConfig=function(e,t){return e&&i.isString(e)?this.config[e]||t:this.config},i.assign(r.prototype,o),t.PaymentOrders=r}.call(t,n,t,e),!(void 0!==a&&(e.exports=a))}])});
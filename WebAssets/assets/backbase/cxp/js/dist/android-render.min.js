/**
 * CXP Web client for Android and iOS webviews - Copyright Â© 2016 Backbase B.V - All Rights Reserved
 * Version 1.0.0
 * http://www.backbase.com
 */
!function e(t,r,n){function i(s,a){if(!r[s]){if(!t[s]){var c="function"==typeof require&&require;if(!a&&c)return c(s,!0);if(o)return o(s,!0);var u=new Error("Cannot find module '"+s+"'");throw u.code="MODULE_NOT_FOUND",u}var l=r[s]={exports:{}};t[s][0].call(l.exports,function(e){var r=t[s][1][e];return i(r?r:e)},l,l.exports,e,t,r,n)}return r[s].exports}for(var o="function"==typeof require&&require,s=0;s<n.length;s++)i(n[s]);return i}({1:[function(e,t,r){"use strict";var n=(e("javascript-detect-element-resize"),e("cxp-web-apis")),i=e("backbase-widget-engine/src/exports/webview-kit"),o=e("backbase-widget-engine/src/plugins/replace-config-vars-plugin"),s=e("backbase-widget-engine/src/plugins/backbase-format-plugin"),a=e("q");window.renderWidget=function(e,t,r,c,u,l,p,h){function f(){}function d(){return{postRead:function(e){var t=e.preferences.filter(function(e){return"templateUrl"===e.name})[0];return t&&(t._ignoreReplace=!0),e}}}function g(){return{preRender:function(e,t,r){return e.children=r.children?r.children.map(function(e){return{id:e.id,name:e.name}}):[],e}}}console.log("Log level set to "+l),window.Promise=window.Promise||a.Promise,window.syncPreferences={listeners:[],update:function(e,t,r){this.listeners.forEach(function(n){n.call(null,e,t,r)})},addListener:function(e){this.listeners.push(e)}};var m=document.getElementById(e);f.prototype.write=function(e){var t,r=e.childName?e.name+"/"+e.childName:e.name;t=e.level<30?"log":e.level<40?"info":e.level<50?"warn":"error",console[t](r+": "+e.msg)};var v=n.createConfiguration({contextRoot:t,remoteContextRoot:r,logStreams:[{level:l,stream:new f}]});v.set("itemEngineLocator",{locate:function(e,r){var n=e.children?i.ContainerEngine:i.WidgetEngine,o=new n({log:r.log});return o.init({widgetUrl:r.widgetUrl,widgetEl:r.widgetEl,initialModel:e,configVars:{contextRoot:t}}),o}});var y=n.getRenderer(v);y.addPlugin(g()),y.addPlugin(d()),y.addPlugin(new o({contextRoot:t,remoteContextRoot:r})),y.addPlugin(new s({contextRoot:t,remoteContextRoot:r,portalConf:{contextItemName:h},makeIncludedRefsAbsolute:!0})),y.addPlugin({postRead:function(e){return u.forEach(function(t){"SyncedPreferences"===t.name&&e.features.push(t)}),e},preRender:function(e,t,r){return 3==e.length&&(e=e[0]),r.preferences.forEach(function(t){!t.readonly&&t.name in p&&("__null__"===p[t.name]&&(p[t.name]=null),e.preferences.setItem(t.name,p[t.name]))}),window.syncPreferences.addListener(function(t,r,n){if(e.preferences.hasOwnProperty(r)&&r in p){e.preferences._eventsEnabled=!1;try{"setItem"===t?e.preferences.setItem(r,n):"removeItem"===t&&e.preferences.setItem(r,null)}catch(i){console.log(i)}e.preferences._eventsEnabled=!0}}),e.addEventListener("storage",function(t){if(t.key in p){var r=t.newValue,n=e.features.SyncedPreferences;n&&n.setItem(null,null,t.key,r)}}),e}});for(var b=0;b<u.length;b++)y.addFeature(u[b]);var w=c.features?c:c.children;y.start(w,m).then(function(e){var t="Item tree rendered in "+e.time+"ms",r=document.getElementsByTagName("html")[0],n=function(){Cxp.resize(r.scrollHeight)};addResizeListener(r,n),console.log(t),Cxp.itemLoaded()}).fail(function(e){console.log(e)})}},{"backbase-widget-engine/src/exports/webview-kit":77,"backbase-widget-engine/src/plugins/backbase-format-plugin":78,"backbase-widget-engine/src/plugins/replace-config-vars-plugin":80,"cxp-web-apis":197,"javascript-detect-element-resize":222,q:223}],2:[function(e,t,r){"use strict";function n(e){if("undefined"==typeof e||null===e)return e;if(Array.isArray(e))return e.slice();if("object"==typeof e){var t={};return Object.keys(e).forEach(function(r){t[r]=e[r]}),t}return e}function i(){var e={},t=Error.stackTraceLimit,r=Error.prepareStackTrace;return Error.stackTraceLimit=3,Error.prepareStackTrace=function(t,r){var n=r[2];e.file=n.getFileName(),e.line=n.getLineNumber();var i=n.getFunctionName();i&&(e.func=i)},Error.stackTraceLimit=t,Error.prepareStackTrace=r,e}function o(e,t){t||(t="    ");var r=e.split(/\r?\n/g);return t+r.join("\n"+t)}function s(e,t){if(t){if(y[t])return;y[t]=!0}console.error(e+"\n")}function a(e){return y[e]}function c(){}function u(){}function l(e){var t="string"==typeof e?S[e.toLowerCase()]:e;return t}function p(e,t,r){if(!(this instanceof p))return new p(e,t);var i;if(void 0!==t&&(i=e,e=t,!(i instanceof p)))throw new TypeError("invalid Logger creation: do not pass a second arg");if(!e)throw new TypeError("options (object) is required");if(i){if(e.name)throw new TypeError("invalid options.name: child cannot set logger name")}else if(!e.name)throw new TypeError("options.name (string) is required");if(e.stream&&e.streams)throw new TypeError('cannot mix "streams" and "stream" options');if(e.streams&&!Array.isArray(e.streams))throw new TypeError("invalid options.streams: must be an array");if(e.serializers&&("object"!=typeof e.serializers||Array.isArray(e.serializers)))throw new TypeError("invalid options.serializers: must be an object");var o,s,a;if(i&&r){this._isSimpleChild=!0,this._level=i._level,this.streams=i.streams,this.serializers=i.serializers,this.src=i.src,o=this.fields={};var u=Object.keys(i.fields);for(a=0;a<u.length;a++)s=u[a],o[s]=i.fields[s];var l=Object.keys(e);for(a=0;a<l.length;a++)s=l[a],o[s]=e[s]}else{var h=this;if(i){for(this._level=i._level,this.streams=[],a=0;a<i.streams.length;a++){var f=n(i.streams[a]);f.closeOnExit=!1,this.streams.push(f)}this.serializers=n(i.serializers),this.src=i.src,this.fields=n(i.fields),e.level&&this.level(e.level)}else this._level=Number.POSITIVE_INFINITY,this.streams=[],this.serializers=null,this.src=!1,this.fields={};e.stream?h.addStream({type:"stream",stream:e.stream,closeOnExit:!1,level:e.level}):e.streams?e.streams.forEach(function(t){h.addStream(t,e.level)}):i&&e.level?this.level(e.level):i||h.addStream({type:"raw",stream:new c,closeOnExit:!1,level:e.level}),e.serializers&&h.addSerializers(e.serializers),e.src&&(this.src=!0),o=n(e),delete o.stream,delete o.level,delete o.streams,delete o.serializers,delete o.src,this.serializers&&this._applySerializers(o),Object.keys(o).forEach(function(e){h.fields[e]=o[e]})}}function h(e){return function(){function t(t){var s;t[0]instanceof Error?(o={err:r.serializers&&r.serializers.err?r.serializers.err(t[0]):p.stdSerializers.err(t[0])},s={err:!0},c=1===t.length?[o.err.message]:Array.prototype.slice.call(t,1)):"object"!=typeof t[0]&&null!==t[0]||Array.isArray(t[0])?(o=null,c=Array.prototype.slice.call(t)):(o=t[0],c=Array.prototype.slice.call(t,1));var a=n(r.fields);a.level=e;var u=o?n(o):null;return u&&(r.serializers&&r._applySerializers(u,s),Object.keys(u).forEach(function(e){a[e]=u[e]})),a.levelName=A[e],a.msg=v.apply(r,c),a.time||(a.time=new Date),r.src&&!a.src&&(a.src=i()),a.v=m,a}var r=this,o=null,c=arguments,u=null;if(this._emit)return 0===arguments.length?this._level<=e:void(this._level>e||(u=t(c),this._emit(u)));var l="unbound";if(!a[l]){var h=i();s(v("bunyan usage error: %s:%s: attempt to log with an unbound log method: `this` is: %s",h.file,h.line,this.toString()),l)}}}function f(e){var t=e.stack||e.toString();if(e.cause&&"function"==typeof e.cause){var r=e.cause();r&&(t+="\nCaused by: "+f(r))}return t}function d(){var e=[];return function(t,r){return r&&"object"==typeof r?-1!==e.indexOf(r)?"[Circular]":(e.push(r),r):r}}var g="0.2.3",m=0,v=function(e){if(null===e)return"null";if("string"!=typeof e)return e.toString();for(var t=/%[sdj%]/g,r=1,n=arguments,i=n.length,o=String(e).replace(t,function(e){if("%%"===e)return"%";if(r>=i)return e;switch(e){case"%s":return String(n[r++]);case"%d":return Number(n[r++]);case"%j":try{return JSON.stringify(n[r++])}catch(t){return"[Circular]"}break;default:return e}}),s=n[r];i>r;s=n[++r])o+=" "+s;return o},y={};c.prototype.write=function(e){e.level<E?console.log(e):e.level<x?console.info(e):e.level<_?console.warn(e):console.error(e),e.err&&e.err.stack&&console.error(e.err.stack)},u.prototype.write=function(e){function t(e,t){return Array(t+1-(e+"").length).join("0")+e}var r,n="color: DimGray",i="color: SteelBlue";r=e.level<w?"color: DeepPink":e.level<E?"color: GoldenRod":e.level<x?"color: DarkTurquoise":e.level<_?"color: Purple":e.level<k?"color: Crimson":"color: Black";var o=e.childName?e.name+"/"+e.childName:e.name,s=A[e.level].toUpperCase();s=Array(6-s.length).join(" ")+s,console.log("[%s:%s:%s:%s] %c%s%c: %s: %c%s",t(e.time.getHours(),2),t(e.time.getMinutes(),2),t(e.time.getSeconds(),2),t(e.time.getMilliseconds(),4),r,s,n,o,i,e.msg),e.err&&e.err.stack&&console.log("%c%s,",r,e.err.stack)};var b=10,w=20,E=30,x=40,_=50,k=60,S={trace:b,debug:w,info:E,warn:x,error:_,fatal:k},A={};Object.keys(S).forEach(function(e){A[S[e]]=e}),p.prototype.addStream=function(e,t){var r=this;switch((null===t||void 0===t)&&(t=E),e=n(e),!e.type&&e.stream&&(e.type="raw"),e.raw="raw"===e.type,e.level?e.level=l(e.level):e.level=l(t),e.level<r._level&&(r._level=e.level),e.type){case"stream":e.closeOnExit||(e.closeOnExit=!1);break;case"raw":e.closeOnExit||(e.closeOnExit=!1);break;default:throw new TypeError('unknown stream type "'+e.type+'"')}r.streams.push(e),delete r.haveNonRawStreams},p.prototype.addSerializers=function(e){var t=this;t.serializers||(t.serializers={}),Object.keys(e).forEach(function(r){var n=e[r];if("function"!=typeof n)throw new TypeError(v('invalid serializer for "%s" field: must be a function',r));t.serializers[r]=n})},p.prototype.child=function(e,t){return new this.constructor(this,e||{},t)},p.prototype.level=function(e){if(void 0===e)return this._level;for(var t=l(e),r=this.streams.length,n=0;r>n;n++)this.streams[n].level=t;this._level=t},p.prototype.levels=function(e,t){if(void 0===e)return this.streams.map(function(e){return e.level});var r;if("number"==typeof e){if(r=this.streams[e],void 0===r)throw new Error("invalid stream index: "+e)}else{for(var n=this.streams.length,i=0;n>i;i++){var o=this.streams[i];if(o.name===e){r=o;break}}if(!r)throw new Error(v('no stream with name "%s"',e))}if(void 0===t)return r.level;var s=l(t);r.level=s,s<this._level&&(this._level=s)},p.prototype._applySerializers=function(e,t){var r=this;Object.keys(this.serializers).forEach(function(n){if(!(void 0===e[n]||t&&t[n]))try{e[n]=r.serializers[n](e[n])}catch(i){s(v('bunyan: ERROR: Exception thrown from the "%s" Bunyan serializer. This should never happen. This is a bugin that serializer function.\n%s',n,i.stack||i)),e[n]=v('(Error in Bunyan log "%s" serializer broke field. See stderr for details.)',n)}})},p.prototype._emit=function(e,t){var r;if(void 0===this.haveNonRawStreams)for(this.haveNonRawStreams=!1,r=0;r<this.streams.length;r++)if(!this.streams[r].raw){this.haveNonRawStreams=!0;break}var n;if(t||this.haveNonRawStreams)try{n=JSON.stringify(e,d())+"\n"}catch(i){var a=i.stack.split(/\n/g,2).join("\n");s('bunyan: ERROR: Exception in `JSON.stringify(rec)`. You can install the "safe-json-stringify" module to have Bunyan fallback to safer stringification. Record:\n'+o(v("%s\n%s",e,i.stack)),a),n=v("(Exception in JSON.stringify(rec): %j. See stderr for details.)\n",i.message)}if(t)return n;var c=e.level;for(r=0;r<this.streams.length;r++){var u=this.streams[r];u.level<=c&&u.stream.write(u.raw?e:n)}return n},p.prototype.trace=h(b),p.prototype.debug=h(w),p.prototype.info=h(E),p.prototype.warn=h(x),p.prototype.error=h(_),p.prototype.fatal=h(k),p.stdSerializers={},p.stdSerializers.err=function(e){if(!e||!e.stack)return e;var t={message:e.message,name:e.name,stack:f(e),code:e.code,signal:e.signal};return t},t.exports=p,t.exports.TRACE=b,t.exports.DEBUG=w,t.exports.INFO=E,t.exports.WARN=x,t.exports.ERROR=_,t.exports.FATAL=k,t.exports.resolveLevel=l,t.exports.levelFromName=S,t.exports.nameFromLevel=A,t.exports.VERSION=g,t.exports.LOG_VERSION=m,t.exports.createLogger=function(e){return new p(e)},t.exports.safeCycles=d,t.exports.ConsoleFormattedStream=u,t.exports.ConsoleRawStream=c},{}],3:[function(e,t,r){t.exports=function(){"use strict";function e(e,t,r){s.value=r,a(e,t,s),s.value=null}function t(t,r,n){var i;u.call(t,r)?i=t[r]:e(t,r,i=[]),c.call(i,n)<0&&i.push(n)}function r(e,t,r){var n,i,o;if(u.call(e,t))for(r.target=e,n=e[t].slice(0),o=0;o<n.length;o++)i=n[o],"function"==typeof i?i.call(e,r):"function"==typeof i.handleEvent&&i.handleEvent(r)}function n(e,t,r){var n,i;u.call(e,t)&&(n=e[t],i=c.call(n,r),i>-1&&(n.splice(i,1),n.length||delete e[t]))}var i="@@",o={},s={configurable:!0,value:null},a=Object.defineProperty||function(e,t,r){e[t]=r.value},c=[].indexOf||function(e){for(var t=this.length;t--&&this[t]!==e;);return t},u=o.hasOwnProperty;return e(o,"addEventListener",function(e,r){t(this,i+e,r)}),e(o,"dispatchEvent",function(e){r(this,i+e.type,e)}),e(o,"removeEventListener",function(e,t){n(this,i+e,t)}),o}()},{}],4:[function(e,t,r){"use strict";function n(e){this.map={};var t=this;e instanceof n?e.forEach(function(e,r){r.forEach(function(r){t.append(e,r)})}):e&&Object.getOwnPropertyNames(e).forEach(function(r){t.append(r,e[r])})}function i(e){return e.bodyUsed?h.reject(new TypeError("Already read")):void(e.bodyUsed=!0)}function o(){this._body=null,this.bodyUsed=!1,this.arrayBuffer=function(){throw new Error("Not implemented yet")};var e=function(){try{return new Blob,!0}catch(e){return!1}}();return e&&(this.blob=function(){var e=i(this);return e?e:h.resolve(new Blob([this._body]))}),this.formData=function(){var e=i(this);return e?e:h.resolve(c(this._body))},this.json=function(){var e=i(this);if(e)return e;var t=this._body;return new h(function(e,r){try{e(JSON.parse(t))}catch(n){r(n)}})},this.text=function(){var e=i(this);return e?e:h.resolve(this._body)},this}function s(e){var t=e.toUpperCase();return f.indexOf(t)>-1?t:e}function a(e,t){t=t||{},this.url=e,this._body=t.body,this.credentials=t.credentials||null,this.headers=new n(t.headers),this.method=s(t.method||"GET"),this.mode=t.mode||null,this.referrer=null}function c(e){var t=new FormData;return e.trim().split("&").forEach(function(e){if(e){var r=e.split("="),n=r.shift().replace(/\+/g," "),i=r.join("=").replace(/\+/g," ");t.append(decodeURIComponent(n),decodeURIComponent(i))}}),t}function u(e){var t=new n,r=e.getAllResponseHeaders().trim().split("\n");return r.forEach(function(e){var r=e.trim().split(":"),n=r.shift().trim(),i=r.join(":").trim();t.append(n,i)}),t}function l(e,t){this._body=e,this.type="default",this.url=null,this.status=t.status,this.statusText=t.statusText,this.headers=t.headers}function p(e){if(!h&&!e)throw new Error("Please supply a promise implementation");e&&(h=e)}var h=h;n.prototype.append=function(e,t){var r=this.map[e];r||(r=[],this.map[e]=r),r.push(t)},n.prototype["delete"]=function(e){delete this.map[e]},n.prototype.get=function(e){var t=this.map[e];return t?t[0]:null},n.prototype.getAll=function(e){return this.map[e]||[]},n.prototype.has=function(e){return this.map.hasOwnProperty(e)},n.prototype.set=function(e,t){this.map[e]=[t]},n.prototype.forEach=function(e){var t=this;Object.getOwnPropertyNames(this.map).forEach(function(r){e(r,t.map[r])})};var f=["DELETE","GET","HEAD","OPTIONS","POST","PUT"];a.prototype.fetch=function(){var e=this;return new h(function(t,r){var n=new XMLHttpRequest;n.onload=function(){var e=1223===n.status?204:n.status;if(0!==e&&(100>e||e>599))return void r(new TypeError("Network request failed"));var i={status:e,statusText:n.statusText,headers:u(n)};t(new l(n.responseText,i))},n.onerror=function(){r(new TypeError("Network request failed"))},n.open(e.method,e.url),e.headers.forEach(function(e,t){t.forEach(function(t){n.setRequestHeader(e,t)})}),n.send(void 0===e._body?null:e._body)})},o.call(a.prototype),o.call(l.prototype),t.exports=function(e,t){return p(e,t),{Headers:n,Request:a,Response:l,fetch:function(e,t){return new a(e,t).fetch()}}},t.exports.promiseImpl=p},{}],5:[function(e,t,r){!function(e,n){"object"==typeof r&&"object"==typeof t?t.exports=n():"function"==typeof define&&define.amd?define(n):"object"==typeof r?r.Handlebars=n():e.Handlebars=n()}(this,function(){return function(e){function t(n){if(r[n])return r[n].exports;var i=r[n]={exports:{},id:n,loaded:!1};return e[n].call(i.exports,i,i.exports,t),i.loaded=!0,i.exports}var r={};return t.m=e,t.c=r,t.p="",t(0)}([function(e,t,r){"use strict";function n(){var e=v();return e.compile=function(t,r){return l.compile(t,r,e)},e.precompile=function(t,r){return l.precompile(t,r,e)},e.AST=c["default"],e.Compiler=l.Compiler,e.JavaScriptCompiler=h["default"],e.Parser=u.parser,e.parse=u.parse,e}var i=r(8)["default"];t.__esModule=!0;var o=r(1),s=i(o),a=r(2),c=i(a),u=r(3),l=r(4),p=r(5),h=i(p),f=r(6),d=i(f),g=r(7),m=i(g),v=s["default"].create,y=n();y.create=n,m["default"](y),y.Visitor=d["default"],y["default"]=y,t["default"]=y,e.exports=t["default"]},function(e,t,r){"use strict";function n(){var e=new s.HandlebarsEnvironment;return h.extend(e,s),e.SafeString=c["default"],e.Exception=l["default"],e.Utils=h,e.escapeExpression=h.escapeExpression,e.VM=d,e.template=function(t){return d.template(t,e)},e}var i=r(8)["default"];t.__esModule=!0;var o=r(9),s=i(o),a=r(10),c=i(a),u=r(11),l=i(u),p=r(12),h=i(p),f=r(13),d=i(f),g=r(7),m=i(g),v=n();v.create=n,m["default"](v),v["default"]=v,t["default"]=v,e.exports=t["default"]},function(e,t){"use strict";t.__esModule=!0;var r={Program:function(e,t,r,n){this.loc=n,this.type="Program",this.body=e,this.blockParams=t,this.strip=r},MustacheStatement:function(e,t,r,n,i,o){this.loc=o,this.type="MustacheStatement",this.path=e,this.params=t||[],this.hash=r,this.escaped=n,this.strip=i},BlockStatement:function(e,t,r,n,i,o,s,a,c){this.loc=c,this.type="BlockStatement",this.path=e,this.params=t||[],this.hash=r,this.program=n,this.inverse=i,this.openStrip=o,this.inverseStrip=s,this.closeStrip=a},PartialStatement:function(e,t,r,n,i){this.loc=i,this.type="PartialStatement",this.name=e,this.params=t||[],this.hash=r,this.indent="",this.strip=n},ContentStatement:function(e,t){this.loc=t,this.type="ContentStatement",this.original=this.value=e},CommentStatement:function(e,t,r){this.loc=r,this.type="CommentStatement",this.value=e,this.strip=t},SubExpression:function(e,t,r,n){this.loc=n,this.type="SubExpression",this.path=e,this.params=t||[],this.hash=r},PathExpression:function(e,t,r,n,i){this.loc=i,this.type="PathExpression",this.data=e,this.original=n,this.parts=r,this.depth=t},StringLiteral:function(e,t){this.loc=t,this.type="StringLiteral",this.original=this.value=e},NumberLiteral:function(e,t){this.loc=t,this.type="NumberLiteral",this.original=this.value=Number(e)},BooleanLiteral:function(e,t){this.loc=t,this.type="BooleanLiteral",this.original=this.value="true"===e},UndefinedLiteral:function(e){this.loc=e,this.type="UndefinedLiteral",this.original=this.value=void 0},NullLiteral:function(e){this.loc=e,this.type="NullLiteral",this.original=this.value=null},Hash:function(e,t){this.loc=t,this.type="Hash",this.pairs=e},HashPair:function(e,t,r){this.loc=r,this.type="HashPair",this.key=e,this.value=t},helpers:{helperExpression:function(e){return!("SubExpression"!==e.type&&!e.params.length&&!e.hash)},scopedId:function(e){return/^\.|this\b/.test(e.original)},simpleId:function(e){return 1===e.parts.length&&!r.helpers.scopedId(e)&&!e.depth}}};t["default"]=r,e.exports=t["default"]},function(e,t,r){"use strict";function n(e,t){if("Program"===e.type)return e;s["default"].yy=d,d.locInfo=function(e){return new d.SourceLocation(t&&t.srcName,e)};var r=new l["default"];return r.accept(s["default"].parse(e))}var i=r(8)["default"];t.__esModule=!0,t.parse=n;var o=r(14),s=i(o),a=r(2),c=i(a),u=r(15),l=i(u),p=r(16),h=i(p),f=r(12);t.parser=s["default"];var d={};f.extend(d,h,c["default"])},function(e,t,r){"use strict";function n(){}function i(e,t,r){if(null==e||"string"!=typeof e&&"Program"!==e.type)throw new l["default"]("You must pass a string or Handlebars AST to Handlebars.precompile. You passed "+e);t=t||{},"data"in t||(t.data=!0),t.compat&&(t.useDepths=!0);var n=r.parse(e,t),i=(new r.Compiler).compile(n,t);return(new r.JavaScriptCompiler).compile(i,t)}function o(e,t,r){function n(){var t=r.parse(e,o),n=(new r.Compiler).compile(t,o),i=(new r.JavaScriptCompiler).compile(n,o,void 0,!0);return r.template(i)}function i(e,t){return s||(s=n()),s.call(this,e,t)}var o=void 0===arguments[1]?{}:arguments[1];if(null==e||"string"!=typeof e&&"Program"!==e.type)throw new l["default"]("You must pass a string or Handlebars AST to Handlebars.compile. You passed "+e);"data"in o||(o.data=!0),o.compat&&(o.useDepths=!0);var s=void 0;return i._setup=function(e){return s||(s=n()),s._setup(e)},i._child=function(e,t,r,i){return s||(s=n()),s._child(e,t,r,i)},i}function s(e,t){if(e===t)return!0;if(p.isArray(e)&&p.isArray(t)&&e.length===t.length){for(var r=0;r<e.length;r++)if(!s(e[r],t[r]))return!1;return!0}}function a(e){if(!e.path.parts){var t=e.path;e.path=new f["default"].PathExpression(!1,0,[t.original+""],t.original+"",t.loc)}}var c=r(8)["default"];t.__esModule=!0,t.Compiler=n,t.precompile=i,t.compile=o;var u=r(11),l=c(u),p=r(12),h=r(2),f=c(h),d=[].slice;n.prototype={compiler:n,equals:function(e){var t=this.opcodes.length;if(e.opcodes.length!==t)return!1;for(var r=0;t>r;r++){var n=this.opcodes[r],i=e.opcodes[r];if(n.opcode!==i.opcode||!s(n.args,i.args))return!1}t=this.children.length;for(var r=0;t>r;r++)if(!this.children[r].equals(e.children[r]))return!1;return!0},guid:0,compile:function(e,t){this.sourceNode=[],this.opcodes=[],this.children=[],this.options=t,this.stringParams=t.stringParams,this.trackIds=t.trackIds,t.blockParams=t.blockParams||[];var r=t.knownHelpers;if(t.knownHelpers={helperMissing:!0,blockHelperMissing:!0,each:!0,"if":!0,unless:!0,"with":!0,log:!0,lookup:!0},r)for(var n in r)n in r&&(t.knownHelpers[n]=r[n]);return this.accept(e)},compileProgram:function(e){var t=new this.compiler,r=t.compile(e,this.options),n=this.guid++;return this.usePartial=this.usePartial||r.usePartial,this.children[n]=r,this.useDepths=this.useDepths||r.useDepths,n},accept:function(e){this.sourceNode.unshift(e);var t=this[e.type](e);return this.sourceNode.shift(),t},Program:function(e){this.options.blockParams.unshift(e.blockParams);for(var t=e.body,r=t.length,n=0;r>n;n++)this.accept(t[n]);return this.options.blockParams.shift(),this.isSimple=1===r,this.blockParams=e.blockParams?e.blockParams.length:0,this},BlockStatement:function(e){a(e);var t=e.program,r=e.inverse;t=t&&this.compileProgram(t),r=r&&this.compileProgram(r);var n=this.classifySexpr(e);"helper"===n?this.helperSexpr(e,t,r):"simple"===n?(this.simpleSexpr(e),this.opcode("pushProgram",t),this.opcode("pushProgram",r),this.opcode("emptyHash"),this.opcode("blockValue",e.path.original)):(this.ambiguousSexpr(e,t,r),this.opcode("pushProgram",t),this.opcode("pushProgram",r),this.opcode("emptyHash"),this.opcode("ambiguousBlockValue")),this.opcode("append")},PartialStatement:function(e){this.usePartial=!0;var t=e.params;if(t.length>1)throw new l["default"]("Unsupported number of partial arguments: "+t.length,e);t.length||t.push({type:"PathExpression",parts:[],depth:0});var r=e.name.original,n="SubExpression"===e.name.type;n&&this.accept(e.name),this.setupFullMustacheParams(e,void 0,void 0,!0);var i=e.indent||"";this.options.preventIndent&&i&&(this.opcode("appendContent",i),i=""),this.opcode("invokePartial",n,r,i),this.opcode("append")},MustacheStatement:function(e){this.SubExpression(e),this.opcode(e.escaped&&!this.options.noEscape?"appendEscaped":"append")},ContentStatement:function(e){e.value&&this.opcode("appendContent",e.value)},CommentStatement:function(){},SubExpression:function(e){a(e);var t=this.classifySexpr(e);"simple"===t?this.simpleSexpr(e):"helper"===t?this.helperSexpr(e):this.ambiguousSexpr(e)},ambiguousSexpr:function(e,t,r){var n=e.path,i=n.parts[0],o=null!=t||null!=r;this.opcode("getContext",n.depth),this.opcode("pushProgram",t),this.opcode("pushProgram",r),this.accept(n),this.opcode("invokeAmbiguous",i,o)},simpleSexpr:function(e){this.accept(e.path),this.opcode("resolvePossibleLambda")},helperSexpr:function(e,t,r){var n=this.setupFullMustacheParams(e,t,r),i=e.path,o=i.parts[0];if(this.options.knownHelpers[o])this.opcode("invokeKnownHelper",n.length,o);else{if(this.options.knownHelpersOnly)throw new l["default"]("You specified knownHelpersOnly, but used the unknown helper "+o,e);i.falsy=!0,this.accept(i),this.opcode("invokeHelper",n.length,i.original,f["default"].helpers.simpleId(i))}},PathExpression:function(e){this.addDepth(e.depth),this.opcode("getContext",e.depth);var t=e.parts[0],r=f["default"].helpers.scopedId(e),n=!e.depth&&!r&&this.blockParamIndex(t);n?this.opcode("lookupBlockParam",n,e.parts):t?e.data?(this.options.data=!0,this.opcode("lookupData",e.depth,e.parts)):this.opcode("lookupOnContext",e.parts,e.falsy,r):this.opcode("pushContext")},StringLiteral:function(e){this.opcode("pushString",e.value)},NumberLiteral:function(e){this.opcode("pushLiteral",e.value)},BooleanLiteral:function(e){this.opcode("pushLiteral",e.value)},UndefinedLiteral:function(){this.opcode("pushLiteral","undefined")},NullLiteral:function(){this.opcode("pushLiteral","null")},Hash:function(e){var t=e.pairs,r=0,n=t.length;for(this.opcode("pushHash");n>r;r++)this.pushParam(t[r].value);for(;r--;)this.opcode("assignToHash",t[r].key);this.opcode("popHash")},opcode:function(e){this.opcodes.push({opcode:e,args:d.call(arguments,1),loc:this.sourceNode[0].loc})},addDepth:function(e){e&&(this.useDepths=!0)},classifySexpr:function(e){var t=f["default"].helpers.simpleId(e.path),r=t&&!!this.blockParamIndex(e.path.parts[0]),n=!r&&f["default"].helpers.helperExpression(e),i=!r&&(n||t);if(i&&!n){var o=e.path.parts[0],s=this.options;s.knownHelpers[o]?n=!0:s.knownHelpersOnly&&(i=!1)}return n?"helper":i?"ambiguous":"simple"},pushParams:function(e){for(var t=0,r=e.length;r>t;t++)this.pushParam(e[t])},pushParam:function(e){var t=null!=e.value?e.value:e.original||"";if(this.stringParams)t.replace&&(t=t.replace(/^(\.?\.\/)*/g,"").replace(/\//g,".")),e.depth&&this.addDepth(e.depth),this.opcode("getContext",e.depth||0),this.opcode("pushStringParam",t,e.type),"SubExpression"===e.type&&this.accept(e);else{if(this.trackIds){var r=void 0;if(!e.parts||f["default"].helpers.scopedId(e)||e.depth||(r=this.blockParamIndex(e.parts[0])),r){var n=e.parts.slice(1).join(".");this.opcode("pushId","BlockParam",r,n)}else t=e.original||t,t.replace&&(t=t.replace(/^\.\//g,"").replace(/^\.$/g,"")),this.opcode("pushId",e.type,t)}this.accept(e)}},setupFullMustacheParams:function(e,t,r,n){var i=e.params;return this.pushParams(i),this.opcode("pushProgram",t),this.opcode("pushProgram",r),e.hash?this.accept(e.hash):this.opcode("emptyHash",n),i},blockParamIndex:function(e){for(var t=0,r=this.options.blockParams.length;r>t;t++){var n=this.options.blockParams[t],i=n&&p.indexOf(n,e);if(n&&i>=0)return[t,i]}}}},function(e,t,r){"use strict";function n(e){this.value=e}function i(){}function o(e,t,r,n){var i=t.popStack(),o=0,s=r.length;for(e&&s--;s>o;o++)i=t.nameLookup(i,r[o],n);return e?[t.aliasable("this.strict"),"(",i,", ",t.quotedString(r[o]),")"]:i}var s=r(8)["default"];t.__esModule=!0;var a=r(9),c=r(11),u=s(c),l=r(12),p=r(17),h=s(p);i.prototype={nameLookup:function(e,t){return i.isValidJavaScriptVariableName(t)?[e,".",t]:[e,"['",t,"']"]},depthedLookup:function(e){return[this.aliasable("this.lookup"),'(depths, "',e,'")']},compilerInfo:function(){var e=a.COMPILER_REVISION,t=a.REVISION_CHANGES[e];return[e,t]},appendToBuffer:function(e,t,r){return l.isArray(e)||(e=[e]),e=this.source.wrap(e,t),this.environment.isSimple?["return ",e,";"]:r?["buffer += ",e,";"]:(e.appendToBuffer=!0,e)},initializeBuffer:function(){return this.quotedString("")},compile:function(e,t,r,n){this.environment=e,this.options=t,this.stringParams=this.options.stringParams,this.trackIds=this.options.trackIds,this.precompile=!n,this.name=this.environment.name,this.isChild=!!r,this.context=r||{programs:[],environments:[]},this.preamble(),this.stackSlot=0,this.stackVars=[],this.aliases={},this.registers={list:[]},this.hashes=[],this.compileStack=[],this.inlineStack=[],this.blockParams=[],this.compileChildren(e,t),this.useDepths=this.useDepths||e.useDepths||this.options.compat,this.useBlockParams=this.useBlockParams||e.useBlockParams;var i=e.opcodes,o=void 0,s=void 0,a=void 0,c=void 0;for(a=0,c=i.length;c>a;a++)o=i[a],this.source.currentLocation=o.loc,s=s||o.loc,this[o.opcode].apply(this,o.args);if(this.source.currentLocation=s,this.pushSource(""),this.stackSlot||this.inlineStack.length||this.compileStack.length)throw new u["default"]("Compile completed with content left on stack");var l=this.createFunctionContext(n);if(this.isChild)return l;var p={compiler:this.compilerInfo(),main:l},h=this.context.programs;for(a=0,c=h.length;c>a;a++)h[a]&&(p[a]=h[a]);return this.environment.usePartial&&(p.usePartial=!0),this.options.data&&(p.useData=!0),this.useDepths&&(p.useDepths=!0),this.useBlockParams&&(p.useBlockParams=!0),this.options.compat&&(p.compat=!0),n?p.compilerOptions=this.options:(p.compiler=JSON.stringify(p.compiler),this.source.currentLocation={start:{line:1,column:0}},p=this.objectLiteral(p),t.srcName?(p=p.toStringWithSourceMap({file:t.destName}),p.map=p.map&&p.map.toString()):p=p.toString()),p},preamble:function(){this.lastContext=0,this.source=new h["default"](this.options.srcName)},createFunctionContext:function(e){var t="",r=this.stackVars.concat(this.registers.list);r.length>0&&(t+=", "+r.join(", "));var n=0;for(var i in this.aliases){var o=this.aliases[i];this.aliases.hasOwnProperty(i)&&o.children&&o.referenceCount>1&&(t+=", alias"+ ++n+"="+i,o.children[0]="alias"+n)}var s=["depth0","helpers","partials","data"];(this.useBlockParams||this.useDepths)&&s.push("blockParams"),this.useDepths&&s.push("depths");var a=this.mergeSource(t);return e?(s.push(a),Function.apply(this,s)):this.source.wrap(["function(",s.join(","),") {\n  ",a,"}"])},mergeSource:function(e){var t=this.environment.isSimple,r=!this.forceBuffer,n=void 0,i=void 0,o=void 0,s=void 0;return this.source.each(function(e){e.appendToBuffer?(o?e.prepend("  + "):o=e,s=e):(o&&(i?o.prepend("buffer += "):n=!0,s.add(";"),o=s=void 0),i=!0,t||(r=!1))}),r?o?(o.prepend("return "),s.add(";")):i||this.source.push('return "";'):(e+=", buffer = "+(n?"":this.initializeBuffer()),o?(o.prepend("return buffer + "),s.add(";")):this.source.push("return buffer;")),e&&this.source.prepend("var "+e.substring(2)+(n?"":";\n")),this.source.merge()},blockValue:function(e){var t=this.aliasable("helpers.blockHelperMissing"),r=[this.contextName(0)];this.setupHelperArgs(e,0,r);var n=this.popStack();r.splice(1,0,n),this.push(this.source.functionCall(t,"call",r))},ambiguousBlockValue:function(){var e=this.aliasable("helpers.blockHelperMissing"),t=[this.contextName(0)];this.setupHelperArgs("",0,t,!0),this.flushInline();var r=this.topStack();t.splice(1,0,r),this.pushSource(["if (!",this.lastHelper,") { ",r," = ",this.source.functionCall(e,"call",t),"}"])},appendContent:function(e){this.pendingContent?e=this.pendingContent+e:this.pendingLocation=this.source.currentLocation,this.pendingContent=e},append:function(){if(this.isInline())this.replaceStack(function(e){return[" != null ? ",e,' : ""']}),this.pushSource(this.appendToBuffer(this.popStack()));else{var e=this.popStack();this.pushSource(["if (",e," != null) { ",this.appendToBuffer(e,void 0,!0)," }"]),this.environment.isSimple&&this.pushSource(["else { ",this.appendToBuffer("''",void 0,!0)," }"])}},appendEscaped:function(){this.pushSource(this.appendToBuffer([this.aliasable("this.escapeExpression"),"(",this.popStack(),")"]))},getContext:function(e){this.lastContext=e},pushContext:function(){this.pushStackLiteral(this.contextName(this.lastContext))},lookupOnContext:function(e,t,r){var n=0;r||!this.options.compat||this.lastContext?this.pushContext():this.push(this.depthedLookup(e[n++])),this.resolvePath("context",e,n,t)},lookupBlockParam:function(e,t){this.useBlockParams=!0,this.push(["blockParams[",e[0],"][",e[1],"]"]),this.resolvePath("context",t,1)},lookupData:function(e,t){this.pushStackLiteral(e?"this.data(data, "+e+")":"data"),this.resolvePath("data",t,0,!0)},resolvePath:function(e,t,r,n){var i=this;if(this.options.strict||this.options.assumeObjects)return void this.push(o(this.options.strict,this,t,e));
for(var s=t.length;s>r;r++)this.replaceStack(function(o){var s=i.nameLookup(o,t[r],e);return n?[" && ",s]:[" != null ? ",s," : ",o]})},resolvePossibleLambda:function(){this.push([this.aliasable("this.lambda"),"(",this.popStack(),", ",this.contextName(0),")"])},pushStringParam:function(e,t){this.pushContext(),this.pushString(t),"SubExpression"!==t&&("string"==typeof e?this.pushString(e):this.pushStackLiteral(e))},emptyHash:function(e){this.trackIds&&this.push("{}"),this.stringParams&&(this.push("{}"),this.push("{}")),this.pushStackLiteral(e?"undefined":"{}")},pushHash:function(){this.hash&&this.hashes.push(this.hash),this.hash={values:[],types:[],contexts:[],ids:[]}},popHash:function(){var e=this.hash;this.hash=this.hashes.pop(),this.trackIds&&this.push(this.objectLiteral(e.ids)),this.stringParams&&(this.push(this.objectLiteral(e.contexts)),this.push(this.objectLiteral(e.types))),this.push(this.objectLiteral(e.values))},pushString:function(e){this.pushStackLiteral(this.quotedString(e))},pushLiteral:function(e){this.pushStackLiteral(e)},pushProgram:function(e){this.pushStackLiteral(null!=e?this.programExpression(e):null)},invokeHelper:function(e,t,r){var n=this.popStack(),i=this.setupHelper(e,t),o=r?[i.name," || "]:"",s=["("].concat(o,n);this.options.strict||s.push(" || ",this.aliasable("helpers.helperMissing")),s.push(")"),this.push(this.source.functionCall(s,"call",i.callParams))},invokeKnownHelper:function(e,t){var r=this.setupHelper(e,t);this.push(this.source.functionCall(r.name,"call",r.callParams))},invokeAmbiguous:function(e,t){this.useRegister("helper");var r=this.popStack();this.emptyHash();var n=this.setupHelper(0,e,t),i=this.lastHelper=this.nameLookup("helpers",e,"helper"),o=["(","(helper = ",i," || ",r,")"];this.options.strict||(o[0]="(helper = ",o.push(" != null ? helper : ",this.aliasable("helpers.helperMissing"))),this.push(["(",o,n.paramsInit?["),(",n.paramsInit]:[],"),","(typeof helper === ",this.aliasable('"function"')," ? ",this.source.functionCall("helper","call",n.callParams)," : helper))"])},invokePartial:function(e,t,r){var n=[],i=this.setupParams(t,1,n,!1);e&&(t=this.popStack(),delete i.name),r&&(i.indent=JSON.stringify(r)),i.helpers="helpers",i.partials="partials",n.unshift(e?t:this.nameLookup("partials",t,"partial")),this.options.compat&&(i.depths="depths"),i=this.objectLiteral(i),n.push(i),this.push(this.source.functionCall("this.invokePartial","",n))},assignToHash:function(e){var t=this.popStack(),r=void 0,n=void 0,i=void 0;this.trackIds&&(i=this.popStack()),this.stringParams&&(n=this.popStack(),r=this.popStack());var o=this.hash;r&&(o.contexts[e]=r),n&&(o.types[e]=n),i&&(o.ids[e]=i),o.values[e]=t},pushId:function(e,t,r){"BlockParam"===e?this.pushStackLiteral("blockParams["+t[0]+"].path["+t[1]+"]"+(r?" + "+JSON.stringify("."+r):"")):"PathExpression"===e?this.pushString(t):this.pushStackLiteral("SubExpression"===e?"true":"null")},compiler:i,compileChildren:function(e,t){for(var r=e.children,n=void 0,i=void 0,o=0,s=r.length;s>o;o++){n=r[o],i=new this.compiler;var a=this.matchExistingProgram(n);null==a?(this.context.programs.push(""),a=this.context.programs.length,n.index=a,n.name="program"+a,this.context.programs[a]=i.compile(n,t,this.context,!this.precompile),this.context.environments[a]=n,this.useDepths=this.useDepths||i.useDepths,this.useBlockParams=this.useBlockParams||i.useBlockParams):(n.index=a,n.name="program"+a,this.useDepths=this.useDepths||n.useDepths,this.useBlockParams=this.useBlockParams||n.useBlockParams)}},matchExistingProgram:function(e){for(var t=0,r=this.context.environments.length;r>t;t++){var n=this.context.environments[t];if(n&&n.equals(e))return t}},programExpression:function(e){var t=this.environment.children[e],r=[t.index,"data",t.blockParams];return(this.useBlockParams||this.useDepths)&&r.push("blockParams"),this.useDepths&&r.push("depths"),"this.program("+r.join(", ")+")"},useRegister:function(e){this.registers[e]||(this.registers[e]=!0,this.registers.list.push(e))},push:function(e){return e instanceof n||(e=this.source.wrap(e)),this.inlineStack.push(e),e},pushStackLiteral:function(e){this.push(new n(e))},pushSource:function(e){this.pendingContent&&(this.source.push(this.appendToBuffer(this.source.quotedString(this.pendingContent),this.pendingLocation)),this.pendingContent=void 0),e&&this.source.push(e)},replaceStack:function(e){var t=["("],r=void 0,i=void 0,o=void 0;if(!this.isInline())throw new u["default"]("replaceStack on non-inline");var s=this.popStack(!0);if(s instanceof n)r=[s.value],t=["(",r],o=!0;else{i=!0;var a=this.incrStack();t=["((",this.push(a)," = ",s,")"],r=this.topStack()}var c=e.call(this,r);o||this.popStack(),i&&this.stackSlot--,this.push(t.concat(c,")"))},incrStack:function(){return this.stackSlot++,this.stackSlot>this.stackVars.length&&this.stackVars.push("stack"+this.stackSlot),this.topStackName()},topStackName:function(){return"stack"+this.stackSlot},flushInline:function(){var e=this.inlineStack;this.inlineStack=[];for(var t=0,r=e.length;r>t;t++){var i=e[t];if(i instanceof n)this.compileStack.push(i);else{var o=this.incrStack();this.pushSource([o," = ",i,";"]),this.compileStack.push(o)}}},isInline:function(){return this.inlineStack.length},popStack:function(e){var t=this.isInline(),r=(t?this.inlineStack:this.compileStack).pop();if(!e&&r instanceof n)return r.value;if(!t){if(!this.stackSlot)throw new u["default"]("Invalid stack pop");this.stackSlot--}return r},topStack:function(){var e=this.isInline()?this.inlineStack:this.compileStack,t=e[e.length-1];return t instanceof n?t.value:t},contextName:function(e){return this.useDepths&&e?"depths["+e+"]":"depth"+e},quotedString:function(e){return this.source.quotedString(e)},objectLiteral:function(e){return this.source.objectLiteral(e)},aliasable:function(e){var t=this.aliases[e];return t?(t.referenceCount++,t):(t=this.aliases[e]=this.source.wrap(e),t.aliasable=!0,t.referenceCount=1,t)},setupHelper:function(e,t,r){var n=[],i=this.setupHelperArgs(t,e,n,r),o=this.nameLookup("helpers",t,"helper");return{params:n,paramsInit:i,name:o,callParams:[this.contextName(0)].concat(n)}},setupParams:function(e,t,r){var n={},i=[],o=[],s=[],a=void 0;n.name=this.quotedString(e),n.hash=this.popStack(),this.trackIds&&(n.hashIds=this.popStack()),this.stringParams&&(n.hashTypes=this.popStack(),n.hashContexts=this.popStack());var c=this.popStack(),u=this.popStack();(u||c)&&(n.fn=u||"this.noop",n.inverse=c||"this.noop");for(var l=t;l--;)a=this.popStack(),r[l]=a,this.trackIds&&(s[l]=this.popStack()),this.stringParams&&(o[l]=this.popStack(),i[l]=this.popStack());return this.trackIds&&(n.ids=this.source.generateArray(s)),this.stringParams&&(n.types=this.source.generateArray(o),n.contexts=this.source.generateArray(i)),this.options.data&&(n.data="data"),this.useBlockParams&&(n.blockParams="blockParams"),n},setupHelperArgs:function(e,t,r,n){var i=this.setupParams(e,t,r,!0);return i=this.objectLiteral(i),n?(this.useRegister("options"),r.push("options"),["options=",i]):(r.push(i),"")}},function(){for(var e="break else new var case finally return void catch for switch while continue function this with default if throw delete in try do instanceof typeof abstract enum int short boolean export interface static byte extends long super char final native synchronized class float package throws const goto private transient debugger implements protected volatile double import public let yield await null true false".split(" "),t=i.RESERVED_WORDS={},r=0,n=e.length;n>r;r++)t[e[r]]=!0}(),i.isValidJavaScriptVariableName=function(e){return!i.RESERVED_WORDS[e]&&/^[a-zA-Z_$][0-9a-zA-Z_$]*$/.test(e)},t["default"]=i,e.exports=t["default"]},function(e,t,r){"use strict";function n(){this.parents=[]}var i=r(8)["default"];t.__esModule=!0;var o=r(11),s=i(o),a=r(2),c=i(a);n.prototype={constructor:n,mutating:!1,acceptKey:function(e,t){var r=this.accept(e[t]);if(this.mutating){if(r&&(!r.type||!c["default"][r.type]))throw new s["default"]('Unexpected node type "'+r.type+'" found when accepting '+t+" on "+e.type);e[t]=r}},acceptRequired:function(e,t){if(this.acceptKey(e,t),!e[t])throw new s["default"](e.type+" requires "+t)},acceptArray:function(e){for(var t=0,r=e.length;r>t;t++)this.acceptKey(e,t),e[t]||(e.splice(t,1),t--,r--)},accept:function(e){if(e){this.current&&this.parents.unshift(this.current),this.current=e;var t=this[e.type](e);return this.current=this.parents.shift(),!this.mutating||t?t:t!==!1?e:void 0}},Program:function(e){this.acceptArray(e.body)},MustacheStatement:function(e){this.acceptRequired(e,"path"),this.acceptArray(e.params),this.acceptKey(e,"hash")},BlockStatement:function(e){this.acceptRequired(e,"path"),this.acceptArray(e.params),this.acceptKey(e,"hash"),this.acceptKey(e,"program"),this.acceptKey(e,"inverse")},PartialStatement:function(e){this.acceptRequired(e,"name"),this.acceptArray(e.params),this.acceptKey(e,"hash")},ContentStatement:function(){},CommentStatement:function(){},SubExpression:function(e){this.acceptRequired(e,"path"),this.acceptArray(e.params),this.acceptKey(e,"hash")},PathExpression:function(){},StringLiteral:function(){},NumberLiteral:function(){},BooleanLiteral:function(){},UndefinedLiteral:function(){},NullLiteral:function(){},Hash:function(e){this.acceptArray(e.pairs)},HashPair:function(e){this.acceptRequired(e,"value")}},t["default"]=n,e.exports=t["default"]},function(e,t){(function(r){"use strict";t.__esModule=!0,t["default"]=function(e){var t="undefined"!=typeof r?r:window,n=t.Handlebars;e.noConflict=function(){t.Handlebars===e&&(t.Handlebars=n)}},e.exports=t["default"]}).call(t,function(){return this}())},function(e,t){"use strict";t["default"]=function(e){return e&&e.__esModule?e:{"default":e}},t.__esModule=!0},function(e,t,r){"use strict";function n(e,t){this.helpers=e||{},this.partials=t||{},i(this)}function i(e){e.registerHelper("helperMissing",function(){if(1!==arguments.length)throw new l["default"]('Missing helper: "'+arguments[arguments.length-1].name+'"')}),e.registerHelper("blockHelperMissing",function(t,r){var n=r.inverse,i=r.fn;if(t===!0)return i(this);if(t===!1||null==t)return n(this);if(d(t))return t.length>0?(r.ids&&(r.ids=[r.name]),e.helpers.each(t,r)):n(this);if(r.data&&r.ids){var s=o(r.data);s.contextPath=c.appendContextPath(r.data.contextPath,r.name),r={data:s}}return i(t,r)}),e.registerHelper("each",function(e,t){function r(t,r,i){u&&(u.key=t,u.index=r,u.first=0===r,u.last=!!i,p&&(u.contextPath=p+t)),a+=n(e[t],{data:u,blockParams:c.blockParams([e[t],t],[p+t,null])})}if(!t)throw new l["default"]("Must pass iterator to #each");var n=t.fn,i=t.inverse,s=0,a="",u=void 0,p=void 0;if(t.data&&t.ids&&(p=c.appendContextPath(t.data.contextPath,t.ids[0])+"."),g(e)&&(e=e.call(this)),t.data&&(u=o(t.data)),e&&"object"==typeof e)if(d(e))for(var h=e.length;h>s;s++)r(s,s,s===e.length-1);else{var f=void 0;for(var m in e)e.hasOwnProperty(m)&&(f&&r(f,s-1),f=m,s++);f&&r(f,s-1,!0)}return 0===s&&(a=i(this)),a}),e.registerHelper("if",function(e,t){return g(e)&&(e=e.call(this)),!t.hash.includeZero&&!e||c.isEmpty(e)?t.inverse(this):t.fn(this)}),e.registerHelper("unless",function(t,r){return e.helpers["if"].call(this,t,{fn:r.inverse,inverse:r.fn,hash:r.hash})}),e.registerHelper("with",function(e,t){g(e)&&(e=e.call(this));var r=t.fn;if(c.isEmpty(e))return t.inverse(this);if(t.data&&t.ids){var n=o(t.data);n.contextPath=c.appendContextPath(t.data.contextPath,t.ids[0]),t={data:n}}return r(e,t)}),e.registerHelper("log",function(t,r){var n=r.data&&null!=r.data.level?parseInt(r.data.level,10):1;e.log(n,t)}),e.registerHelper("lookup",function(e,t){return e&&e[t]})}function o(e){var t=c.extend({},e);return t._parent=e,t}var s=r(8)["default"];t.__esModule=!0,t.HandlebarsEnvironment=n,t.createFrame=o;var a=r(12),c=s(a),u=r(11),l=s(u),p="3.0.1";t.VERSION=p;var h=6;t.COMPILER_REVISION=h;var f={1:"<= 1.0.rc.2",2:"== 1.0.0-rc.3",3:"== 1.0.0-rc.4",4:"== 1.x.x",5:"== 2.0.0-alpha.x",6:">= 2.0.0-beta.1"};t.REVISION_CHANGES=f;var d=c.isArray,g=c.isFunction,m=c.toString,v="[object Object]";n.prototype={constructor:n,logger:y,log:b,registerHelper:function(e,t){if(m.call(e)===v){if(t)throw new l["default"]("Arg not supported with multiple helpers");c.extend(this.helpers,e)}else this.helpers[e]=t},unregisterHelper:function(e){delete this.helpers[e]},registerPartial:function(e,t){if(m.call(e)===v)c.extend(this.partials,e);else{if("undefined"==typeof t)throw new l["default"]("Attempting to register a partial as undefined");this.partials[e]=t}},unregisterPartial:function(e){delete this.partials[e]}};var y={methodMap:{0:"debug",1:"info",2:"warn",3:"error"},DEBUG:0,INFO:1,WARN:2,ERROR:3,level:1,log:function(e,t){if("undefined"!=typeof console&&y.level<=e){var r=y.methodMap[e];(console[r]||console.log).call(console,t)}}};t.logger=y;var b=y.log;t.log=b},function(e,t){"use strict";function r(e){this.string=e}t.__esModule=!0,r.prototype.toString=r.prototype.toHTML=function(){return""+this.string},t["default"]=r,e.exports=t["default"]},function(e,t){"use strict";function r(e,t){var i=t&&t.loc,o=void 0,s=void 0;i&&(o=i.start.line,s=i.start.column,e+=" - "+o+":"+s);for(var a=Error.prototype.constructor.call(this,e),c=0;c<n.length;c++)this[n[c]]=a[n[c]];Error.captureStackTrace&&Error.captureStackTrace(this,r),i&&(this.lineNumber=o,this.column=s)}t.__esModule=!0;var n=["description","fileName","lineNumber","message","name","number","stack"];r.prototype=new Error,t["default"]=r,e.exports=t["default"]},function(e,t){"use strict";function r(e){return u[e]}function n(e){for(var t=1;t<arguments.length;t++)for(var r in arguments[t])Object.prototype.hasOwnProperty.call(arguments[t],r)&&(e[r]=arguments[t][r]);return e}function i(e,t){for(var r=0,n=e.length;n>r;r++)if(e[r]===t)return r;return-1}function o(e){if("string"!=typeof e){if(e&&e.toHTML)return e.toHTML();if(null==e)return"";if(!e)return e+"";e=""+e}return p.test(e)?e.replace(l,r):e}function s(e){return e||0===e?d(e)&&0===e.length?!0:!1:!0}function a(e,t){return e.path=t,e}function c(e,t){return(e?e+".":"")+t}t.__esModule=!0,t.extend=n,t.indexOf=i,t.escapeExpression=o,t.isEmpty=s,t.blockParams=a,t.appendContextPath=c;var u={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#x27;","`":"&#x60;"},l=/[&<>"'`]/g,p=/[&<>"'`]/,h=Object.prototype.toString;t.toString=h;var f=function(e){return"function"==typeof e};f(/x/)&&(t.isFunction=f=function(e){return"function"==typeof e&&"[object Function]"===h.call(e)});var f;t.isFunction=f;var d=Array.isArray||function(e){return e&&"object"==typeof e?"[object Array]"===h.call(e):!1};t.isArray=d},function(e,t,r){"use strict";function n(e){var t=e&&e[0]||1,r=g.COMPILER_REVISION;if(t!==r){if(r>t){var n=g.REVISION_CHANGES[r],i=g.REVISION_CHANGES[t];throw new d["default"]("Template was precompiled with an older version of Handlebars than the current runtime. Please update your precompiler to a newer version ("+n+") or downgrade your runtime to an older version ("+i+").")}throw new d["default"]("Template was precompiled with a newer version of Handlebars than the current runtime. Please update your runtime to a newer version ("+e[1]+").")}}function i(e,t){function r(r,n,i){i.hash&&(n=h.extend({},n,i.hash)),r=t.VM.resolvePartial.call(this,r,n,i);var o=t.VM.invokePartial.call(this,r,n,i);if(null==o&&t.compile&&(i.partials[i.name]=t.compile(r,e.compilerOptions,t),o=i.partials[i.name](n,i)),null!=o){if(i.indent){for(var s=o.split("\n"),a=0,c=s.length;c>a&&(s[a]||a+1!==c);a++)s[a]=i.indent+s[a];o=s.join("\n")}return o}throw new d["default"]("The partial "+i.name+" could not be compiled when running in runtime-only mode")}function n(t){var r=void 0===arguments[1]?{}:arguments[1],o=r.data;n._setup(r),!r.partial&&e.useData&&(o=u(t,o));var s=void 0,a=e.useBlockParams?[]:void 0;return e.useDepths&&(s=r.depths?[t].concat(r.depths):[t]),e.main.call(i,t,i.helpers,i.partials,o,a,s)}if(!t)throw new d["default"]("No environment passed to template");if(!e||!e.main)throw new d["default"]("Unknown template object: "+typeof e);t.VM.checkRevision(e.compiler);var i={strict:function(e,t){if(!(t in e))throw new d["default"]('"'+t+'" not defined in '+e);return e[t]},lookup:function(e,t){for(var r=e.length,n=0;r>n;n++)if(e[n]&&null!=e[n][t])return e[n][t]},lambda:function(e,t){return"function"==typeof e?e.call(t):e},escapeExpression:h.escapeExpression,invokePartial:r,fn:function(t){return e[t]},programs:[],program:function(e,t,r,n,i){var s=this.programs[e],a=this.fn(e);return t||i||n||r?s=o(this,e,a,t,r,n,i):s||(s=this.programs[e]=o(this,e,a)),s},data:function(e,t){for(;e&&t--;)e=e._parent;return e},merge:function(e,t){var r=e||t;return e&&t&&e!==t&&(r=h.extend({},t,e)),r},noop:t.VM.noop,compilerInfo:e.compiler};return n.isTop=!0,n._setup=function(r){r.partial?(i.helpers=r.helpers,i.partials=r.partials):(i.helpers=i.merge(r.helpers,t.helpers),e.usePartial&&(i.partials=i.merge(r.partials,t.partials)))},n._child=function(t,r,n,s){if(e.useBlockParams&&!n)throw new d["default"]("must pass block params");if(e.useDepths&&!s)throw new d["default"]("must pass parent depths");return o(i,t,e[t],r,0,n,s)},n}function o(e,t,r,n,i,o,s){function a(t){var i=void 0===arguments[1]?{}:arguments[1];return r.call(e,t,e.helpers,e.partials,i.data||n,o&&[i.blockParams].concat(o),s&&[t].concat(s))}return a.program=t,a.depth=s?s.length:0,a.blockParams=i||0,a}function s(e,t,r){return e?e.call||r.name||(r.name=e,e=r.partials[e]):e=r.partials[r.name],e}function a(e,t,r){if(r.partial=!0,void 0===e)throw new d["default"]("The partial "+r.name+" could not be found");return e instanceof Function?e(t,r):void 0}function c(){return""}function u(e,t){return t&&"root"in t||(t=t?g.createFrame(t):{},t.root=e),t}var l=r(8)["default"];t.__esModule=!0,t.checkRevision=n,t.template=i,t.wrapProgram=o,t.resolvePartial=s,t.invokePartial=a,t.noop=c;var p=r(12),h=l(p),f=r(11),d=l(f),g=r(9)},function(e,t){"use strict";t.__esModule=!0;var r=function(){function e(){this.yy={}}var t={trace:function(){},yy:{},symbols_:{error:2,root:3,program:4,EOF:5,program_repetition0:6,statement:7,mustache:8,block:9,rawBlock:10,partial:11,content:12,COMMENT:13,CONTENT:14,openRawBlock:15,END_RAW_BLOCK:16,OPEN_RAW_BLOCK:17,helperName:18,openRawBlock_repetition0:19,openRawBlock_option0:20,CLOSE_RAW_BLOCK:21,openBlock:22,block_option0:23,closeBlock:24,openInverse:25,block_option1:26,OPEN_BLOCK:27,openBlock_repetition0:28,openBlock_option0:29,openBlock_option1:30,CLOSE:31,OPEN_INVERSE:32,openInverse_repetition0:33,openInverse_option0:34,openInverse_option1:35,openInverseChain:36,OPEN_INVERSE_CHAIN:37,openInverseChain_repetition0:38,openInverseChain_option0:39,openInverseChain_option1:40,inverseAndProgram:41,INVERSE:42,inverseChain:43,inverseChain_option0:44,OPEN_ENDBLOCK:45,OPEN:46,mustache_repetition0:47,mustache_option0:48,OPEN_UNESCAPED:49,mustache_repetition1:50,mustache_option1:51,CLOSE_UNESCAPED:52,OPEN_PARTIAL:53,partialName:54,partial_repetition0:55,partial_option0:56,param:57,sexpr:58,OPEN_SEXPR:59,sexpr_repetition0:60,sexpr_option0:61,CLOSE_SEXPR:62,hash:63,hash_repetition_plus0:64,hashSegment:65,ID:66,EQUALS:67,blockParams:68,OPEN_BLOCK_PARAMS:69,blockParams_repetition_plus0:70,CLOSE_BLOCK_PARAMS:71,path:72,dataName:73,STRING:74,NUMBER:75,BOOLEAN:76,UNDEFINED:77,NULL:78,DATA:79,pathSegments:80,SEP:81,$accept:0,$end:1},terminals_:{2:"error",5:"EOF",13:"COMMENT",14:"CONTENT",16:"END_RAW_BLOCK",17:"OPEN_RAW_BLOCK",21:"CLOSE_RAW_BLOCK",27:"OPEN_BLOCK",31:"CLOSE",32:"OPEN_INVERSE",37:"OPEN_INVERSE_CHAIN",42:"INVERSE",45:"OPEN_ENDBLOCK",46:"OPEN",49:"OPEN_UNESCAPED",52:"CLOSE_UNESCAPED",53:"OPEN_PARTIAL",59:"OPEN_SEXPR",62:"CLOSE_SEXPR",66:"ID",67:"EQUALS",69:"OPEN_BLOCK_PARAMS",71:"CLOSE_BLOCK_PARAMS",74:"STRING",75:"NUMBER",76:"BOOLEAN",77:"UNDEFINED",78:"NULL",79:"DATA",81:"SEP"},productions_:[0,[3,2],[4,1],[7,1],[7,1],[7,1],[7,1],[7,1],[7,1],[12,1],[10,3],[15,5],[9,4],[9,4],[22,6],[25,6],[36,6],[41,2],[43,3],[43,1],[24,3],[8,5],[8,5],[11,5],[57,1],[57,1],[58,5],[63,1],[65,3],[68,3],[18,1],[18,1],[18,1],[18,1],[18,1],[18,1],[18,1],[54,1],[54,1],[73,2],[72,1],[80,3],[80,1],[6,0],[6,2],[19,0],[19,2],[20,0],[20,1],[23,0],[23,1],[26,0],[26,1],[28,0],[28,2],[29,0],[29,1],[30,0],[30,1],[33,0],[33,2],[34,0],[34,1],[35,0],[35,1],[38,0],[38,2],[39,0],[39,1],[40,0],[40,1],[44,0],[44,1],[47,0],[47,2],[48,0],[48,1],[50,0],[50,2],[51,0],[51,1],[55,0],[55,2],[56,0],[56,1],[60,0],[60,2],[61,0],[61,1],[64,1],[64,2],[70,1],[70,2]],performAction:function(e,t,r,n,i,o){var s=o.length-1;switch(i){case 1:return o[s-1];case 2:this.$=new n.Program(o[s],null,{},n.locInfo(this._$));break;case 3:this.$=o[s];break;case 4:this.$=o[s];break;case 5:this.$=o[s];break;case 6:this.$=o[s];break;case 7:this.$=o[s];break;case 8:this.$=new n.CommentStatement(n.stripComment(o[s]),n.stripFlags(o[s],o[s]),n.locInfo(this._$));break;case 9:this.$=new n.ContentStatement(o[s],n.locInfo(this._$));break;case 10:this.$=n.prepareRawBlock(o[s-2],o[s-1],o[s],this._$);break;case 11:this.$={path:o[s-3],params:o[s-2],hash:o[s-1]};break;case 12:this.$=n.prepareBlock(o[s-3],o[s-2],o[s-1],o[s],!1,this._$);break;case 13:this.$=n.prepareBlock(o[s-3],o[s-2],o[s-1],o[s],!0,this._$);break;case 14:this.$={path:o[s-4],params:o[s-3],hash:o[s-2],blockParams:o[s-1],strip:n.stripFlags(o[s-5],o[s])};break;case 15:this.$={path:o[s-4],params:o[s-3],hash:o[s-2],blockParams:o[s-1],strip:n.stripFlags(o[s-5],o[s])};break;case 16:this.$={path:o[s-4],params:o[s-3],hash:o[s-2],blockParams:o[s-1],strip:n.stripFlags(o[s-5],o[s])};break;case 17:this.$={strip:n.stripFlags(o[s-1],o[s-1]),program:o[s]};break;case 18:var a=n.prepareBlock(o[s-2],o[s-1],o[s],o[s],!1,this._$),c=new n.Program([a],null,{},n.locInfo(this._$));c.chained=!0,this.$={strip:o[s-2].strip,program:c,chain:!0};break;case 19:this.$=o[s];break;case 20:this.$={path:o[s-1],strip:n.stripFlags(o[s-2],o[s])};break;case 21:this.$=n.prepareMustache(o[s-3],o[s-2],o[s-1],o[s-4],n.stripFlags(o[s-4],o[s]),this._$);break;case 22:this.$=n.prepareMustache(o[s-3],o[s-2],o[s-1],o[s-4],n.stripFlags(o[s-4],o[s]),this._$);break;case 23:this.$=new n.PartialStatement(o[s-3],o[s-2],o[s-1],n.stripFlags(o[s-4],o[s]),n.locInfo(this._$));break;case 24:this.$=o[s];break;case 25:this.$=o[s];break;case 26:this.$=new n.SubExpression(o[s-3],o[s-2],o[s-1],n.locInfo(this._$));break;case 27:this.$=new n.Hash(o[s],n.locInfo(this._$));break;case 28:this.$=new n.HashPair(n.id(o[s-2]),o[s],n.locInfo(this._$));break;case 29:this.$=n.id(o[s-1]);break;case 30:this.$=o[s];break;case 31:this.$=o[s];break;case 32:this.$=new n.StringLiteral(o[s],n.locInfo(this._$));break;case 33:this.$=new n.NumberLiteral(o[s],n.locInfo(this._$));break;case 34:this.$=new n.BooleanLiteral(o[s],n.locInfo(this._$));break;case 35:this.$=new n.UndefinedLiteral(n.locInfo(this._$));break;case 36:this.$=new n.NullLiteral(n.locInfo(this._$));break;case 37:this.$=o[s];break;case 38:this.$=o[s];break;case 39:this.$=n.preparePath(!0,o[s],this._$);break;case 40:this.$=n.preparePath(!1,o[s],this._$);break;case 41:o[s-2].push({part:n.id(o[s]),original:o[s],separator:o[s-1]}),this.$=o[s-2];break;case 42:this.$=[{part:n.id(o[s]),original:o[s]}];break;case 43:this.$=[];break;case 44:o[s-1].push(o[s]);break;case 45:this.$=[];break;case 46:o[s-1].push(o[s]);break;case 53:this.$=[];break;case 54:o[s-1].push(o[s]);break;case 59:this.$=[];break;case 60:o[s-1].push(o[s]);break;case 65:this.$=[];break;case 66:o[s-1].push(o[s]);break;case 73:this.$=[];break;case 74:o[s-1].push(o[s]);break;case 77:this.$=[];break;case 78:o[s-1].push(o[s]);break;case 81:this.$=[];break;case 82:o[s-1].push(o[s]);break;case 85:this.$=[];break;case 86:o[s-1].push(o[s]);break;case 89:this.$=[o[s]];break;case 90:o[s-1].push(o[s]);break;case 91:this.$=[o[s]];break;case 92:o[s-1].push(o[s])}},table:[{3:1,4:2,5:[2,43],6:3,13:[2,43],14:[2,43],17:[2,43],27:[2,43],32:[2,43],46:[2,43],49:[2,43],53:[2,43]},{1:[3]},{5:[1,4]},{5:[2,2],7:5,8:6,9:7,10:8,11:9,12:10,13:[1,11],14:[1,18],15:16,17:[1,21],22:14,25:15,27:[1,19],32:[1,20],37:[2,2],42:[2,2],45:[2,2],46:[1,12],49:[1,13],53:[1,17]},{1:[2,1]},{5:[2,44],13:[2,44],14:[2,44],17:[2,44],27:[2,44],32:[2,44],37:[2,44],42:[2,44],45:[2,44],46:[2,44],49:[2,44],53:[2,44]},{5:[2,3],13:[2,3],14:[2,3],17:[2,3],27:[2,3],32:[2,3],37:[2,3],42:[2,3],45:[2,3],46:[2,3],49:[2,3],53:[2,3]},{5:[2,4],13:[2,4],14:[2,4],17:[2,4],27:[2,4],32:[2,4],37:[2,4],42:[2,4],45:[2,4],46:[2,4],49:[2,4],53:[2,4]},{5:[2,5],13:[2,5],14:[2,5],17:[2,5],27:[2,5],32:[2,5],37:[2,5],42:[2,5],45:[2,5],46:[2,5],49:[2,5],53:[2,5]},{5:[2,6],13:[2,6],14:[2,6],17:[2,6],27:[2,6],32:[2,6],37:[2,6],42:[2,6],45:[2,6],46:[2,6],49:[2,6],53:[2,6]},{5:[2,7],13:[2,7],14:[2,7],17:[2,7],27:[2,7],32:[2,7],37:[2,7],42:[2,7],45:[2,7],46:[2,7],49:[2,7],53:[2,7]},{5:[2,8],13:[2,8],14:[2,8],17:[2,8],27:[2,8],32:[2,8],37:[2,8],42:[2,8],45:[2,8],46:[2,8],49:[2,8],53:[2,8]},{18:22,66:[1,32],72:23,73:24,74:[1,25],75:[1,26],76:[1,27],77:[1,28],78:[1,29],79:[1,31],80:30},{18:33,66:[1,32],72:23,73:24,74:[1,25],75:[1,26],76:[1,27],77:[1,28],78:[1,29],79:[1,31],80:30},{4:34,6:3,13:[2,43],14:[2,43],17:[2,43],27:[2,43],32:[2,43],37:[2,43],42:[2,43],45:[2,43],46:[2,43],49:[2,43],53:[2,43]},{4:35,6:3,13:[2,43],14:[2,43],17:[2,43],27:[2,43],32:[2,43],42:[2,43],45:[2,43],46:[2,43],49:[2,43],53:[2,43]},{12:36,14:[1,18]},{18:38,54:37,58:39,59:[1,40],66:[1,32],72:23,73:24,74:[1,25],75:[1,26],76:[1,27],77:[1,28],78:[1,29],79:[1,31],80:30},{5:[2,9],13:[2,9],14:[2,9],16:[2,9],17:[2,9],27:[2,9],32:[2,9],37:[2,9],42:[2,9],45:[2,9],46:[2,9],49:[2,9],53:[2,9]},{18:41,66:[1,32],72:23,73:24,74:[1,25],75:[1,26],76:[1,27],77:[1,28],78:[1,29],79:[1,31],80:30},{18:42,66:[1,32],72:23,73:24,74:[1,25],75:[1,26],76:[1,27],77:[1,28],78:[1,29],79:[1,31],80:30},{18:43,66:[1,32],72:23,73:24,74:[1,25],75:[1,26],76:[1,27],77:[1,28],78:[1,29],79:[1,31],80:30},{31:[2,73],47:44,59:[2,73],66:[2,73],74:[2,73],75:[2,73],76:[2,73],77:[2,73],78:[2,73],79:[2,73]},{21:[2,30],31:[2,30],52:[2,30],59:[2,30],62:[2,30],66:[2,30],69:[2,30],74:[2,30],75:[2,30],76:[2,30],77:[2,30],78:[2,30],79:[2,30]},{21:[2,31],31:[2,31],52:[2,31],59:[2,31],62:[2,31],66:[2,31],69:[2,31],74:[2,31],75:[2,31],76:[2,31],77:[2,31],78:[2,31],79:[2,31]},{21:[2,32],31:[2,32],52:[2,32],59:[2,32],62:[2,32],66:[2,32],69:[2,32],74:[2,32],75:[2,32],76:[2,32],77:[2,32],78:[2,32],79:[2,32]},{21:[2,33],31:[2,33],52:[2,33],59:[2,33],62:[2,33],66:[2,33],69:[2,33],74:[2,33],75:[2,33],76:[2,33],77:[2,33],78:[2,33],79:[2,33]},{21:[2,34],31:[2,34],52:[2,34],59:[2,34],62:[2,34],66:[2,34],69:[2,34],74:[2,34],75:[2,34],76:[2,34],77:[2,34],78:[2,34],79:[2,34]},{21:[2,35],31:[2,35],52:[2,35],59:[2,35],62:[2,35],66:[2,35],69:[2,35],74:[2,35],75:[2,35],76:[2,35],77:[2,35],78:[2,35],79:[2,35]},{21:[2,36],31:[2,36],52:[2,36],59:[2,36],62:[2,36],66:[2,36],69:[2,36],74:[2,36],75:[2,36],76:[2,36],77:[2,36],78:[2,36],79:[2,36]},{21:[2,40],31:[2,40],52:[2,40],59:[2,40],62:[2,40],66:[2,40],69:[2,40],74:[2,40],75:[2,40],76:[2,40],77:[2,40],78:[2,40],79:[2,40],81:[1,45]},{66:[1,32],80:46},{21:[2,42],31:[2,42],52:[2,42],59:[2,42],62:[2,42],66:[2,42],69:[2,42],74:[2,42],75:[2,42],76:[2,42],77:[2,42],78:[2,42],79:[2,42],81:[2,42]},{50:47,52:[2,77],59:[2,77],66:[2,77],74:[2,77],75:[2,77],76:[2,77],77:[2,77],78:[2,77],79:[2,77]},{23:48,36:50,37:[1,52],41:51,42:[1,53],43:49,45:[2,49]},{26:54,41:55,42:[1,53],45:[2,51]},{16:[1,56]},{31:[2,81],55:57,59:[2,81],66:[2,81],74:[2,81],75:[2,81],76:[2,81],77:[2,81],78:[2,81],79:[2,81]},{31:[2,37],59:[2,37],66:[2,37],74:[2,37],75:[2,37],76:[2,37],77:[2,37],78:[2,37],79:[2,37]},{31:[2,38],59:[2,38],66:[2,38],74:[2,38],75:[2,38],76:[2,38],77:[2,38],78:[2,38],79:[2,38]},{18:58,66:[1,32],72:23,73:24,74:[1,25],75:[1,26],76:[1,27],77:[1,28],78:[1,29],79:[1,31],80:30},{28:59,31:[2,53],59:[2,53],66:[2,53],69:[2,53],74:[2,53],75:[2,53],76:[2,53],77:[2,53],78:[2,53],79:[2,53]},{31:[2,59],33:60,59:[2,59],66:[2,59],69:[2,59],74:[2,59],75:[2,59],76:[2,59],77:[2,59],78:[2,59],79:[2,59]},{19:61,21:[2,45],59:[2,45],66:[2,45],74:[2,45],75:[2,45],76:[2,45],77:[2,45],78:[2,45],79:[2,45]},{18:65,31:[2,75],48:62,57:63,58:66,59:[1,40],63:64,64:67,65:68,66:[1,69],72:23,73:24,74:[1,25],75:[1,26],76:[1,27],77:[1,28],78:[1,29],79:[1,31],80:30},{66:[1,70]},{21:[2,39],31:[2,39],52:[2,39],59:[2,39],62:[2,39],66:[2,39],69:[2,39],74:[2,39],75:[2,39],76:[2,39],77:[2,39],78:[2,39],79:[2,39],81:[1,45]},{18:65,51:71,52:[2,79],57:72,58:66,59:[1,40],63:73,64:67,65:68,66:[1,69],72:23,73:24,74:[1,25],75:[1,26],76:[1,27],77:[1,28],78:[1,29],79:[1,31],80:30},{24:74,45:[1,75]},{45:[2,50]},{4:76,6:3,13:[2,43],14:[2,43],17:[2,43],27:[2,43],32:[2,43],37:[2,43],42:[2,43],45:[2,43],46:[2,43],49:[2,43],53:[2,43]},{45:[2,19]},{18:77,66:[1,32],72:23,73:24,74:[1,25],75:[1,26],76:[1,27],77:[1,28],78:[1,29],79:[1,31],80:30},{4:78,6:3,13:[2,43],14:[2,43],17:[2,43],27:[2,43],32:[2,43],45:[2,43],46:[2,43],49:[2,43],53:[2,43]},{24:79,45:[1,75]},{45:[2,52]},{5:[2,10],13:[2,10],14:[2,10],17:[2,10],27:[2,10],32:[2,10],37:[2,10],42:[2,10],45:[2,10],46:[2,10],49:[2,10],53:[2,10]},{18:65,31:[2,83],56:80,57:81,58:66,59:[1,40],63:82,64:67,65:68,66:[1,69],72:23,73:24,74:[1,25],75:[1,26],76:[1,27],77:[1,28],78:[1,29],79:[1,31],80:30},{59:[2,85],60:83,62:[2,85],66:[2,85],74:[2,85],75:[2,85],76:[2,85],77:[2,85],78:[2,85],79:[2,85]},{18:65,29:84,31:[2,55],57:85,58:66,59:[1,40],63:86,64:67,65:68,66:[1,69],69:[2,55],72:23,73:24,74:[1,25],75:[1,26],76:[1,27],77:[1,28],78:[1,29],79:[1,31],80:30},{18:65,31:[2,61],34:87,57:88,58:66,59:[1,40],63:89,64:67,65:68,66:[1,69],69:[2,61],72:23,73:24,74:[1,25],75:[1,26],76:[1,27],77:[1,28],78:[1,29],79:[1,31],80:30},{18:65,20:90,21:[2,47],57:91,58:66,59:[1,40],63:92,64:67,65:68,66:[1,69],72:23,73:24,74:[1,25],75:[1,26],76:[1,27],77:[1,28],78:[1,29],79:[1,31],80:30},{31:[1,93]},{31:[2,74],59:[2,74],66:[2,74],74:[2,74],75:[2,74],76:[2,74],77:[2,74],78:[2,74],79:[2,74]},{31:[2,76]},{21:[2,24],31:[2,24],52:[2,24],59:[2,24],62:[2,24],66:[2,24],69:[2,24],74:[2,24],75:[2,24],76:[2,24],77:[2,24],78:[2,24],79:[2,24]},{21:[2,25],31:[2,25],52:[2,25],59:[2,25],62:[2,25],66:[2,25],69:[2,25],74:[2,25],75:[2,25],76:[2,25],77:[2,25],78:[2,25],79:[2,25]},{21:[2,27],31:[2,27],52:[2,27],62:[2,27],65:94,66:[1,95],69:[2,27]},{21:[2,89],31:[2,89],52:[2,89],62:[2,89],66:[2,89],69:[2,89]},{21:[2,42],31:[2,42],52:[2,42],59:[2,42],62:[2,42],66:[2,42],67:[1,96],69:[2,42],74:[2,42],75:[2,42],76:[2,42],77:[2,42],78:[2,42],79:[2,42],81:[2,42]},{21:[2,41],31:[2,41],52:[2,41],59:[2,41],62:[2,41],66:[2,41],69:[2,41],74:[2,41],75:[2,41],76:[2,41],77:[2,41],78:[2,41],79:[2,41],81:[2,41]},{52:[1,97]},{52:[2,78],59:[2,78],66:[2,78],74:[2,78],75:[2,78],76:[2,78],77:[2,78],78:[2,78],79:[2,78]},{52:[2,80]},{5:[2,12],13:[2,12],14:[2,12],17:[2,12],27:[2,12],32:[2,12],37:[2,12],42:[2,12],45:[2,12],46:[2,12],49:[2,12],53:[2,12]},{18:98,66:[1,32],72:23,73:24,74:[1,25],75:[1,26],76:[1,27],77:[1,28],78:[1,29],79:[1,31],80:30},{36:50,37:[1,52],41:51,42:[1,53],43:100,44:99,45:[2,71]},{31:[2,65],38:101,59:[2,65],66:[2,65],69:[2,65],74:[2,65],75:[2,65],76:[2,65],77:[2,65],78:[2,65],79:[2,65]},{45:[2,17]},{5:[2,13],13:[2,13],14:[2,13],17:[2,13],27:[2,13],32:[2,13],37:[2,13],42:[2,13],45:[2,13],46:[2,13],49:[2,13],53:[2,13]},{31:[1,102]},{31:[2,82],59:[2,82],66:[2,82],74:[2,82],75:[2,82],76:[2,82],77:[2,82],78:[2,82],79:[2,82]},{31:[2,84]},{18:65,57:104,58:66,59:[1,40],61:103,62:[2,87],63:105,64:67,65:68,66:[1,69],72:23,73:24,74:[1,25],75:[1,26],76:[1,27],77:[1,28],78:[1,29],79:[1,31],80:30},{30:106,31:[2,57],68:107,69:[1,108]},{31:[2,54],59:[2,54],66:[2,54],69:[2,54],74:[2,54],75:[2,54],76:[2,54],77:[2,54],78:[2,54],79:[2,54]},{31:[2,56],69:[2,56]},{31:[2,63],35:109,68:110,69:[1,108]},{31:[2,60],59:[2,60],66:[2,60],69:[2,60],74:[2,60],75:[2,60],76:[2,60],77:[2,60],78:[2,60],79:[2,60]},{31:[2,62],69:[2,62]},{21:[1,111]},{21:[2,46],59:[2,46],66:[2,46],74:[2,46],75:[2,46],76:[2,46],77:[2,46],78:[2,46],79:[2,46]},{21:[2,48]},{5:[2,21],13:[2,21],14:[2,21],17:[2,21],27:[2,21],32:[2,21],37:[2,21],42:[2,21],45:[2,21],46:[2,21],49:[2,21],53:[2,21]},{21:[2,90],31:[2,90],52:[2,90],62:[2,90],66:[2,90],69:[2,90]},{67:[1,96]},{18:65,57:112,58:66,59:[1,40],66:[1,32],
72:23,73:24,74:[1,25],75:[1,26],76:[1,27],77:[1,28],78:[1,29],79:[1,31],80:30},{5:[2,22],13:[2,22],14:[2,22],17:[2,22],27:[2,22],32:[2,22],37:[2,22],42:[2,22],45:[2,22],46:[2,22],49:[2,22],53:[2,22]},{31:[1,113]},{45:[2,18]},{45:[2,72]},{18:65,31:[2,67],39:114,57:115,58:66,59:[1,40],63:116,64:67,65:68,66:[1,69],69:[2,67],72:23,73:24,74:[1,25],75:[1,26],76:[1,27],77:[1,28],78:[1,29],79:[1,31],80:30},{5:[2,23],13:[2,23],14:[2,23],17:[2,23],27:[2,23],32:[2,23],37:[2,23],42:[2,23],45:[2,23],46:[2,23],49:[2,23],53:[2,23]},{62:[1,117]},{59:[2,86],62:[2,86],66:[2,86],74:[2,86],75:[2,86],76:[2,86],77:[2,86],78:[2,86],79:[2,86]},{62:[2,88]},{31:[1,118]},{31:[2,58]},{66:[1,120],70:119},{31:[1,121]},{31:[2,64]},{14:[2,11]},{21:[2,28],31:[2,28],52:[2,28],62:[2,28],66:[2,28],69:[2,28]},{5:[2,20],13:[2,20],14:[2,20],17:[2,20],27:[2,20],32:[2,20],37:[2,20],42:[2,20],45:[2,20],46:[2,20],49:[2,20],53:[2,20]},{31:[2,69],40:122,68:123,69:[1,108]},{31:[2,66],59:[2,66],66:[2,66],69:[2,66],74:[2,66],75:[2,66],76:[2,66],77:[2,66],78:[2,66],79:[2,66]},{31:[2,68],69:[2,68]},{21:[2,26],31:[2,26],52:[2,26],59:[2,26],62:[2,26],66:[2,26],69:[2,26],74:[2,26],75:[2,26],76:[2,26],77:[2,26],78:[2,26],79:[2,26]},{13:[2,14],14:[2,14],17:[2,14],27:[2,14],32:[2,14],37:[2,14],42:[2,14],45:[2,14],46:[2,14],49:[2,14],53:[2,14]},{66:[1,125],71:[1,124]},{66:[2,91],71:[2,91]},{13:[2,15],14:[2,15],17:[2,15],27:[2,15],32:[2,15],42:[2,15],45:[2,15],46:[2,15],49:[2,15],53:[2,15]},{31:[1,126]},{31:[2,70]},{31:[2,29]},{66:[2,92],71:[2,92]},{13:[2,16],14:[2,16],17:[2,16],27:[2,16],32:[2,16],37:[2,16],42:[2,16],45:[2,16],46:[2,16],49:[2,16],53:[2,16]}],defaultActions:{4:[2,1],49:[2,50],51:[2,19],55:[2,52],64:[2,76],73:[2,80],78:[2,17],82:[2,84],92:[2,48],99:[2,18],100:[2,72],105:[2,88],107:[2,58],110:[2,64],111:[2,11],123:[2,70],124:[2,29]},parseError:function(e){throw new Error(e)},parse:function(e){function t(){var e;return e=r.lexer.lex()||1,"number"!=typeof e&&(e=r.symbols_[e]||e),e}var r=this,n=[0],i=[null],o=[],s=this.table,a="",c=0,u=0,l=0;this.lexer.setInput(e),this.lexer.yy=this.yy,this.yy.lexer=this.lexer,this.yy.parser=this,"undefined"==typeof this.lexer.yylloc&&(this.lexer.yylloc={});var p=this.lexer.yylloc;o.push(p);var h=this.lexer.options&&this.lexer.options.ranges;"function"==typeof this.yy.parseError&&(this.parseError=this.yy.parseError);for(var f,d,g,m,v,y,b,w,E,x={};;){if(g=n[n.length-1],this.defaultActions[g]?m=this.defaultActions[g]:((null===f||"undefined"==typeof f)&&(f=t()),m=s[g]&&s[g][f]),"undefined"==typeof m||!m.length||!m[0]){var _="";if(!l){E=[];for(y in s[g])this.terminals_[y]&&y>2&&E.push("'"+this.terminals_[y]+"'");_=this.lexer.showPosition?"Parse error on line "+(c+1)+":\n"+this.lexer.showPosition()+"\nExpecting "+E.join(", ")+", got '"+(this.terminals_[f]||f)+"'":"Parse error on line "+(c+1)+": Unexpected "+(1==f?"end of input":"'"+(this.terminals_[f]||f)+"'"),this.parseError(_,{text:this.lexer.match,token:this.terminals_[f]||f,line:this.lexer.yylineno,loc:p,expected:E})}}if(m[0]instanceof Array&&m.length>1)throw new Error("Parse Error: multiple actions possible at state: "+g+", token: "+f);switch(m[0]){case 1:n.push(f),i.push(this.lexer.yytext),o.push(this.lexer.yylloc),n.push(m[1]),f=null,d?(f=d,d=null):(u=this.lexer.yyleng,a=this.lexer.yytext,c=this.lexer.yylineno,p=this.lexer.yylloc,l>0&&l--);break;case 2:if(b=this.productions_[m[1]][1],x.$=i[i.length-b],x._$={first_line:o[o.length-(b||1)].first_line,last_line:o[o.length-1].last_line,first_column:o[o.length-(b||1)].first_column,last_column:o[o.length-1].last_column},h&&(x._$.range=[o[o.length-(b||1)].range[0],o[o.length-1].range[1]]),v=this.performAction.call(x,a,u,c,this.yy,m[1],i,o),"undefined"!=typeof v)return v;b&&(n=n.slice(0,-1*b*2),i=i.slice(0,-1*b),o=o.slice(0,-1*b)),n.push(this.productions_[m[1]][0]),i.push(x.$),o.push(x._$),w=s[n[n.length-2]][n[n.length-1]],n.push(w);break;case 3:return!0}}return!0}},r=function(){var e={EOF:1,parseError:function(e,t){if(!this.yy.parser)throw new Error(e);this.yy.parser.parseError(e,t)},setInput:function(e){return this._input=e,this._more=this._less=this.done=!1,this.yylineno=this.yyleng=0,this.yytext=this.matched=this.match="",this.conditionStack=["INITIAL"],this.yylloc={first_line:1,first_column:0,last_line:1,last_column:0},this.options.ranges&&(this.yylloc.range=[0,0]),this.offset=0,this},input:function(){var e=this._input[0];this.yytext+=e,this.yyleng++,this.offset++,this.match+=e,this.matched+=e;var t=e.match(/(?:\r\n?|\n).*/g);return t?(this.yylineno++,this.yylloc.last_line++):this.yylloc.last_column++,this.options.ranges&&this.yylloc.range[1]++,this._input=this._input.slice(1),e},unput:function(e){var t=e.length,r=e.split(/(?:\r\n?|\n)/g);this._input=e+this._input,this.yytext=this.yytext.substr(0,this.yytext.length-t-1),this.offset-=t;var n=this.match.split(/(?:\r\n?|\n)/g);this.match=this.match.substr(0,this.match.length-1),this.matched=this.matched.substr(0,this.matched.length-1),r.length-1&&(this.yylineno-=r.length-1);var i=this.yylloc.range;return this.yylloc={first_line:this.yylloc.first_line,last_line:this.yylineno+1,first_column:this.yylloc.first_column,last_column:r?(r.length===n.length?this.yylloc.first_column:0)+n[n.length-r.length].length-r[0].length:this.yylloc.first_column-t},this.options.ranges&&(this.yylloc.range=[i[0],i[0]+this.yyleng-t]),this},more:function(){return this._more=!0,this},less:function(e){this.unput(this.match.slice(e))},pastInput:function(){var e=this.matched.substr(0,this.matched.length-this.match.length);return(e.length>20?"...":"")+e.substr(-20).replace(/\n/g,"")},upcomingInput:function(){var e=this.match;return e.length<20&&(e+=this._input.substr(0,20-e.length)),(e.substr(0,20)+(e.length>20?"...":"")).replace(/\n/g,"")},showPosition:function(){var e=this.pastInput(),t=new Array(e.length+1).join("-");return e+this.upcomingInput()+"\n"+t+"^"},next:function(){if(this.done)return this.EOF;this._input||(this.done=!0);var e,t,r,n,i;this._more||(this.yytext="",this.match="");for(var o=this._currentRules(),s=0;s<o.length&&(r=this._input.match(this.rules[o[s]]),!r||t&&!(r[0].length>t[0].length)||(t=r,n=s,this.options.flex));s++);return t?(i=t[0].match(/(?:\r\n?|\n).*/g),i&&(this.yylineno+=i.length),this.yylloc={first_line:this.yylloc.last_line,last_line:this.yylineno+1,first_column:this.yylloc.last_column,last_column:i?i[i.length-1].length-i[i.length-1].match(/\r?\n?/)[0].length:this.yylloc.last_column+t[0].length},this.yytext+=t[0],this.match+=t[0],this.matches=t,this.yyleng=this.yytext.length,this.options.ranges&&(this.yylloc.range=[this.offset,this.offset+=this.yyleng]),this._more=!1,this._input=this._input.slice(t[0].length),this.matched+=t[0],e=this.performAction.call(this,this.yy,this,o[n],this.conditionStack[this.conditionStack.length-1]),this.done&&this._input&&(this.done=!1),e?e:void 0):""===this._input?this.EOF:this.parseError("Lexical error on line "+(this.yylineno+1)+". Unrecognized text.\n"+this.showPosition(),{text:"",token:null,line:this.yylineno})},lex:function(){var e=this.next();return"undefined"!=typeof e?e:this.lex()},begin:function(e){this.conditionStack.push(e)},popState:function(){return this.conditionStack.pop()},_currentRules:function(){return this.conditions[this.conditionStack[this.conditionStack.length-1]].rules},topState:function(){return this.conditionStack[this.conditionStack.length-2]},pushState:function(e){this.begin(e)}};return e.options={},e.performAction=function(e,t,r,n){function i(e,r){return t.yytext=t.yytext.substr(e,t.yyleng-r)}switch(r){case 0:if("\\\\"===t.yytext.slice(-2)?(i(0,1),this.begin("mu")):"\\"===t.yytext.slice(-1)?(i(0,1),this.begin("emu")):this.begin("mu"),t.yytext)return 14;break;case 1:return 14;case 2:return this.popState(),14;case 3:return t.yytext=t.yytext.substr(5,t.yyleng-9),this.popState(),16;case 4:return 14;case 5:return this.popState(),13;case 6:return 59;case 7:return 62;case 8:return 17;case 9:return this.popState(),this.begin("raw"),21;case 10:return 53;case 11:return 27;case 12:return 45;case 13:return this.popState(),42;case 14:return this.popState(),42;case 15:return 32;case 16:return 37;case 17:return 49;case 18:return 46;case 19:this.unput(t.yytext),this.popState(),this.begin("com");break;case 20:return this.popState(),13;case 21:return 46;case 22:return 67;case 23:return 66;case 24:return 66;case 25:return 81;case 26:break;case 27:return this.popState(),52;case 28:return this.popState(),31;case 29:return t.yytext=i(1,2).replace(/\\"/g,'"'),74;case 30:return t.yytext=i(1,2).replace(/\\'/g,"'"),74;case 31:return 79;case 32:return 76;case 33:return 76;case 34:return 77;case 35:return 78;case 36:return 75;case 37:return 69;case 38:return 71;case 39:return 66;case 40:return 66;case 41:return"INVALID";case 42:return 5}},e.rules=[/^(?:[^\x00]*?(?=(\{\{)))/,/^(?:[^\x00]+)/,/^(?:[^\x00]{2,}?(?=(\{\{|\\\{\{|\\\\\{\{|$)))/,/^(?:\{\{\{\{\/[^\s!"#%-,\.\/;->@\[-\^`\{-~]+(?=[=}\s\/.])\}\}\}\})/,/^(?:[^\x00]*?(?=(\{\{\{\{\/)))/,/^(?:[\s\S]*?--(~)?\}\})/,/^(?:\()/,/^(?:\))/,/^(?:\{\{\{\{)/,/^(?:\}\}\}\})/,/^(?:\{\{(~)?>)/,/^(?:\{\{(~)?#)/,/^(?:\{\{(~)?\/)/,/^(?:\{\{(~)?\^\s*(~)?\}\})/,/^(?:\{\{(~)?\s*else\s*(~)?\}\})/,/^(?:\{\{(~)?\^)/,/^(?:\{\{(~)?\s*else\b)/,/^(?:\{\{(~)?\{)/,/^(?:\{\{(~)?&)/,/^(?:\{\{(~)?!--)/,/^(?:\{\{(~)?![\s\S]*?\}\})/,/^(?:\{\{(~)?)/,/^(?:=)/,/^(?:\.\.)/,/^(?:\.(?=([=~}\s\/.)|])))/,/^(?:[\/.])/,/^(?:\s+)/,/^(?:\}(~)?\}\})/,/^(?:(~)?\}\})/,/^(?:"(\\["]|[^"])*")/,/^(?:'(\\[']|[^'])*')/,/^(?:@)/,/^(?:true(?=([~}\s)])))/,/^(?:false(?=([~}\s)])))/,/^(?:undefined(?=([~}\s)])))/,/^(?:null(?=([~}\s)])))/,/^(?:-?[0-9]+(?:\.[0-9]+)?(?=([~}\s)])))/,/^(?:as\s+\|)/,/^(?:\|)/,/^(?:([^\s!"#%-,\.\/;->@\[-\^`\{-~]+(?=([=~}\s\/.)|]))))/,/^(?:\[[^\]]*\])/,/^(?:.)/,/^(?:$)/],e.conditions={mu:{rules:[6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42],inclusive:!1},emu:{rules:[2],inclusive:!1},com:{rules:[5],inclusive:!1},raw:{rules:[3,4],inclusive:!1},INITIAL:{rules:[0,1,42],inclusive:!0}},e}();return t.lexer=r,e.prototype=t,t.Parser=e,new e}();t["default"]=r,e.exports=t["default"]},function(e,t,r){"use strict";function n(){}function i(e,t,r){void 0===t&&(t=e.length);var n=e[t-1],i=e[t-2];return n?"ContentStatement"===n.type?(i||!r?/\r?\n\s*?$/:/(^|\r?\n)\s*?$/).test(n.original):void 0:r}function o(e,t,r){void 0===t&&(t=-1);var n=e[t+1],i=e[t+2];return n?"ContentStatement"===n.type?(i||!r?/^\s*?\r?\n/:/^\s*?(\r?\n|$)/).test(n.original):void 0:r}function s(e,t,r){var n=e[null==t?0:t+1];if(n&&"ContentStatement"===n.type&&(r||!n.rightStripped)){var i=n.value;n.value=n.value.replace(r?/^\s+/:/^[ \t]*\r?\n?/,""),n.rightStripped=n.value!==i}}function a(e,t,r){var n=e[null==t?e.length-1:t-1];if(n&&"ContentStatement"===n.type&&(r||!n.leftStripped)){var i=n.value;return n.value=n.value.replace(r?/\s+$/:/[ \t]+$/,""),n.leftStripped=n.value!==i,n.leftStripped}}var c=r(8)["default"];t.__esModule=!0;var u=r(6),l=c(u);n.prototype=new l["default"],n.prototype.Program=function(e){var t=!this.isRootSeen;this.isRootSeen=!0;for(var r=e.body,n=0,c=r.length;c>n;n++){var u=r[n],l=this.accept(u);if(l){var p=i(r,n,t),h=o(r,n,t),f=l.openStandalone&&p,d=l.closeStandalone&&h,g=l.inlineStandalone&&p&&h;l.close&&s(r,n,!0),l.open&&a(r,n,!0),g&&(s(r,n),a(r,n)&&"PartialStatement"===u.type&&(u.indent=/([ \t]+$)/.exec(r[n-1].original)[1])),f&&(s((u.program||u.inverse).body),a(r,n)),d&&(s(r,n),a((u.inverse||u.program).body))}}return e},n.prototype.BlockStatement=function(e){this.accept(e.program),this.accept(e.inverse);var t=e.program||e.inverse,r=e.program&&e.inverse,n=r,c=r;if(r&&r.chained)for(n=r.body[0].program;c.chained;)c=c.body[c.body.length-1].program;var u={open:e.openStrip.open,close:e.closeStrip.close,openStandalone:o(t.body),closeStandalone:i((n||t).body)};if(e.openStrip.close&&s(t.body,null,!0),r){var l=e.inverseStrip;l.open&&a(t.body,null,!0),l.close&&s(n.body,null,!0),e.closeStrip.open&&a(c.body,null,!0),i(t.body)&&o(n.body)&&(a(t.body),s(n.body))}else e.closeStrip.open&&a(t.body,null,!0);return u},n.prototype.MustacheStatement=function(e){return e.strip},n.prototype.PartialStatement=n.prototype.CommentStatement=function(e){var t=e.strip||{};return{inlineStandalone:!0,open:t.open,close:t.close}},t["default"]=n,e.exports=t["default"]},function(e,t,r){"use strict";function n(e,t){this.source=e,this.start={line:t.first_line,column:t.first_column},this.end={line:t.last_line,column:t.last_column}}function i(e){return/^\[.*\]$/.test(e)?e.substr(1,e.length-2):e}function o(e,t){return{open:"~"===e.charAt(2),close:"~"===t.charAt(t.length-3)}}function s(e){return e.replace(/^\{\{~?\!-?-?/,"").replace(/-?-?~?\}\}$/,"")}function a(e,t,r){r=this.locInfo(r);for(var n=e?"@":"",i=[],o=0,s="",a=0,c=t.length;c>a;a++){var u=t[a].part,l=t[a].original!==u;if(n+=(t[a].separator||"")+u,l||".."!==u&&"."!==u&&"this"!==u)i.push(u);else{if(i.length>0)throw new f["default"]("Invalid path: "+n,{loc:r});".."===u&&(o++,s+="../")}}return new this.PathExpression(e,o,i,n,r)}function c(e,t,r,n,i,o){var s=n.charAt(3)||n.charAt(2),a="{"!==s&&"&"!==s;return new this.MustacheStatement(e,t,r,a,i,this.locInfo(o))}function u(e,t,r,n){if(e.path.original!==r){var i={loc:e.path.loc};throw new f["default"](e.path.original+" doesn't match "+r,i)}n=this.locInfo(n);var o=new this.Program([t],null,{},n);return new this.BlockStatement(e.path,e.params,e.hash,o,void 0,{},{},{},n)}function l(e,t,r,n,i,o){if(n&&n.path&&e.path.original!==n.path.original){var s={loc:e.path.loc};throw new f["default"](e.path.original+" doesn't match "+n.path.original,s)}t.blockParams=e.blockParams;var a=void 0,c=void 0;return r&&(r.chain&&(r.program.body[0].closeStrip=n.strip),c=r.strip,a=r.program),i&&(i=a,a=t,t=i),new this.BlockStatement(e.path,e.params,e.hash,t,a,e.strip,c,n&&n.strip,this.locInfo(o))}var p=r(8)["default"];t.__esModule=!0,t.SourceLocation=n,t.id=i,t.stripFlags=o,t.stripComment=s,t.preparePath=a,t.prepareMustache=c,t.prepareRawBlock=u,t.prepareBlock=l;var h=r(11),f=p(h)},function(e,t,r){"use strict";function n(e,t,r){if(o.isArray(e)){for(var n=[],i=0,s=e.length;s>i;i++)n.push(t.wrap(e[i],r));return n}return"boolean"==typeof e||"number"==typeof e?e+"":e}function i(e){this.srcFile=e,this.source=[]}t.__esModule=!0;var o=r(12),s=void 0;try{}catch(a){}s||(s=function(e,t,r,n){this.src="",n&&this.add(n)},s.prototype={add:function(e){o.isArray(e)&&(e=e.join("")),this.src+=e},prepend:function(e){o.isArray(e)&&(e=e.join("")),this.src=e+this.src},toStringWithSourceMap:function(){return{code:this.toString()}},toString:function(){return this.src}}),i.prototype={prepend:function(e,t){this.source.unshift(this.wrap(e,t))},push:function(e,t){this.source.push(this.wrap(e,t))},merge:function(){var e=this.empty();return this.each(function(t){e.add(["  ",t,"\n"])}),e},each:function(e){for(var t=0,r=this.source.length;r>t;t++)e(this.source[t])},empty:function(){var e=void 0===arguments[0]?this.currentLocation||{start:{}}:arguments[0];return new s(e.start.line,e.start.column,this.srcFile)},wrap:function(e){var t=void 0===arguments[1]?this.currentLocation||{start:{}}:arguments[1];return e instanceof s?e:(e=n(e,this,t),new s(t.start.line,t.start.column,this.srcFile,e))},functionCall:function(e,t,r){return r=this.generateList(r),this.wrap([e,t?"."+t+"(":"(",r,")"])},quotedString:function(e){return'"'+(e+"").replace(/\\/g,"\\\\").replace(/"/g,'\\"').replace(/\n/g,"\\n").replace(/\r/g,"\\r").replace(/\u2028/g,"\\u2028").replace(/\u2029/g,"\\u2029")+'"'},objectLiteral:function(e){var t=[];for(var r in e)if(e.hasOwnProperty(r)){var i=n(e[r],this);"undefined"!==i&&t.push([this.quotedString(r),":",i])}var o=this.generateList(t);return o.prepend("{"),o.add("}"),o},generateList:function(e,t){for(var r=this.empty(t),i=0,o=e.length;o>i;i++)i&&r.add(","),r.add(n(e[i],this,t));return r},generateArray:function(e,t){var r=this.generateList(e,t);return r.prepend("["),r.add("]"),r}},t["default"]=i,e.exports=t["default"]}])})},{}],6:[function(e,t,r){function n(e,t){if("function"!=typeof e)throw new TypeError(i);return t=o(void 0===t?e.length-1:+t||0,0),function(){for(var r=arguments,n=-1,i=o(r.length-t,0),s=Array(i);++n<i;)s[n]=r[t+n];switch(t){case 0:return e.call(this,s);case 1:return e.call(this,r[0],s);case 2:return e.call(this,r[0],r[1],s)}var a=Array(t+1);for(n=-1;++n<t;)a[n]=r[n];return a[t]=s,e.apply(this,a)}}var i="Expected a function",o=Math.max;t.exports=n},{}],7:[function(e,t,r){(function(r){function n(e){var t=e?e.length:0;for(this.data={hash:a(null),set:new s};t--;)this.push(e[t])}var i=e("./cachePush"),o=e("./getNative"),s=o(r,"Set"),a=o(Object,"create");n.prototype.push=i,t.exports=n}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"./cachePush":28,"./getNative":33}],8:[function(e,t,r){function n(e,t){var r=-1,n=e.length;for(t||(t=Array(n));++r<n;)t[r]=e[r];return t}t.exports=n},{}],9:[function(e,t,r){function n(e,t){for(var r=-1,n=e.length;++r<n&&t(e[r],r,e)!==!1;);return e}t.exports=n},{}],10:[function(e,t,r){function n(e,t){for(var r=-1,n=e.length,i=Array(n);++r<n;)i[r]=t(e[r],r,e);return i}t.exports=n},{}],11:[function(e,t,r){function n(e,t){for(var r=-1,n=t.length,i=e.length;++r<n;)e[i+r]=t[r];return e}t.exports=n},{}],12:[function(e,t,r){function n(e,t){return null==t?e:i(t,o(t),e)}var i=e("./baseCopy"),o=e("../object/keys");t.exports=n},{"../object/keys":56,"./baseCopy":14}],13:[function(e,t,r){function n(e,t,r,d,g,m,v){var b;if(r&&(b=g?r(e,d,g):r(e)),void 0!==b)return b;if(!h(e))return e;var w=p(e);if(w){if(b=c(e),!t)return i(e,b)}else{var x=F.call(e),_=x==y;if(x!=E&&x!=f&&(!_||g))return M[x]?u(e,x,t):g?e:{};if(b=l(_?{}:e),!t)return s(b,e)}m||(m=[]),v||(v=[]);for(var k=m.length;k--;)if(m[k]==e)return v[k];return m.push(e),v.push(b),(w?o:a)(e,function(i,o){b[o]=n(i,t,r,o,e,m,v)}),b}var i=e("./arrayCopy"),o=e("./arrayEach"),s=e("./baseAssign"),a=e("./baseForOwn"),c=e("./initCloneArray"),u=e("./initCloneByTag"),l=e("./initCloneObject"),p=e("../lang/isArray"),h=e("../lang/isObject"),f="[object Arguments]",d="[object Array]",g="[object Boolean]",m="[object Date]",v="[object Error]",y="[object Function]",b="[object Map]",w="[object Number]",E="[object Object]",x="[object RegExp]",_="[object Set]",k="[object String]",S="[object WeakMap]",A="[object ArrayBuffer]",T="[object Float32Array]",P="[object Float64Array]",N="[object Int8Array]",I="[object Int16Array]",O="[object Int32Array]",R="[object Uint8Array]",L="[object Uint8ClampedArray]",j="[object Uint16Array]",C="[object Uint32Array]",M={};M[f]=M[d]=M[A]=M[g]=M[m]=M[T]=M[P]=M[N]=M[I]=M[O]=M[w]=M[E]=M[x]=M[k]=M[R]=M[L]=M[j]=M[C]=!0,M[v]=M[y]=M[b]=M[_]=M[S]=!1;var U=Object.prototype,F=U.toString;t.exports=n},{"../lang/isArray":49,"../lang/isObject":52,"./arrayCopy":8,"./arrayEach":9,"./baseAssign":12,"./baseForOwn":19,"./initCloneArray":35,"./initCloneByTag":36,"./initCloneObject":37}],14:[function(e,t,r){function n(e,t,r){r||(r={});for(var n=-1,i=t.length;++n<i;){var o=t[n];r[o]=e[o]}return r}t.exports=n},{}],15:[function(e,t,r){function n(e,t){var r=e?e.length:0,n=[];if(!r)return n;var c=-1,u=i,l=!0,p=l&&t.length>=a?s(t):null,h=t.length;p&&(u=o,l=!1,t=p);e:for(;++c<r;){var f=e[c];if(l&&f===f){for(var d=h;d--;)if(t[d]===f)continue e;n.push(f)}else u(t,f,0)<0&&n.push(f)}return n}var i=e("./baseIndexOf"),o=e("./cacheIndexOf"),s=e("./createCache"),a=200;t.exports=n},{"./baseIndexOf":20,"./cacheIndexOf":27,"./createCache":31}],16:[function(e,t,r){function n(e,t,r,u){u||(u=[]);for(var l=-1,p=e.length;++l<p;){var h=e[l];c(h)&&a(h)&&(r||s(h)||o(h))?t?n(h,t,r,u):i(u,h):r||(u[u.length]=h)}return u}var i=e("./arrayPush"),o=e("../lang/isArguments"),s=e("../lang/isArray"),a=e("./isArrayLike"),c=e("./isObjectLike");t.exports=n},{"../lang/isArguments":48,"../lang/isArray":49,"./arrayPush":11,"./isArrayLike":38,"./isObjectLike":42}],17:[function(e,t,r){var n=e("./createBaseFor"),i=n();t.exports=i},{"./createBaseFor":30}],18:[function(e,t,r){function n(e,t){return i(e,t,o)}var i=e("./baseFor"),o=e("../object/keysIn");t.exports=n},{"../object/keysIn":57,"./baseFor":17}],19:[function(e,t,r){function n(e,t){return i(e,t,o)}var i=e("./baseFor"),o=e("../object/keys");t.exports=n},{"../object/keys":56,"./baseFor":17}],20:[function(e,t,r){function n(e,t,r){if(t!==t)return i(e,r);for(var n=r-1,o=e.length;++n<o;)if(e[n]===t)return n;return-1}var i=e("./indexOfNaN");t.exports=n},{"./indexOfNaN":34}],21:[function(e,t,r){function n(e,t,r,h,f){if(!c(e))return e;var d=a(t)&&(s(t)||l(t)),g=d?void 0:p(t);return i(g||t,function(i,s){if(g&&(s=i,i=t[s]),u(i))h||(h=[]),f||(f=[]),o(e,t,s,n,r,h,f);else{var a=e[s],c=r?r(a,i,s,e,t):void 0,l=void 0===c;l&&(c=i),void 0===c&&(!d||s in e)||!l&&(c===c?c===a:a!==a)||(e[s]=c)}}),e}var i=e("./arrayEach"),o=e("./baseMergeDeep"),s=e("../lang/isArray"),a=e("./isArrayLike"),c=e("../lang/isObject"),u=e("./isObjectLike"),l=e("../lang/isTypedArray"),p=e("../object/keys");t.exports=n},{"../lang/isArray":49,"../lang/isObject":52,"../lang/isTypedArray":54,"../object/keys":56,"./arrayEach":9,"./baseMergeDeep":22,"./isArrayLike":38,"./isObjectLike":42}],22:[function(e,t,r){function n(e,t,r,n,p,h,f){for(var d=h.length,g=t[r];d--;)if(h[d]==g)return void(e[r]=f[d]);var m=e[r],v=p?p(m,g,r,e,t):void 0,y=void 0===v;y&&(v=g,a(g)&&(s(g)||u(g))?v=s(m)?m:a(m)?i(m):[]:c(g)||o(g)?v=o(m)?l(m):c(m)?m:{}:y=!1),h.push(g),f.push(v),y?e[r]=n(v,g,p,h,f):(v===v?v!==m:m===m)&&(e[r]=v)}var i=e("./arrayCopy"),o=e("../lang/isArguments"),s=e("../lang/isArray"),a=e("./isArrayLike"),c=e("../lang/isPlainObject"),u=e("../lang/isTypedArray"),l=e("../lang/toPlainObject");t.exports=n},{"../lang/isArguments":48,"../lang/isArray":49,"../lang/isPlainObject":53,"../lang/isTypedArray":54,"../lang/toPlainObject":55,"./arrayCopy":8,"./isArrayLike":38}],23:[function(e,t,r){function n(e){return function(t){return null==t?void 0:t[e]}}t.exports=n},{}],24:[function(e,t,r){function n(e){return null==e?"":e+""}t.exports=n},{}],25:[function(e,t,r){function n(e,t,r){if("function"!=typeof e)return i;if(void 0===t)return e;switch(r){case 1:return function(r){return e.call(t,r)};case 3:return function(r,n,i){return e.call(t,r,n,i)};case 4:return function(r,n,i,o){return e.call(t,r,n,i,o)};case 5:return function(r,n,i,o,s){return e.call(t,r,n,i,o,s)}}return function(){return e.apply(t,arguments)}}var i=e("../utility/identity");t.exports=n},{"../utility/identity":62}],26:[function(e,t,r){(function(e){function r(e){var t=new n(e.byteLength),r=new i(t);return r.set(new i(e)),t}var n=e.ArrayBuffer,i=e.Uint8Array;t.exports=r}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],27:[function(e,t,r){function n(e,t){var r=e.data,n="string"==typeof t||i(t)?r.set.has(t):r.hash[t];return n?0:-1}var i=e("../lang/isObject");t.exports=n},{"../lang/isObject":52}],28:[function(e,t,r){function n(e){var t=this.data;"string"==typeof e||i(e)?t.set.add(e):t.hash[e]=!0}var i=e("../lang/isObject");t.exports=n},{"../lang/isObject":52}],29:[function(e,t,r){function n(e){return s(function(t,r){var n=-1,s=null==t?0:r.length,a=s>2?r[s-2]:void 0,c=s>2?r[2]:void 0,u=s>1?r[s-1]:void 0;for("function"==typeof a?(a=i(a,u,5),s-=2):(a="function"==typeof u?u:void 0,s-=a?1:0),c&&o(r[0],r[1],c)&&(a=3>s?void 0:a,s=1);++n<s;){var l=r[n];l&&e(t,l,a)}return t})}var i=e("./bindCallback"),o=e("./isIterateeCall"),s=e("../function/restParam");t.exports=n},{"../function/restParam":6,"./bindCallback":25,"./isIterateeCall":40}],30:[function(e,t,r){function n(e){return function(t,r,n){for(var o=i(t),s=n(t),a=s.length,c=e?a:-1;e?c--:++c<a;){var u=s[c];if(r(o[u],u,o)===!1)break}return t}}var i=e("./toObject");t.exports=n},{"./toObject":46}],31:[function(e,t,r){(function(r){function n(e){return a&&s?new i(e):null}var i=e("./SetCache"),o=e("./getNative"),s=o(r,"Set"),a=o(Object,"create");t.exports=n}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"./SetCache":7,"./getNative":33}],32:[function(e,t,r){var n=e("./baseProperty"),i=n("length");t.exports=i},{"./baseProperty":23}],33:[function(e,t,r){function n(e,t){var r=null==e?void 0:e[t];return i(r)?r:void 0}var i=e("../lang/isNative");t.exports=n},{"../lang/isNative":51}],34:[function(e,t,r){function n(e,t,r){for(var n=e.length,i=t+(r?0:-1);r?i--:++i<n;){var o=e[i];if(o!==o)return i}return-1}t.exports=n},{}],35:[function(e,t,r){function n(e){var t=e.length,r=new e.constructor(t);return t&&"string"==typeof e[0]&&o.call(e,"index")&&(r.index=e.index,r.input=e.input),r}var i=Object.prototype,o=i.hasOwnProperty;t.exports=n},{}],36:[function(e,t,r){function n(e,t,r){var n=e.constructor;switch(t){case l:return i(e);case o:case s:return new n(+e);case p:case h:case f:case d:case g:case m:case v:case y:case b:var E=e.buffer;return new n(r?i(E):E,e.byteOffset,e.length);case a:case u:return new n(e);case c:var x=new n(e.source,w.exec(e));x.lastIndex=e.lastIndex}return x}var i=e("./bufferClone"),o="[object Boolean]",s="[object Date]",a="[object Number]",c="[object RegExp]",u="[object String]",l="[object ArrayBuffer]",p="[object Float32Array]",h="[object Float64Array]",f="[object Int8Array]",d="[object Int16Array]",g="[object Int32Array]",m="[object Uint8Array]",v="[object Uint8ClampedArray]",y="[object Uint16Array]",b="[object Uint32Array]",w=/\w*$/;t.exports=n},{"./bufferClone":26}],37:[function(e,t,r){function n(e){var t=e.constructor;return"function"==typeof t&&t instanceof t||(t=Object),new t}t.exports=n},{}],38:[function(e,t,r){function n(e){return null!=e&&o(i(e))}var i=e("./getLength"),o=e("./isLength");t.exports=n},{"./getLength":32,"./isLength":41}],39:[function(e,t,r){function n(e,t){return e="number"==typeof e||i.test(e)?+e:-1,t=null==t?o:t,e>-1&&e%1==0&&t>e}var i=/^\d+$/,o=9007199254740991;t.exports=n},{}],40:[function(e,t,r){function n(e,t,r){if(!s(r))return!1;var n=typeof t;if("number"==n?i(r)&&o(t,r.length):"string"==n&&t in r){var a=r[t];return e===e?e===a:a!==a}return!1}var i=e("./isArrayLike"),o=e("./isIndex"),s=e("../lang/isObject");t.exports=n},{"../lang/isObject":52,"./isArrayLike":38,"./isIndex":39}],41:[function(e,t,r){function n(e){return"number"==typeof e&&e>-1&&e%1==0&&i>=e}var i=9007199254740991;t.exports=n},{}],42:[function(e,t,r){function n(e){return!!e&&"object"==typeof e}t.exports=n},{}],43:[function(e,t,r){function n(e,t){e=i(e);for(var r=-1,n=t.length,o={};++r<n;){var s=t[r];s in e&&(o[s]=e[s])}return o}var i=e("./toObject");t.exports=n},{"./toObject":46}],44:[function(e,t,r){function n(e,t){var r={};return i(e,function(e,n,i){t(e,n,i)&&(r[n]=e)}),r}var i=e("./baseForIn");t.exports=n},{"./baseForIn":18}],45:[function(e,t,r){function n(e){for(var t=c(e),r=t.length,n=r&&e.length,u=!!n&&a(n)&&(o(e)||i(e)),p=-1,h=[];++p<r;){var f=t[p];(u&&s(f,n)||l.call(e,f))&&h.push(f)}return h}var i=e("../lang/isArguments"),o=e("../lang/isArray"),s=e("./isIndex"),a=e("./isLength"),c=e("../object/keysIn"),u=Object.prototype,l=u.hasOwnProperty;t.exports=n},{"../lang/isArguments":48,"../lang/isArray":49,"../object/keysIn":57,"./isIndex":39,"./isLength":41}],46:[function(e,t,r){function n(e){return i(e)?e:Object(e)}var i=e("../lang/isObject");t.exports=n},{"../lang/isObject":52}],47:[function(e,t,r){function n(e,t,r){return"function"==typeof t?i(e,!0,o(t,r,1)):i(e,!0)}var i=e("../internal/baseClone"),o=e("../internal/bindCallback");t.exports=n},{"../internal/baseClone":13,"../internal/bindCallback":25}],48:[function(e,t,r){function n(e){return o(e)&&i(e)&&a.call(e,"callee")&&!c.call(e,"callee")}var i=e("../internal/isArrayLike"),o=e("../internal/isObjectLike"),s=Object.prototype,a=s.hasOwnProperty,c=s.propertyIsEnumerable;t.exports=n},{"../internal/isArrayLike":38,"../internal/isObjectLike":42}],49:[function(e,t,r){var n=e("../internal/getNative"),i=e("../internal/isLength"),o=e("../internal/isObjectLike"),s="[object Array]",a=Object.prototype,c=a.toString,u=n(Array,"isArray"),l=u||function(e){return o(e)&&i(e.length)&&c.call(e)==s};t.exports=l},{"../internal/getNative":33,"../internal/isLength":41,"../internal/isObjectLike":42}],50:[function(e,t,r){function n(e){return i(e)&&a.call(e)==o}var i=e("./isObject"),o="[object Function]",s=Object.prototype,a=s.toString;t.exports=n},{"./isObject":52}],51:[function(e,t,r){function n(e){return null==e?!1:i(e)?l.test(c.call(e)):o(e)&&s.test(e)}var i=e("./isFunction"),o=e("../internal/isObjectLike"),s=/^\[object .+?Constructor\]$/,a=Object.prototype,c=Function.prototype.toString,u=a.hasOwnProperty,l=RegExp("^"+c.call(u).replace(/[\\^$.*+?()[\]{}|]/g,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");t.exports=n},{"../internal/isObjectLike":42,"./isFunction":50}],52:[function(e,t,r){function n(e){var t=typeof e;return!!e&&("object"==t||"function"==t)}t.exports=n},{}],53:[function(e,t,r){function n(e){var t;if(!s(e)||l.call(e)!=a||o(e)||!u.call(e,"constructor")&&(t=e.constructor,"function"==typeof t&&!(t instanceof t)))return!1;var r;return i(e,function(e,t){r=t}),void 0===r||u.call(e,r)}var i=e("../internal/baseForIn"),o=e("./isArguments"),s=e("../internal/isObjectLike"),a="[object Object]",c=Object.prototype,u=c.hasOwnProperty,l=c.toString;t.exports=n},{"../internal/baseForIn":18,"../internal/isObjectLike":42,"./isArguments":48}],54:[function(e,t,r){function n(e){return o(e)&&i(e.length)&&!!N[O.call(e)]}var i=e("../internal/isLength"),o=e("../internal/isObjectLike"),s="[object Arguments]",a="[object Array]",c="[object Boolean]",u="[object Date]",l="[object Error]",p="[object Function]",h="[object Map]",f="[object Number]",d="[object Object]",g="[object RegExp]",m="[object Set]",v="[object String]",y="[object WeakMap]",b="[object ArrayBuffer]",w="[object Float32Array]",E="[object Float64Array]",x="[object Int8Array]",_="[object Int16Array]",k="[object Int32Array]",S="[object Uint8Array]",A="[object Uint8ClampedArray]",T="[object Uint16Array]",P="[object Uint32Array]",N={};N[w]=N[E]=N[x]=N[_]=N[k]=N[S]=N[A]=N[T]=N[P]=!0,N[s]=N[a]=N[b]=N[c]=N[u]=N[l]=N[p]=N[h]=N[f]=N[d]=N[g]=N[m]=N[v]=N[y]=!1;var I=Object.prototype,O=I.toString;t.exports=n},{"../internal/isLength":41,"../internal/isObjectLike":42}],55:[function(e,t,r){function n(e){return i(e,o(e))}var i=e("../internal/baseCopy"),o=e("../object/keysIn");t.exports=n},{"../internal/baseCopy":14,"../object/keysIn":57}],56:[function(e,t,r){var n=e("../internal/getNative"),i=e("../internal/isArrayLike"),o=e("../lang/isObject"),s=e("../internal/shimKeys"),a=n(Object,"keys"),c=a?function(e){var t=null==e?void 0:e.constructor;return"function"==typeof t&&t.prototype===e||"function"!=typeof e&&i(e)?s(e):o(e)?a(e):[]}:s;t.exports=c},{"../internal/getNative":33,"../internal/isArrayLike":38,"../internal/shimKeys":45,"../lang/isObject":52}],57:[function(e,t,r){function n(e){if(null==e)return[];c(e)||(e=Object(e));var t=e.length;t=t&&a(t)&&(o(e)||i(e))&&t||0;for(var r=e.constructor,n=-1,u="function"==typeof r&&r.prototype===e,p=Array(t),h=t>0;++n<t;)p[n]=n+"";for(var f in e)h&&s(f,t)||"constructor"==f&&(u||!l.call(e,f))||p.push(f);return p}var i=e("../lang/isArguments"),o=e("../lang/isArray"),s=e("../internal/isIndex"),a=e("../internal/isLength"),c=e("../lang/isObject"),u=Object.prototype,l=u.hasOwnProperty;t.exports=n},{"../internal/isIndex":39,"../internal/isLength":41,"../lang/isArguments":48,"../lang/isArray":49,"../lang/isObject":52}],58:[function(e,t,r){var n=e("../internal/baseMerge"),i=e("../internal/createAssigner"),o=i(n);t.exports=o},{"../internal/baseMerge":21,"../internal/createAssigner":29}],59:[function(e,t,r){var n=e("../internal/arrayMap"),i=e("../internal/baseDifference"),o=e("../internal/baseFlatten"),s=e("../internal/bindCallback"),a=e("./keysIn"),c=e("../internal/pickByArray"),u=e("../internal/pickByCallback"),l=e("../function/restParam"),p=l(function(e,t){if(null==e)return{};if("function"!=typeof t[0]){var t=n(o(t),String);return c(e,i(a(e),t))}var r=s(t[0],t[1],3);return u(e,function(e,t,n){return!r(e,t,n)})});t.exports=p},{"../function/restParam":6,
"../internal/arrayMap":10,"../internal/baseDifference":15,"../internal/baseFlatten":16,"../internal/bindCallback":25,"../internal/pickByArray":43,"../internal/pickByCallback":44,"./keysIn":57}],60:[function(e,t,r){function n(e,t,r){e=i(e),t+="";var n=e.length;return r=void 0===r?n:o(0>r?0:+r||0,n),r-=t.length,r>=0&&e.indexOf(t,r)==r}var i=e("../internal/baseToString"),o=Math.min;t.exports=n},{"../internal/baseToString":24}],61:[function(e,t,r){function n(e,t,r){return e=i(e),r=null==r?0:o(0>r?0:+r||0,e.length),e.lastIndexOf(t,r)==r}var i=e("../internal/baseToString"),o=Math.min;t.exports=n},{"../internal/baseToString":24}],62:[function(e,t,r){function n(e){return e}t.exports=n},{}],63:[function(e,t,r){"use strict";var n=e("./util"),i=e("./logger-factory"),o=e("browser-bunyan"),s=e("./default-widget-model"),a=function(){this.log=i.getLogger()};a.prototype.combine=function(e){var t=this.log,r=n.cloneDeep(s);return e.forEach(function(e){n.merge(r,n.omit(e,["preferences","viewmodes"])),n.isArray(e.viewmodes)&&e.viewmodes.forEach(function(e){r.viewmodes.indexOf(e)<0&&r.viewmodes.push(e)}),n.isArray(e.preferences)&&e.preferences.forEach(function(e){for(var t=!1,n=0;n<r.preferences.length&&!t;n++)r.preferences[n].name===e.name&&(r.preferences[n].value=e.value,r.preferences[n].readonly=e.readonly,r.preferences[n]["bb.type"]=e["bb.type"],r.preferences[n]["bb:label"]=e["bb:label"],r.preferences[n]["bb:viewhints"]=e["bb:viewhints"],t=!0);t||r.preferences.push({name:e.name,value:e.value,readonly:e.readonly,"bb.type":e["bb.type"],"bb:label":e["bb:label"],"bb:viewhints":e["bb:viewhints"]})})}),t.debug("Aggregated model created."),t.level()<=o.TRACE&&t.trace("Aggregated model is this:\n %s",JSON.stringify(r,null,"	")),r},t.exports=a},{"./default-widget-model":66,"./logger-factory":67,"./util":69,"browser-bunyan":2}],64:[function(e,t,r){"use strict";var n=function(e){};n.prototype.parse=function(e){throw new Error("ConfigParser#parse must be overridden.")},t.exports=n},{}],65:[function(e,t,r){"use strict";var n=function(e){};n.prototype.read=function(e){throw new Error("ConfigReader#read must be overridden.")},t.exports=n},{}],66:[function(e,t,r){"use strict";var n={id:null,version:null,height:null,width:null,viewmodes:[],name:null,shortName:null,description:null,author:null,authorHref:null,authorEmail:null,preferences:[],license:null,licenseHref:null,icons:[],content:{src:"index.html",type:"text/html",encoding:"UTF-8"},features:[]};t.exports=n},{}],67:[function(e,t,r){"use strict";var n=e("browser-bunyan"),i=e("./util"),o={},s=null,a={defaultLoggerName:"logger",defaultLogLevel:"info"};a.createLogger=function(e){e=e||{};var t=e.parentLog||null,r=e.loggerName||this.defaultLoggerName,a=e.logLevel||this.defaultLogLevel,c=e.appendId||!1;c&&(r+="/"+i.randomId());var u;return u=t?t.child({childName:r}):n.createLogger({name:r,streams:[{level:a,stream:new n.ConsoleFormattedStream,type:"raw"}]}),o[r]=u,s=u,u},a.getLogger=function(e){return e&&o[e]?o[e]:s?s:a.createLogger()},t.exports=a},{"./util":69,"browser-bunyan":2}],68:[function(e,t,r){"use strict";var n=e("q"),i=e("./widget-renderer"),o=e("./logger-factory"),s=function(){this.preprocessorMap={},this.log=o.getLogger()};s.prototype=Object.create(i.prototype),s.prototype.render=function(e,t,r){var i=this;try{return n(this.fetchStartFile(e,t,r)).then(function(e){return n(i.preprocess(t,e,t))}).then(function(e){return n(i.process(t,r,e))})}catch(o){return n.reject(o)}},s.prototype.fetchStartFile=function(e,t,r){throw new Error("PreprocessingRenderer#fetchStartFile must be overridden.")},s.prototype.preprocess=function(e,t,r){var i=e.content.type;if(t&&this.preprocessorMap.hasOwnProperty(i)){var o=this.preprocessorMap[i];return this.log.debug("Applying preprocessor for [%s] for [%s (%s)] ",o.name,e.content.src,i),o.process(e,t,r)}return n(t)},s.prototype.process=function(e,t,r,n){throw new Error("PreprocessingRenderer#process must be overridden.")},s.prototype.addPreprocessor=function(e,t){if(this.preprocessorMap.hasOwnProperty(e)){var r=this.preprocessorMap[e].name;this.log.warn("Overriding a previously added preprocessor [%s] for the mime type [%s]",r,e)}t.name=t.name||"Anonymous preprocessor",this.log.debug("Adding the preprocessor [%s] for start files with the mime type [%s]",t.name,e),this.preprocessorMap[e]=t},t.exports=s},{"./logger-factory":67,"./widget-renderer":75,q:223}],69:[function(e,t,r){"use strict";var n={isArray:e("lodash/lang/isArray"),cloneDeep:e("lodash/lang/cloneDeep"),merge:e("lodash/object/merge"),startsWith:e("lodash/string/startsWith"),endsWith:e("lodash/string/endsWith"),omit:e("lodash/object/omit")},i={};i.parseBoolean=function(e){return("boolean"==typeof e||e instanceof Boolean)&&1==e||("string"==typeof e||e instanceof String)&&/^\s*true\s*$/i.test(e)||("number"==typeof e||e instanceof Number)&&0!=e},i.isUrlAbsolute=function(e){var t=/^https?:\/\/|file?:\/\//i;return t.test(e)},i.isUrlSiteRelative=function(e){return 0===e.indexOf("/")},i.isUrlDocumentRelative=function(e){return!(i.isUrlAbsolute(e)||i.isUrlSiteRelative(e))},i.merge=n.merge,i.omit=n.omit,i.startsWith=n.startsWith,i.endsWith=n.endsWith,i.cloneDeep=function(){try{return n.cloneDeep.apply(n,Array.prototype.slice.call(arguments))}catch(e){throw console.warn(e),e}},i.isArray=n.isArray,i.format=function(e){if(null===e)return"null";if("string"!=typeof e)return e.toString();for(var t=/%[sdj%]/g,r=1,n=arguments,i=n.length,o=String(e).replace(t,function(e){if("%%"===e)return"%";if(r>=i)return e;switch(e){case"%s":return String(n[r++]);case"%d":return Number(n[r++]);case"%j":try{return JSON.stringify(n[r++])}catch(t){return"[Circular]"}default:return e}}),s=n[r];i>r;s=n[++r])o+=" "+s;return o},i.getDescendantLocales=function(e){e=e.toLowerCase();for(var t,r=[],n=e.split("-");t=n.shift();){var i=r[r.length-1];r.push((i?i+"-":"")+t)}return r},i.randomId=function(){return Math.random().toString(36).substring(7)},t.exports=i},{"lodash/lang/cloneDeep":47,"lodash/lang/isArray":49,"lodash/object/merge":58,"lodash/object/omit":59,"lodash/string/endsWith":60,"lodash/string/startsWith":61}],70:[function(e,t,r){"use strict";var n=e("q"),i=e("./util"),o=e("./logger-factory"),s=e("./widget-renderer"),a=e("./config-reader"),c=e("./config-parser"),u=e("./widget-storage"),l=e("./widget-instance-factory"),p=e("./widget-feature-augmenter"),h=e("./config-aggregator"),f=e("./widget-error"),d={POST_READ:"postRead",PRE_RENDER:"preRender",POST_RENDER:"postRender"},g={html:"text/html",hbs:"text/x-handlebars-template",handlebars:"text/x-handlebars-template",soy:"text/x-soy"},m=function(e){this.config=e,this.locale=this.config.locale||null,this.plugins=[],this.features=[],this.widgetInstanceFactory=new l,this.widgetFeatureAugmenter=new p,this.log=o.getLogger();var t=v(this.config);if(t.warnings.length&&console.warn(t.warnings.join("\n")),t.errors.length){var r="Problems with widget config:\n	"+t.errors.join("	\n");throw new f(r)}};m.prototype.start=function(){var e=(new Date).getTime(),t=this.log,r=this.config,o=this.locale,s=this.plugins,a=this.features,c=r.initialModel||{},u=r.widgetPath,l=r.configFile||"config.xml";""===u&&(u=".");var p=this.widgetInstanceFactory,m=this.widgetFeatureAugmenter;t.info("Starting widget @ %s...",u),t.info("Entering READ phase.");var v=n({});return r.reader&&(v=v.then(function(){var e=(i.endsWith(u,"/")?u:u+"/")+l;return r.reader.read(e)})),r.parser&&(v=v.then(function(e){return r.parser.parse(e)})),n.all([c,v]).then(function(e){t.debug("Aggregating models...");var r=new h({log:t});return r.combine(e)}).then(function(e){return e.content.type&&e.content.type!==g.html||(e.content.type=b(e),t.debug("The start file type was inferred as [%s]",e.content.type)),t.info("Invoking plugins for POST READ phase..."),y(s,d.POST_READ,[e])}).spread(function(e){t.info("Widget config read for: %s (%s).",e.id,e.name),t.info("Entering INSTANCE CREATION phase...");var n=r.renderer,s=r.storage;e.__id=e["bb:uuid"]||i.randomId(),s.init(e.id,e.preferences),t.debug("Widget storage initialized.");var c=p.makeWidget(e,s,n,o);return t.debug("Widget instance created."),m.addFeaturesToWidget(c,a,e),t.debug("%s feature(s) added to widget.",a.length),[c,n,e]}).spread(function(e,r,n){t.info("Invoking plugins for PRE RENDER phase...");var i=y(s,d.PRE_RENDER,[e,r,n]);return i}).spread(function(e,r,n){t.info("Entering RENDERING phase...");var i=r.render(u,n,e);return[e,r,n,i]}).spread(function(e,r,n){t.info("Invoking plugins for POST RENDER phase...");var i=y(s,d.POST_RENDER,[e,r,n]);return i}).spread(function(r,n,i){var o={},s=(new Date).getTime();return o.time=s-e,o.id=i.id,o.message="Widget rendering for ["+i.id+"] completed in "+o.time+"ms.",o.areaNodes="function"==typeof n.getAreaNodes?n.getAreaNodes():null,t.info(o.message),o}).fail(function(e){throw t.error(e),new f(e,"An error occurred whilst starting the widget.")})},m.prototype.addFeature=function(e){return this.log.info("Adding feature for widget, %s",e.name||"[Anonymous feature]"),"object"==typeof e&&this.features.push(e),this},m.prototype.addPlugin=function(e){return this.log.info("Adding plugin for widget, %s",e.name||"[Anonymous plugin]"),"object"==typeof e&&this.plugins.push(e),this},m.prototype.destroy=function(){this.plugins.forEach(function(e){"function"==typeof e.destroy&&e.destroy()}),this.config.renderer.destroy()};var v=function(e){var t={warnings:[],errors:[]};return"string"!=typeof e.widgetPath?t.errors.push("You must supply a valid widget path"):e.widgetPath.indexOf("config.xml")>=0&&t.errors.push("Please supply the base path of your widget, not its config.xml path"),e.initialModel||e.reader||t.warnings.push("No initial model or widget reader was provided. Can't get any config"),e.reader&&!e.parser&&t.warnings.push("A widget reader was provided, but not a widget config parser"),!e.reader||e.reader instanceof a||t.warnings.push("The configured widget reader might not be a valid ConfigReader instance"),!e.parser||e.parser instanceof c||t.warnings.push("The configured widget parser might not be a valid ConfigParser instance"),e.storage?e.storage instanceof u||t.warnings.push("The configured widget storage might not be a valid WidgetStorage instance"):t.errors.push("No widget storage is configured"),e.renderer?e.renderer instanceof s||t.warnings.push("The configured widget renderer might not be a valid WidgetRenderer instance"):t.errors.push("No widget renderer is configured"),t},y=function(e,t,r){var i=n.all(r);return e.forEach(function(e){var r=e.name||"Anonymous plugin";"function"==typeof e[t]&&(i=i.spread(function(){var r=Array.prototype.slice.call(arguments),n=e[t].apply(e,r);return n instanceof Array||(n=[n].concat(r.slice(1))),n}).fail(function(e){var n="Failed to invoke plugin ["+r+"] for ["+t+"]";throw new f(e,n)}))}),i},b=function(e){var t=e.content.src.match(/\.([A-z0-9]+)$/);return t&&t[1]&&g[t[1]]||e.content.type};t.exports=m},{"./config-aggregator":63,"./config-parser":64,"./config-reader":65,"./logger-factory":67,"./util":69,"./widget-error":72,"./widget-feature-augmenter":73,"./widget-instance-factory":74,"./widget-renderer":75,"./widget-storage":76,q:223}],71:[function(e,t,r){"use strict";t.exports={STARTFILE_NOT_FOUND:"STARTFILE_NOT_FOUND"}},{}],72:[function(e,t,r){function n(e){var t,r,i,o,s;return this instanceof n?(e instanceof Error||"object"==typeof e?t=Array.prototype.slice.call(arguments,1):(t=Array.prototype.slice.call(arguments,0),e=void 0),e&&e.strict||(t=t.map(function(e){return null===e?"null":void 0===e?"undefined":e})),s=t.length>0?t.join("; "):"",this.jse_shortmsg=s,this.jse_summary=s,e&&(i=e.cause,i&&e.cause instanceof Error||(i=e),i&&i instanceof Error&&(this.jse_cause=i,this.jse_summary+=": "+i.message)),this.message=this.jse_summary,Error.call(this,this.jse_summary),Error.captureStackTrace&&(o=e?e.constructorOpt:void 0,o=o||arguments.callee,Error.captureStackTrace(this,o)),this):(t=Array.prototype.slice.call(arguments,0),r=Object.create(n.prototype),n.apply(r,arguments),r)}n.prototype=Error.prototype,n.prototype.name="Widget Error",n.prototype.toString=function(){var e=this.hasOwnProperty("name")&&this.name||this.constructor.name||this.constructor.prototype.name;return this.message&&(e+=": "+this.message),e},n.prototype.cause=function(){return this.jse_cause},n.prototype.hasCode=function(e){if(!e)return!1;var t="[object Array]"!==Object.prototype.toString.call(e)?[e]:e;if(0===t.length)return!1;for(var r=this,n=!1;r;){if(r.code&&t.indexOf(r.code)>-1){n=!0;break}r=r.cause()}return n},t.exports=n},{}],73:[function(e,t,r){"use strict";var n=e("./widget-error"),i=function(){};i.prototype.addFeaturesToWidget=function(e,t,r){function i(e,t){for(var r=0;r<t.length;r++)if(e===t[r].name)return t[r];return null}t=t||[];var o={};if(r.features&&r.features.length)for(var s=0;s<r.features.length;s++){var a=r.features[s],c=i(a.name,t);if(c)"function"==typeof c._init&&c._init(a.params,e,r),Object.defineProperty(o,c.name,{enumerable:!0,value:c});else if(a.required){var u="Unable to render widget. A required feature is not available ("+a.name+")";throw new n(u)}}return Object.defineProperty(e,"features",{enumerable:!1,value:o}),e},t.exports=i},{"./widget-error":72}],74:[function(e,t,r){"use strict";var n=e("./util"),i=["author","version","id","authorEmail","authorHref"],o=["description","name","shortName"],s=function(){};s.prototype.makeWidget=function(e,t,r,s){var a={};return i.forEach(function(t){Object.defineProperty(a,t,{enumerable:!0,value:"undefined"!=typeof e[t]?e[t]:""})}),o.forEach(function(t){var r=null;if(s&&e._lang){var i=n.getDescendantLocales(s),o=i.map(function(t){return e._lang[t]}),c=function(e){var r;if(e.length){var n=e.pop();if(n&&(r=n[t]),"string"!=typeof r)return c(e)}return r};r=c(o)}if("string"!=typeof r&&"string"==typeof e[t])r=e[t];else if("string"!=typeof r&&e.defaultlocale){var u=e._lang[e.defaultlocale];u&&(r=u[t])}Object.defineProperty(a,t,{enumerable:!0,value:"string"==typeof r?r:""})}),Object.defineProperty(a,"width",{enumerable:!0,get:function(){return r.getWidth()}}),Object.defineProperty(a,"height",{enumerable:!0,get:function(){return r.getHeight()}}),Object.defineProperty(a,"preferences",{enumerable:!1,value:t}),a},t.exports=s},{"./util":69}],75:[function(e,t,r){"use strict";function n(e,t){if(i.isUrlAbsolute(t)||i.isUrlSiteRelative(e)&&i.isUrlSiteRelative(t))return t;var r=!i.endsWith(e,"/")&&!i.startsWith(t,"/");return r?e+"/"+t:e+t}var i=e("./util"),o=function(e){};o.prototype.render=function(e,t,r){throw new Error("WidgetRenderer#render must be overridden.")},o.prototype.getWidth=function(){throw new Error("WidgetRenderer#getWidth must be overridden.")},o.prototype.getHeight=function(){throw new Error("WidgetRenderer#getHeight must be overridden.")},o.prototype.getWidgetNode=function(){throw new Error("WidgetRenderer#getWidgetNode must be overridden.")},o.prototype.getParentNode=function(){throw new Error("WidgetRenderer#getContainerNode must be overridden.")},o.prototype.setParentNode=function(){throw new Error("WidgetRenderer#setContainerNode must be overridden.")},o.prototype.getAreaNodes=function(){if(this.isContainer)throw new Error("WidgetRenderer#getAreaNodes must be overridden.")},o.prototype.destroy=function(){throw new Error("WidgetRenderer#destroy must be overriden.")},o.prototype.getType=function(){return"text/html"},o.prototype.getStartFilePaths=function(e,t){var r,i=[];return t.content&&t.content.src?(r=n(e,t.content.src),i.push(r)):(r=n(e,"index.html"),i.push(r),this.locale&&(r=n(e,"locales/"+this.locale+"/index.html"),i.push(r))),i},t.exports=o},{"./util":69}],76:[function(e,t,r){"use strict";function n(e){}n.prototype.init=function(e,t){throw new Error("WidgetStorage#init must be overridden.")},n.prototype.getItem=function(e){throw new Error("WidgetStorage#getItem must be overridden.")},n.prototype.setItem=function(e,t,r){throw new Error("WidgetStorage#setItem must be overridden.")},n.prototype.removeItem=function(e){throw new Error("WidgetStorage#removeItem must be overridden.")},n.prototype.clear=function(e){throw new Error("WidgetStorage#removeItem must be overridden.")},n.prototype.key=function(e){throw new Error("WidgetStorage#key must be overridden.")},t.exports=n},{}],77:[function(e,t,r){(function(r){"use strict";r.env.Q_DEBUG=window.Q_DEBUG||!1;var n=e("../core/widget-engine"),i=e("../strategies/parser/js-object-parser"),o=e("../strategies/renderer/html5-seamless-renderer"),s=e("../strategies/renderer/html5-container-renderer"),a=e("../strategies/storage/html5-local-storage"),c=e("../plugins/cxp-additions-plugin"),u=e("../strategies/renderer/preprocessors/handlebars-preprocessor"),l=e("../core/logger-factory"),p=null,h=function(){return p||(p=new u)},f=function(e){l.createLogger({parentLog:e.log,loggerName:"container",logLevel:e.logLevel,appendId:!0})};f.prototype.init=function(e){var t=e.widgetUrl,r=e.widgetEl,o=e.locale||null,u=e.useFolderLocalization||!1,l=e.reader||null,p=e.parser||new i,f=e.renderer||new s(r,{locale:o,configVars:e.configVars||{},useFolderLocalization:u});f.addPreprocessor("text/x-handlebars-template",h());var d=e.storage||new a;this.widgetEngine=new n({configFile:e.configFile,widgetPath:t,locale:e.locale,initialModel:e.initialModel,renderer:f,parser:p,reader:l,storage:d}),this.widgetEngine.addPlugin(new c({path:t,locale:e.locale}))},f.prototype.start=function(){return this.widgetEngine.start()},f.prototype.addPlugin=function(e){return this.widgetEngine.addPlugin(e),this},f.prototype.addFeature=function(e){return this.widgetEngine.addFeature(e),this},f.prototype.getLogger=function(){return this.log},f.prototype.destroy=function(){return this.widgetEngine.destroy()};var d=function(e){l.createLogger({parentLog:e.log,loggerName:"widget",logLevel:e.logLevel,appendId:!0})};d.prototype.init=function(e){var t=e.widgetUrl,r=e.widgetEl,s=e.locale||null,u=e.useFolderLocalization||!1,l=e.reader||null,p=e.parser||new i,f=e.renderer||new o(r,{locale:s,configVars:e.configVars||{},useFolderLocalization:u});f.addPreprocessor("text/x-handlebars-template",h());var d=e.storage||new a;this.widgetEngine=new n({configFile:e.configFile,widgetPath:t,parser:p,reader:l,renderer:f,storage:d,locale:e.locale,initialModel:e.initialModel}),this.widgetEngine.addPlugin(new c({path:t,locale:e.locale}))},d.prototype.start=function(){return this.widgetEngine.start()},d.prototype.addPlugin=function(e){return this.widgetEngine.addPlugin(e),this},d.prototype.addFeature=function(e){return this.widgetEngine.addFeature(e),this},d.prototype.getLogger=function(){return this.log},d.prototype.destroy=function(){return this.widgetEngine.destroy()},t.exports={WidgetEngine:d,ContainerEngine:f}}).call(this,e("_process"))},{"../core/logger-factory":67,"../core/widget-engine":70,"../plugins/cxp-additions-plugin":79,"../strategies/parser/js-object-parser":81,"../strategies/renderer/html5-container-renderer":82,"../strategies/renderer/html5-seamless-renderer":83,"../strategies/renderer/preprocessors/handlebars-preprocessor":84,"../strategies/storage/html5-local-storage":86,_process:92}],78:[function(e,t,r){(function(r,n){"use strict";function i(e){return e._items}function o(e,t){var r=[];if(e)for(var n=0;n<e.childNodes.length;n++)e.childNodes[n].hasClass(t)&&r.pus(e.childNodes[n]);return r}function s(e,t){for(;e&&null!==e.parentNode;e=e.parentNode)if(a(e,t))return e;return null}function a(e,t){return e.classList?e.classList.contains(t):new RegExp("(^| )"+t+"( |$)","gi").test(e.className)}function c(e){var t=[];for(var r in e)e.hasOwnProperty(r)&&t.push(r+"="+encodeURIComponent(e[r]));return t.join("&")}function u(e){var t=new FormData;return Object.keys(e).length&&Object.keys(e).forEach(function(r){t.append(r,e[r])}),t}function l(e,t){var r=new DOMParser,n=r.parseFromString(e,"text/html"),i=x(n.getElementsByTagName("img"));return i.forEach(function(e){var r=e.getAttribute("src");r&&f.isUrlSiteRelative(r)&&e.setAttribute("src",p(t,r))}),n.body.innerHTML}function p(e,t){var r,n;for(r=1;r<Math.min(e.length,t.length)&&(n=e.substr(-1*r,r),0!==t.indexOf(n));r++);var i=n?E.resolve(e.substr(0,e.length-n.length),t):E.resolve(e,t);return i}function h(e,t){function r(e,t){return t=t[e.shift()],e.length>0&&"object"==typeof t?r(e,t):t}var n=e.split(/\./);return n.shift(),r(n,t)}var f=e("../core/util"),d=e("../core/logger-factory"),g=e("browser-bunyan"),m=e("event-target"),v=e("../core/widget-error"),y=e("../strategies/storage/storage-event"),b=e("q"),w=e("fetchify")(b.Promise).fetch,E=e("url"),x=Array.prototype.slice.call.bind(Array.prototype.slice),_=function(e){e=e||{},this.name="Backbase Format",this.portalConf=e.portalConf||{},this.contextRoot=e.contextRoot||"",this.remoteContextRoot=e.remoteContextRoot||"",this.makeIncludedRefsAbsolute=e.makeIncludedRefsAbsolute||!1,this.window="undefined"==typeof window?e.window:window,this.fetch=w,this.log=d.getLogger(),this._inlineScriptTags=[]};_.prototype.preRender=function(e,t,o){var s=this;this.log.info("Backbase format plugin is running in PRE RENDER phase...");var a=f.cloneDeep(e);a.width=e.width,a.height=e.height,a.preferences=e.preferences,a.features=e.features,a.id=o.name||Math.random().toString(36).substr(2,5),e.preferences._eventTarget===e&&(e.preferences._eventTarget=a),a.myDefinition={sUrl:o.content.src},a.nodeName="backbaseWidget",a.tagName="backbaseWidget",a.tags=f.isArray(this.portalConf.tags)?this.portalConf.tags:[],e.preferences.getItem("title")||e.preferences.defineItem({name:"title",value:o.name,readonly:!1}),e.preferences.getItem("src")||e.preferences.defineItem({name:"src",value:o.content.src,readonly:!1}),e.preferences.getItem("thumbnailUrl")||e.preferences.defineItem({name:"thumbnailUrl",value:o.icons[0],readonly:!1}),a.model={jxid:"VIEW-"+o.id,localName:"Widget",name:o.id,tag:"widget",tagName:"Widget",contextItemName:this.portalConf.contextItemName||null,extendedItemName:this.portalConf.extendedItemName||null,parentItemName:this.portalConf.parentItemName||null,securityProfile:this.portalConf.securityProfile||null,uuid:o["bb:uuid"]||null,preferences:i(e.preferences),tags:f.isArray(this.portalConf.tags)?this.portalConf.tags:[]},a.model.addEventListener=m.addEventListener,a.model.removeEventListener=m.removeEventListener,a.model.dispatchEvent=m.dispatchEvent,a.getPreference=function(t){return e.preferences.getItem(t)},a.getPreferenceFromParents=a.getPreference,a.getAreaPreference=function(){return e.preferences.getItem("area")||0},a.getOrderPreference=function(){return e.preferences.getItem("order")},a.setPreference=function(t,r){e.preferences.setItem(t,r)},a.getDefinition=function(){return a.myDefinition},a.model.save=function(t){r.nextTick(function(){if("function"==typeof t){var r={contextItemName:a.model.contextItemName,name:a.id,preferences:e.preferences,tag:"widget"},i={status:204,statusText:"No Content",readyState:4};t.call(n,r,i)}})},a.model.getPreference=function(t){return e.preferences.getItem(t)},a.model.setPreference=function(t,r){e.preferences.setItem(t,r)};var c="PrefModified";return a.addEventListener&&a.dispatchEvent&&a.addEventListener("storage",function(t){s.log.debug("Chaining StorageEvent to Backbase 'PrefModified' event...");var r=new y(c);r.initStorageEvent(c,!1,!1,t.key,t.oldValue,t.newValue,t.url,e.preferences),a.model.dispatchEvent(r)}),this.log.info("Backbase format plugin PRE RENDER done."),a},_.prototype.postRender=function(e,t,r){function n(){var e=w.getAttribute("g:onload");if(!e){var t=w.querySelector("div[g\\:onload]");t&&(e=t.getAttribute("g:onload"))}e&&(p.debug("Found g:onload attribute: [%s]",e),i(e))}function i(e){try{p.debug("Executing g:onload script...");var t=T+e+P,r=m.createElement("script");r.type="text/javascript",r.innerHTML=t,m.body.appendChild(r),a._inlineScriptTags.push(r)}catch(n){p.warn("g:onload failed!"),p.error(n)}p.info("Backbase format plugin POST RENDER done.")}var a=this,p=this.log;p.info("Backbase format plugin is running in POST RENDER phase...");var d=this.window,m=d.document,y=r.content?r.content.src.replace(/\/[^\/]+$/,""):"";y=y.replace(/\$\(contextRoot\)/,this.contextRoot);var w=m.createElement("div");w.className="bp-widget-body";var E=t.getWidgetNode(),_=E.parentNode,k=E.nextSibling;w.appendChild(E),k?_.insertBefore(w,k):_.appendChild(w),e.body=w;var S=s(w,"bp-widget");e.htmlNode=S,e.htmlHead=o(S,"bp-widget-head")[0],e.htmlFoot=o(S,"bp-widget-foot")[0];var A=d.widgets?"window.widgets['"+r.__id+"']":"window.widget",T="\n/*seamless widget wrapper*/\n(function(widget, __WIDGET__, __GADGET__) {\n",P="\n})( "+A+", "+A+", "+A+")",N=[],I=r.content.src,O=f.isUrlAbsolute(I)?I:y+"/"+I,R=O.substring(0,O.lastIndexOf("/")+1),L=x(w.getElementsByTagName("g:include"));return p.debug("Found %s g:include(s)",L.length),L.forEach(function(t){var n=t.getAttribute("src"),i=t.getAttribute("proxy")&&"true"===t.getAttribute("proxy"),o=t.getAttribute("method")?t.getAttribute("method"):"GET";p.debug("Processing g:include with data: [src=%s, proxy=%s, method=%s]",n,i,o);var s,d,v={},y={},w=/\$\{([a-zA-Z0-9-_]+)\}/,E=a.remoteContextRoot||a.contextRoot,_=x(t.getElementsByTagName("g:http-preference-param"));_.forEach(function(t){var r=t.getAttribute("name");v[r]=e.getPreference(r),p.debug("Added http param using g:http-preference-param: [%s: %s",r,v[r])});var k=x(t.getElementsByTagName("g:http-preference-param-map"));k.forEach(function(e){var t=e.getAttribute("dataType")||e.getAttribute("datatype");r.preferences&&r.preferences.forEach(function(e){if(e["bb.type"]===t){var r=t+"."+e.name;v[r]=e.value,p.debug("Added httpparam using g:http-preference-param-map: [%s: %s]",r,e.value)}})});var S=x(t.getElementsByTagName("g:http-param")),A=x(t.getElementsByTagName("g:http-proxy-param"));S.concat(A).forEach(function(t){var r=t.getAttribute("name"),n=t.getAttribute("value");n=n.replace(w,function(t,r){return"contextRoot"===r?E:e.getPreference(r)}),0===n.indexOf("__WIDGET__")&&(n=h(n,e)),"g:http-proxy-param"===t.tagName.toLowerCase()?(y[r]=n,p.debug("Added http proxy param using g:http-proxy-param: [%s: %s]",r,n)):(v[r]=n,p.debug("Added http param using g:http-param: [%s: %s]",r,n))}),n&&(n=n.replace(w,function(t,r){return e.getPreference(r)}),n=n.replace("$(contextRoot)",E),f.isUrlDocumentRelative(n)&&(n=R+n,p.debug("Update g:include src to [%s]",n)));var T={};i?(s=a.remoteContextRoot+"/proxy",n&&(y.url=n,Object.keys(v).length&&(y.url+=(y.url.indexOf("?")>=0?"&":"?")+c(v))),T=y):(s=n,T=v);var P={};"post"===o.toLowerCase()?P={method:"post",body:u(T)}:Object.keys(T).length&&(s+=(s.indexOf("?")>=0?"&":"?")+c(T)),p.level()<=g.DEBUG&&p.debug("Making g:include http request to [%s] with fetch opts: [%s]",s,JSON.stringify(P),null,"	"),d=a.fetch(s,P);var I=m.createElement("div");I.className="bp-g-include",I.setAttribute("data-src",s),t.parentNode.insertBefore(I,t.nextSibling),d.then(function(e){return p.debug("g:include request to [%s] completed with status: %s",s,e.status),e.status>=200&&e.status<300?b.Promise.resolve(e.text()):b.Promise.reject(e.statusText)}).fail(function(e){return"Unable to resolve include ( "+e+" )"}).then(function(e){p.trace("Received html response:\n%s",e),a.makeIncludedRefsAbsolute&&a.remoteContextRoot&&(e=l(e,a.remoteContextRoot)),I.innerHTML=e,t.parentNode.removeChild(t),p.trace("Added HTML to DOM:\n%s",e)}),N.push(d)}),b.all(N).then(function(){p.debug("All g:includes completed."),n()}).fail(function(e){throw console.warn(e),new v(e,"An error occurred running this plugin: "+a.name)}),[e,t,r].concat(N)},_.prototype.destroy=function(){this._inlineScriptTags.forEach(function(e){e.remove()})},t.exports=_}).call(this,e("_process"),"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"../core/logger-factory":67,"../core/util":69,"../core/widget-error":72,"../strategies/storage/storage-event":87,_process:92,"browser-bunyan":2,"event-target":3,fetchify:4,q:223,url:97}],79:[function(e,t,r){"use strict";var n=e("event-target"),i=function(e){e=e||{},this.name="CXP Additions Plugin",this.locale=e.locale||null};i.prototype.preRender=function(e,t,r){var i=r.content?r.content.src.replace(/\/[^\/]+$/,""):"";return i=i.replace(/\$\(contextRoot\)/,this.contextRoot),e.addEventListener=n.addEventListener,e.removeEventListener=n.removeEventListener,e.dispatchEvent=n.dispatchEvent,e.preferences._eventTarget||(e.preferences._eventTarget=e),e.baseURI=i,e.locale=this.locale,e},t.exports=i},{"event-target":3}],80:[function(e,t,r){"use strict";function n(e,t,r,n,i){if("string"==typeof t)for(var s in r)if(r.hasOwnProperty(s)){var a=new RegExp(n.start+s+n.end,"g");i.level()<=o.DEBUG&&a.test(t)&&i.debug("Replacing occurences of [%s] with [%s] where [%s=%s]",a,r[s],e,t),t=t.replace(a,r[s])}return t}var i=e("../core/logger-factory"),o=e("browser-bunyan"),s=function(e,t){t=t||{},this.name="Replace Config Vars",this.varMap=e,this.full="boolean"==typeof t.full?t.full:!0,this.interpolateStartRegex=t.interpolateStartRegex||"\\$\\(",this.interpolateEndRegex=t.interpolateEndRegex||"\\)",this.log=i.getLogger()};s.prototype.postRead=function(e){function t(e){for(var o in e)e.hasOwnProperty(o)&&!e._ignoreReplace&&(e[o]=n(o,e[o],r.varMap,{start:r.interpolateStartRegex,end:r.interpolateEndRegex},i),null!==e[o]&&"object"==typeof e[o]&&t(e[o]))}var r=this,i=this.log;return i.info("Replace config vars plugin is running is POST READ phase..."),r.full?(i.debug("Doing full config vars replacement..."),t(e)):(i.debug("Doing minimal config vars replacement (just widget src)..."),e.content&&e.content.src&&(e.content.src=n(e.content.src,r.varMap,{start:r.interpolateStartRegex,end:r.interpolateEndRegex}))),i.info("Replace config vars plugin in POST READ is DONE."),e},t.exports=s},{"../core/logger-factory":67,"browser-bunyan":2}],81:[function(e,t,r){"use strict";var n=e("../../core/config-parser"),i=function(){};i.prototype=Object.create(n.prototype),i.prototype.parse=function(e){return e},t.exports=i},{"../../core/config-parser":64}],82:[function(e,t,r){"use strict";var n=e("./html5-seamless-renderer"),i=function(e,t){n.call(this,e,t),this.isContainer=!0,this.areaMap=null};i.prototype=Object.create(n.prototype),i.prototype.getAreaNodes=function(){var e=this;if(!this.areaMap){e.areaMap={};var t=Array.prototype.slice.call(this.widgetEl.querySelectorAll("div[data-area]"));t.forEach(function(t){var r=t.getAttribute("data-area");e.areaMap[r]=t})}return this.areaMap},t.exports=i},{"./html5-seamless-renderer":83}],83:[function(e,t,r){"use strict";function n(e,t){var r=this,n=["getElementById","getElementsByName","getElementsByTagName","getElementsByClassName","querySelector","querySelectorAll","body","baseURI"];for(var i in t)"function"!=typeof t[i]||i in r?i in r||(n.indexOf(i)?r[i]=e[i]:r[i]=t[i]):!function(i){n.indexOf(i)?r[i]=function(){return e[i].apply(e,Array.prototype.slice.call(arguments,0))}:r[i]=function(){return t[i].apply(t,Array.prototype.slice.call(arguments,0))}}(i)}var i=e("q"),o=e("fetchify")(i.Promise).fetch,s=e("../../core/preprocessing-widget-renderer"),a=e("../../core/widget-error"),c=e("../../core/widget-error-codes"),u=e("../../core/util"),l=e("../../core/logger-factory"),p=e("browser-bunyan"),h=e("url"),f={},d=e("./util/resource-loader"),g=function(e,t){if(s.call(this),"undefined"==typeof window.DOMParser)throw new Error("DOMParser is not shimmed or a native object. This renderer will not work");t=t||{},this.widgetContainerEl=e,this.parsingFormat=t.parsingFormat||null,this.locale=t.locale||null,this.configVars=t.configVars||{},this.useFolderLocalization=t.useFolderLocalization||!1,this.log=l.getLogger(),this.widgetEl=null,this._widgetInstanceReferences=[],this._inlineScriptTags=[]};g.prototype=Object.create(s.prototype),g.prototype.fetchStartFile=function(e,t){this.path=e;var r=this.log;r.debug("Starting HTML5 seamless rendering...");var n=this.getStartFilePaths(e,t,this.locale);this.useFolderLocalization||(n=n.slice(0,1));var i=n.pop();this.startFileDir=i.substring(0,i.lastIndexOf("/")+1),r.debug("Using widget start file @ %s",i);var s=f[i];return s||(r.debug("Requesting start file..."),
s=o(i).then(function(e){if(r.debug("Start file request resolved/ Status: %s",e.status),0===e.status||200===e.status)return e._body;var t=new Error(e.statusText);throw t.code=e.status,t}).then(function(e){return r.trace("Received HTML\n: %s",e),e}).fail(function(e){var t=new a(e,"Failed to fetch "+i);throw 404===e.code&&(t.code=c.STARTFILE_NOT_FOUND),t}),s.then(function(){f[i]=s})),s},g.prototype.process=function(e,t,r){function i(e){return isNaN(parseInt(e))?e:e+"px"}var o=this,s=this.log,c=d(),l="/*seamless widget wrapper*/\n(function(widget, document) {\n",f="\n})( window.widgets['"+e.__id+"'], window.widgets.documents['"+e.__id+"'])",g=new DOMParser,m=this.parsingFormat||"text/html",v=g.parseFromString(r,m);window.widgets=window.widgets||{},window.widgets[e.__id]=t,this._widgetInstanceReferences.push(e.__id);var y=new n(this.widgetContainerEl,document);y.baseURI=this.path,y.body=y,window.widgets.documents=window.widgets.documents||{},window.widgets.documents[e.__id]=y;var b=[],w=Array.prototype.slice.call(v.getElementsByTagName("link"));w.forEach(function(e){if("stylesheet"===e.rel&&e.getAttribute("href")){var t=e.getAttribute("href");t=o._replacePathVars(t),u.isUrlDocumentRelative(t)&&(t=h.resolve(o.startFileDir,t)),e.parentNode.removeChild(e),b.push(t)}}),s.level()<=p.DEBUG&&s.debug("Using resource loader to load %s CSS resource(s): %s ...",b.length,b.join(", ")),c.loadCss(b);var E=Array.prototype.slice.call(v.getElementsByTagName("style"));E.forEach(function(e){document.head.appendChild(e)});var x=[],_=[],k=Array.prototype.slice.call(v.getElementsByTagName("script"));k.forEach(function(e){var t=e.innerHTML;if(t)e.type&&"text/javascript"!==e.type||(s.trace("Queuing script to inline:\n%s",t),_.push(t));else{var r=e.getAttribute("src");r=o._replacePathVars(r),u.isUrlDocumentRelative(r)&&(r=h.resolve(o.startFileDir,r)),x.push(r)}}),s.level()<=p.DEBUG&&s.debug("Using resource loader to load %s JS resource(s): %s ...",x.length,x.join(", "));var S=c.loadScripts(x),A=Array.prototype.slice.call(v.getElementsByTagName("img"));A.forEach(function(e){var t=e.getAttribute("src");if(t){var r=o._replacePathVars(t);if(u.isUrlDocumentRelative(r)){var n=h.resolve(o.startFileDir,r);r=n,s.debug("Image src updated from [%s] to [%s].",t,n)}e.getAttribute("src")!==r&&(e.src=r)}});var T=document.createElement("div");T.id=e.__id,T.setAttribute("data-widget",e.id),e.width&&(T.style.width=i(e.width),s.debug("Widget width set to %s.",T.style.width)),e.height&&(T.style.height=i(e.height),s.debug("Widget height set to %s.",T.style.height));for(var P=v.getElementsByTagName("body")[0],N=P.getAttribute("onload"),I=0;I<P.attributes.length;I++){var O=P.attributes[I];O.specified&&"onload"!==O.name&&T.setAttribute(O.name,O.value)}return T.innerHTML=P.innerHTML,this.widgetContainerEl.appendChild(T),this.widgetEl=T,S.then(function(){s.debug("JS resources have loaded."),N&&(_.push(N),s.debug("Found onload attribute to execute [%s]",N)),s.debug("Adding %s inline script(s). (Including an onload attribute if any)...",_.length);var e=l+_.join("\n")+f,t=document.createElement("script");t.innerHTML=e,document.body.appendChild(t),o._inlineScriptTags.push(t)})["catch"](function(e){throw new a(e,"Failed to render HTML5 seamless widget")})},g.prototype.getWidgetNode=function(){return this.widgetEl||null},g.prototype.getParentNode=function(){return this.widgetContainerEl||null},g.prototype.setParentNode=function(e){this.widgetContainerEl=e},g.prototype.getWidth=function(){return this.getWidgetNode()?this.getWidgetNode().offsetWidth:"auto"},g.prototype.getHeight=function(){return this.getWidgetNode()?this.getWidgetNode().offsetHeight:"auto"},g.prototype._replacePathVars=function(e){var t=this.log,r=this.configVars;for(var n in r)if(r.hasOwnProperty(n)){var i=new RegExp("\\$\\("+n+"\\)","g");t.level()<=p.DEBUG&&i.test(e)&&t.debug("Updating resource url. Replacing %s for %s in [%s]",i,r[n],e),e=e.replace(i,r[n])}return e},g.prototype.destroy=function(){this.widgetEl&&(this.widgetEl.remove(),this.widgetEl=null),this._inlineScriptTags.forEach(function(e){e.remove()}),this._inlineScriptTags=[],this._widgetInstanceReferences.forEach(function(e){delete window.widgets[e]}),this._widgetInstanceReferences=[]},g.prototype._clearCache=function(){f={}},t.exports=g},{"../../core/logger-factory":67,"../../core/preprocessing-widget-renderer":68,"../../core/util":69,"../../core/widget-error":72,"../../core/widget-error-codes":71,"./util/resource-loader":85,"browser-bunyan":2,fetchify:4,q:223,url:97}],84:[function(require,module,exports){"use strict";var Handlebars=require("handlebars/dist/handlebars.min"),WidgetError=require("../../../core/widget-error"),loggerFactory=require("../../../core/logger-factory"),HandlebarsPreprocessor=function(){this.name="Handlebars Preprocessor",this.log=loggerFactory.getLogger(),this.templateCache={},this.hbs=Handlebars.create();var e=HandlebarsPreprocessor.cxpHelpers;for(var t in e)e.hasOwnProperty(t)&&this.hbs.registerHelper(t,e[t])};HandlebarsPreprocessor.prototype.process=function(widgetModel,startFileContent,context){var log=this.log,errMessage,templateKey=widgetModel.id+widgetModel.content.src,template=this.templateCache[templateKey];if(!template){if(widgetModel.content.src&&widgetModel.content.src.match(/\.js$/)){var precompiledTemplate=null;try{eval("precompiledTemplate = "+startFileContent),template=this.hbs.template(precompiledTemplate)}catch(err){throw errMessage="There was a problem evaluating a pre-compiled handlebars template. Ensure it was compiled using the simple option. E.g.`handlebars index.handlebars -s -f index.js`",this.log.error(err,errMessage),new WidgetError(err,errMessage)}}else{log.debug("Compiling handlebars template instance for %s",templateKey);try{template=this.hbs.compile(startFileContent)}catch(err){throw errMessage="There was a problem compiling a handlebars template",this.log.error(err,errMessage),new WidgetError(err,errMessage)}}this.templateCache[templateKey]=template}var result=template(context);return log.trace("Using compiled Handlebars start file for %s:\n%s",templateKey,result),result},HandlebarsPreprocessor.prototype.registerHelper=function(e,t){this.hbs.registerHelper(e,t)},HandlebarsPreprocessor.prototype.registerPartial=function(e,t){this.hbs.registerPartial(e,t)},HandlebarsPreprocessor.cxpHelpers={range:function(e,t,r){var n="";e=parseInt(e),t=parseInt(t);for(var i=e;t>=i;i++)n+=r.fn({index:i,from:e,to:t});return n},getPreferenceValue:function(e){if(this.preferences){var t=this.preferences.filter(function(t){return t.name===e})[0];return t?t.value:null}return null},add:function(e,t){return Math.floor(parseFloat(e)+parseFloat(t))},subtract:function(e,t){return Math.floor(parseFloat(e)-parseFloat(t))},multiply:function(e,t){return Math.floor(parseFloat(e)*parseFloat(t))},divide:function(e,t){return Math.floor(parseFloat(e)/parseFloat(t))},mod:function(e,t){return Math.floor(parseFloat(e)%parseFloat(t))},equal:function(e,t,r){return e===t?r.fn(this):r.inverse(this)},hasViewHint:function(){for(var e=Array.prototype.slice.call(arguments),t=e[e.length-1],r=e.slice(0,e.length-1),n=0;n<r.length;n++)if(this["bb:viewhints"]&&this["bb:viewhints"].indexOf(r[n])>=0)return t.fn(this);return t.inverse(this)}},module.exports=HandlebarsPreprocessor},{"../../../core/logger-factory":67,"../../../core/widget-error":72,"handlebars/dist/handlebars.min":5}],85:[function(e,t,r){"use strict";function n(){this.initilized=!1}var i=e("q"),o={};t.exports=function(){return new n},n.prototype._init=function(){this.initilized||(this.head=document.getElementsByTagName("head")[0]||document.documentElement,this.asyncSupported="undefined"!=typeof document.createElement("script").async,this.initilized=!0)},n.prototype.loadScripts=function(e){return e instanceof Array||(e=[e]),this._init(),this.asyncSupported?this._loadScriptsASync(e):this._loadScriptsSync(e)},n.prototype._loadScriptsASync=function(e){var t=this,r=[];return e.forEach(function(e){if(!o[e]){var n=document.createElement("script");n.src=e,n.async=!1,o[e]=i.Promise(function(t){n.onload=function(){t(e)}}),t.head.insertBefore(n,t.head.firstChild)}r.push(o[e])}),e.length?i.all(r):i.Promise.resolve()},n.prototype._loadScriptsSync=function(e){function t(e){if(!o[e]){var t=document.createElement("script");t.src=e,o[e]=i.Promise(function(r){var n=!1;t.onload=t.onreadystatechange=function(){n||this.readyState&&"loaded"!==this.readyState&&"complete"!==this.readyState||(n=!0,r(e))}}),n.head.insertBefore(t,n.head.firstChild)}return o[e]}function r(n){var i=t(e[n]);return n++,e[n]?i.then(function(){return r(n)}):i}var n=this;return e.length?r(0):i.Promise.resolve()},n.prototype.loadCss=function(e){e instanceof Array||(e=[e]),this._init();var t=this,r=t.head,n=[];return e.forEach(function(e){if(o[e])n.push(o[e]);else{var t=document.createElement("link");t.setAttribute("rel","stylesheet"),t.setAttribute("type","text/css"),t.setAttribute("href",e);var s=i.Promise.resolve(e);o[e]=s,n.push(s);var a=Array.prototype.slice.call(r.getElementsByTagName("link")).filter(function(e){return"stylesheet"===e.rel});if(a.length){var c=a.pop();c.parentNode.insertBefore(t,c.nextSibling)}else r.insertBefore(t,r.firstChild)}}),i.all(n)},n.prototype._clearCache=function(){o={}}},{q:223}],86:[function(e,t,r){"use strict";function n(){i.call(this,window.localStorage)}var i=e("./web-storage-decorator");n.prototype=Object.create(i.prototype),t.exports=n},{"./web-storage-decorator":88}],87:[function(e,t,r){"use strict";function n(e){this.type=e}var i=e("../../core/util");n.prototype.initStorageEvent=function(e,t,r,n,i,o,s,a){this.type=e,this.canBubble=t,this.cancellable=r,this.key=n,this.oldValue=i,this.newValue=o,this.url=s,this.storageArea=a},n.prototype.toString=function(){return i.format("[object StorageEvent] (key=%s, oldValue=%s, newValue=%s, url=%s)",this.key,this.oldValue,this.newValue,this.url)},t.exports=n},{"../../core/util":69}],88:[function(e,t,r){(function(r){"use strict";function n(e,t){this._items=[],this._storage=e,this._eventTarget=t||null,this._prefix="",this._eventsEnabled=!1;var r=this;Object.defineProperty(this,"length",{enumerable:!1,configurable:!1,get:function(){return Object.keys(r._items).length}}),this.log=i.getLogger()}var i=e("../../core/logger-factory"),o=e("browser-bunyan"),s=e("../../core/widget-storage"),a=e("../../core/widget-error"),c=e("./storage-event"),u=e("../../core/util");n.prototype=Object.create(s.prototype),n.prototype.init=function(e,t){var r=this,n=this.log;this._prefix=e||"",n.debug("Initializing preference storage for widget [%s]",e),n.debug("Using internal storage [%s]",this._storage.toString()),n.level()<=o.TRACE&&n.trace("Initializing storage with the following preferences:\n %s",JSON.stringify(t)),t&&(this._items=t.map(function(e){return r.defineItem(e)})),this._eventsEnabled=!0},n.prototype.getItem=function(e){var t=this._storage.getItem(this._prefix+e);if("undefined"==typeof t||null===t){var r=this._getItemDefinition(e)||null;t=r?r.value:null}return"undefined"==typeof t&&(t=null),this.log.trace("Getting preference [%s=%s]",e,t),t},n.prototype.defineItem=function(e){var t=this,r=e.name;this._items.push(e);var n={enumerable:!0,configurable:!0,get:function(){return t.getItem(r)},set:function(e){return t.setItem(t._prefix+r,e)}};return Object.defineProperty(this,r,n),e},n.prototype.setItem=function(e,t){var r=this._getItemDefinition(e);if(r&&r.readonly){var n=u.format("Attempted to set readonly preference [%s=%s]",e,t);throw this.log.warn(n),new a(n)}return this.log.debug("Setting preference to storage [%s=%s]",e,t),null===t?this.removeItem(e):(this._notify(e,this.getItem(e),t),this._storage.setItem(this._prefix+e,t))},n.prototype.removeItem=function(e){return this._notify(e,this.getItem(e),null),this.log.debug("Removing preference from storage [%s]",e),this._storage.removeItem(this._prefix+e)},n.prototype.clear=function(){var e=this;this._notify(null,null,null),this.log.debug("Clearing preferences"),this._eventsEnabled=!1,Object.keys(this._storage).filter(function(t){return 0===t.indexOf(e._prefix)}).forEach(function(t){e.removeItem(t.substr(e.prefix.length))}),this._eventsEnabled=!0},n.prototype.key=function(e){var t=this,r=Object.keys(this._storage).filter(function(e){return 0===e.indexOf(t._prefix)}).length,n=r.length;return e>=n?null:r[e]},n.prototype.keys=function(){var e=this,t=Object.keys(this._storage).filter(function(t){return 0===t.indexOf(e._prefix)});return 0===t.length?[]:t.map(function(t){return t.slice(e._prefix.length)})},n.prototype._getItemDefinition=function(e){var t=this._items.filter(function(t){return e===t.name})[0];return t||null},n.prototype._notify=function(e,t,n){if(this._eventsEnabled&&this._eventTarget){if("function"!=typeof this._eventTarget.dispatchEvent){var i="Cannot dispatch StorageEvent for preferences. An event target was provided, but it does not implement the EventTarget interface. [%s, %s, %s]";return void this.log.warn(i,e,t,n)}var s=this,a=new c("storage");a.initStorageEvent("storage",!1,!1,e,t,n,this._prefix,this),r.nextTick(function(){s.log.level()<=o.DEBUG&&s.log.debug("Sending StorageEvent [%s] ",a),s._eventTarget.dispatchEvent(a)})}},t.exports=n}).call(this,e("_process"))},{"../../core/logger-factory":67,"../../core/util":69,"../../core/widget-error":72,"../../core/widget-storage":76,"./storage-event":87,_process:92,"browser-bunyan":2}],89:[function(e,t,r){},{}],90:[function(e,t,r){function n(){this._events=this._events||{},this._maxListeners=this._maxListeners||void 0}function i(e){return"function"==typeof e}function o(e){return"number"==typeof e}function s(e){return"object"==typeof e&&null!==e}function a(e){return void 0===e}t.exports=n,n.EventEmitter=n,n.prototype._events=void 0,n.prototype._maxListeners=void 0,n.defaultMaxListeners=10,n.prototype.setMaxListeners=function(e){if(!o(e)||0>e||isNaN(e))throw TypeError("n must be a positive number");return this._maxListeners=e,this},n.prototype.emit=function(e){var t,r,n,o,c,u;if(this._events||(this._events={}),"error"===e&&(!this._events.error||s(this._events.error)&&!this._events.error.length)){if(t=arguments[1],t instanceof Error)throw t;throw TypeError('Uncaught, unspecified "error" event.')}if(r=this._events[e],a(r))return!1;if(i(r))switch(arguments.length){case 1:r.call(this);break;case 2:r.call(this,arguments[1]);break;case 3:r.call(this,arguments[1],arguments[2]);break;default:for(n=arguments.length,o=new Array(n-1),c=1;n>c;c++)o[c-1]=arguments[c];r.apply(this,o)}else if(s(r)){for(n=arguments.length,o=new Array(n-1),c=1;n>c;c++)o[c-1]=arguments[c];for(u=r.slice(),n=u.length,c=0;n>c;c++)u[c].apply(this,o)}return!0},n.prototype.addListener=function(e,t){var r;if(!i(t))throw TypeError("listener must be a function");if(this._events||(this._events={}),this._events.newListener&&this.emit("newListener",e,i(t.listener)?t.listener:t),this._events[e]?s(this._events[e])?this._events[e].push(t):this._events[e]=[this._events[e],t]:this._events[e]=t,s(this._events[e])&&!this._events[e].warned){var r;r=a(this._maxListeners)?n.defaultMaxListeners:this._maxListeners,r&&r>0&&this._events[e].length>r&&(this._events[e].warned=!0,console.error("(node) warning: possible EventEmitter memory leak detected. %d listeners added. Use emitter.setMaxListeners() to increase limit.",this._events[e].length),"function"==typeof console.trace&&console.trace())}return this},n.prototype.on=n.prototype.addListener,n.prototype.once=function(e,t){function r(){this.removeListener(e,r),n||(n=!0,t.apply(this,arguments))}if(!i(t))throw TypeError("listener must be a function");var n=!1;return r.listener=t,this.on(e,r),this},n.prototype.removeListener=function(e,t){var r,n,o,a;if(!i(t))throw TypeError("listener must be a function");if(!this._events||!this._events[e])return this;if(r=this._events[e],o=r.length,n=-1,r===t||i(r.listener)&&r.listener===t)delete this._events[e],this._events.removeListener&&this.emit("removeListener",e,t);else if(s(r)){for(a=o;a-- >0;)if(r[a]===t||r[a].listener&&r[a].listener===t){n=a;break}if(0>n)return this;1===r.length?(r.length=0,delete this._events[e]):r.splice(n,1),this._events.removeListener&&this.emit("removeListener",e,t)}return this},n.prototype.removeAllListeners=function(e){var t,r;if(!this._events)return this;if(!this._events.removeListener)return 0===arguments.length?this._events={}:this._events[e]&&delete this._events[e],this;if(0===arguments.length){for(t in this._events)"removeListener"!==t&&this.removeAllListeners(t);return this.removeAllListeners("removeListener"),this._events={},this}if(r=this._events[e],i(r))this.removeListener(e,r);else for(;r.length;)this.removeListener(e,r[r.length-1]);return delete this._events[e],this},n.prototype.listeners=function(e){var t;return t=this._events&&this._events[e]?i(this._events[e])?[this._events[e]]:this._events[e].slice():[]},n.listenerCount=function(e,t){var r;return r=e._events&&e._events[t]?i(e._events[t])?1:e._events[t].length:0}},{}],91:[function(e,t,r){"function"==typeof Object.create?t.exports=function(e,t){e.super_=t,e.prototype=Object.create(t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}})}:t.exports=function(e,t){e.super_=t;var r=function(){};r.prototype=t.prototype,e.prototype=new r,e.prototype.constructor=e}},{}],92:[function(e,t,r){function n(){l=!1,a.length?u=a.concat(u):p=-1,u.length&&i()}function i(){if(!l){var e=setTimeout(n);l=!0;for(var t=u.length;t;){for(a=u,u=[];++p<t;)a&&a[p].run();p=-1,t=u.length}a=null,l=!1,clearTimeout(e)}}function o(e,t){this.fun=e,this.array=t}function s(){}var a,c=t.exports={},u=[],l=!1,p=-1;c.nextTick=function(e){var t=new Array(arguments.length-1);if(arguments.length>1)for(var r=1;r<arguments.length;r++)t[r-1]=arguments[r];u.push(new o(e,t)),1!==u.length||l||setTimeout(i,0)},o.prototype.run=function(){this.fun.apply(null,this.array)},c.title="browser",c.browser=!0,c.env={},c.argv=[],c.version="",c.versions={},c.on=s,c.addListener=s,c.once=s,c.off=s,c.removeListener=s,c.removeAllListeners=s,c.emit=s,c.binding=function(e){throw new Error("process.binding is not supported")},c.cwd=function(){return"/"},c.chdir=function(e){throw new Error("process.chdir is not supported")},c.umask=function(){return 0}},{}],93:[function(e,t,r){(function(e){!function(n){function i(e){throw new RangeError(L[e])}function o(e,t){for(var r=e.length,n=[];r--;)n[r]=t(e[r]);return n}function s(e,t){var r=e.split("@"),n="";r.length>1&&(n=r[0]+"@",e=r[1]),e=e.replace(R,".");var i=e.split("."),s=o(i,t).join(".");return n+s}function a(e){for(var t,r,n=[],i=0,o=e.length;o>i;)t=e.charCodeAt(i++),t>=55296&&56319>=t&&o>i?(r=e.charCodeAt(i++),56320==(64512&r)?n.push(((1023&t)<<10)+(1023&r)+65536):(n.push(t),i--)):n.push(t);return n}function c(e){return o(e,function(e){var t="";return e>65535&&(e-=65536,t+=M(e>>>10&1023|55296),e=56320|1023&e),t+=M(e)}).join("")}function u(e){return 10>e-48?e-22:26>e-65?e-65:26>e-97?e-97:x}function l(e,t){return e+22+75*(26>e)-((0!=t)<<5)}function p(e,t,r){var n=0;for(e=r?C(e/A):e>>1,e+=C(e/t);e>j*k>>1;n+=x)e=C(e/j);return C(n+(j+1)*e/(e+S))}function h(e){var t,r,n,o,s,a,l,h,f,d,g=[],m=e.length,v=0,y=P,b=T;for(r=e.lastIndexOf(N),0>r&&(r=0),n=0;r>n;++n)e.charCodeAt(n)>=128&&i("not-basic"),g.push(e.charCodeAt(n));for(o=r>0?r+1:0;m>o;){for(s=v,a=1,l=x;o>=m&&i("invalid-input"),h=u(e.charCodeAt(o++)),(h>=x||h>C((E-v)/a))&&i("overflow"),v+=h*a,f=b>=l?_:l>=b+k?k:l-b,!(f>h);l+=x)d=x-f,a>C(E/d)&&i("overflow"),a*=d;t=g.length+1,b=p(v-s,t,0==s),C(v/t)>E-y&&i("overflow"),y+=C(v/t),v%=t,g.splice(v++,0,y)}return c(g)}function f(e){var t,r,n,o,s,c,u,h,f,d,g,m,v,y,b,w=[];for(e=a(e),m=e.length,t=P,r=0,s=T,c=0;m>c;++c)g=e[c],128>g&&w.push(M(g));for(n=o=w.length,o&&w.push(N);m>n;){for(u=E,c=0;m>c;++c)g=e[c],g>=t&&u>g&&(u=g);for(v=n+1,u-t>C((E-r)/v)&&i("overflow"),r+=(u-t)*v,t=u,c=0;m>c;++c)if(g=e[c],t>g&&++r>E&&i("overflow"),g==t){for(h=r,f=x;d=s>=f?_:f>=s+k?k:f-s,!(d>h);f+=x)b=h-d,y=x-d,w.push(M(l(d+b%y,0))),h=C(b/y);w.push(M(l(h,0))),s=p(r,v,n==o),r=0,++n}++r,++t}return w.join("")}function d(e){return s(e,function(e){return I.test(e)?h(e.slice(4).toLowerCase()):e})}function g(e){return s(e,function(e){return O.test(e)?"xn--"+f(e):e})}var m="object"==typeof r&&r&&!r.nodeType&&r,v="object"==typeof t&&t&&!t.nodeType&&t,y="object"==typeof e&&e;(y.global===y||y.window===y||y.self===y)&&(n=y);var b,w,E=2147483647,x=36,_=1,k=26,S=38,A=700,T=72,P=128,N="-",I=/^xn--/,O=/[^\x20-\x7E]/,R=/[\x2E\u3002\uFF0E\uFF61]/g,L={overflow:"Overflow: input needs wider integers to process","not-basic":"Illegal input >= 0x80 (not a basic code point)","invalid-input":"Invalid input"},j=x-_,C=Math.floor,M=String.fromCharCode;if(b={version:"1.3.2",ucs2:{decode:a,encode:c},decode:h,encode:f,toASCII:g,toUnicode:d},"function"==typeof define&&"object"==typeof define.amd&&define.amd)define("punycode",function(){return b});else if(m&&v)if(t.exports==m)v.exports=b;else for(w in b)b.hasOwnProperty(w)&&(m[w]=b[w]);else n.punycode=b}(this)}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],94:[function(e,t,r){"use strict";function n(e,t){return Object.prototype.hasOwnProperty.call(e,t)}t.exports=function(e,t,r,o){t=t||"&",r=r||"=";var s={};if("string"!=typeof e||0===e.length)return s;var a=/\+/g;e=e.split(t);var c=1e3;o&&"number"==typeof o.maxKeys&&(c=o.maxKeys);var u=e.length;c>0&&u>c&&(u=c);for(var l=0;u>l;++l){var p,h,f,d,g=e[l].replace(a,"%20"),m=g.indexOf(r);m>=0?(p=g.substr(0,m),h=g.substr(m+1)):(p=g,h=""),f=decodeURIComponent(p),d=decodeURIComponent(h),n(s,f)?i(s[f])?s[f].push(d):s[f]=[s[f],d]:s[f]=d}return s};var i=Array.isArray||function(e){return"[object Array]"===Object.prototype.toString.call(e)}},{}],95:[function(e,t,r){"use strict";function n(e,t){if(e.map)return e.map(t);for(var r=[],n=0;n<e.length;n++)r.push(t(e[n],n));return r}var i=function(e){switch(typeof e){case"string":return e;case"boolean":return e?"true":"false";case"number":return isFinite(e)?e:"";default:return""}};t.exports=function(e,t,r,a){return t=t||"&",r=r||"=",null===e&&(e=void 0),"object"==typeof e?n(s(e),function(s){var a=encodeURIComponent(i(s))+r;return o(e[s])?n(e[s],function(e){return a+encodeURIComponent(i(e))}).join(t):a+encodeURIComponent(i(e[s]))}).join(t):a?encodeURIComponent(i(a))+r+encodeURIComponent(i(e)):""};var o=Array.isArray||function(e){return"[object Array]"===Object.prototype.toString.call(e)},s=Object.keys||function(e){var t=[];for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.push(r);return t}},{}],96:[function(e,t,r){"use strict";r.decode=r.parse=e("./decode"),r.encode=r.stringify=e("./encode")},{"./decode":94,"./encode":95}],97:[function(e,t,r){function n(){this.protocol=null,this.slashes=null,this.auth=null,this.host=null,this.port=null,this.hostname=null,this.hash=null,this.search=null,this.query=null,this.pathname=null,this.path=null,this.href=null}function i(e,t,r){if(e&&u(e)&&e instanceof n)return e;var i=new n;return i.parse(e,t,r),i}function o(e){return c(e)&&(e=i(e)),e instanceof n?e.format():n.prototype.format.call(e)}function s(e,t){return i(e,!1,!0).resolve(t)}function a(e,t){return e?i(e,!1,!0).resolveObject(t):t}function c(e){return"string"==typeof e}function u(e){return"object"==typeof e&&null!==e}function l(e){return null===e}function p(e){return null==e}var h=e("punycode");r.parse=i,r.resolve=s,r.resolveObject=a,r.format=o,r.Url=n;var f=/^([a-z0-9.+-]+:)/i,d=/:[0-9]*$/,g=["<",">",'"',"`"," ","\r","\n","	"],m=["{","}","|","\\","^","`"].concat(g),v=["'"].concat(m),y=["%","/","?",";","#"].concat(v),b=["/","?","#"],w=255,E=/^[a-z0-9A-Z_-]{0,63}$/,x=/^([a-z0-9A-Z_-]{0,63})(.*)$/,_={javascript:!0,"javascript:":!0},k={javascript:!0,"javascript:":!0},S={http:!0,https:!0,ftp:!0,gopher:!0,file:!0,"http:":!0,"https:":!0,"ftp:":!0,"gopher:":!0,"file:":!0},A=e("querystring");n.prototype.parse=function(e,t,r){if(!c(e))throw new TypeError("Parameter 'url' must be a string, not "+typeof e);var n=e;n=n.trim();var i=f.exec(n);if(i){i=i[0];var o=i.toLowerCase();this.protocol=o,n=n.substr(i.length)}if(r||i||n.match(/^\/\/[^@\/]+@[^@\/]+/)){var s="//"===n.substr(0,2);!s||i&&k[i]||(n=n.substr(2),this.slashes=!0)}if(!k[i]&&(s||i&&!S[i])){for(var a=-1,u=0;u<b.length;u++){var l=n.indexOf(b[u]);-1!==l&&(-1===a||a>l)&&(a=l)}var p,d;d=-1===a?n.lastIndexOf("@"):n.lastIndexOf("@",a),-1!==d&&(p=n.slice(0,d),n=n.slice(d+1),this.auth=decodeURIComponent(p)),a=-1;for(var u=0;u<y.length;u++){var l=n.indexOf(y[u]);-1!==l&&(-1===a||a>l)&&(a=l)}-1===a&&(a=n.length),this.host=n.slice(0,a),n=n.slice(a),this.parseHost(),this.hostname=this.hostname||"";var g="["===this.hostname[0]&&"]"===this.hostname[this.hostname.length-1];if(!g)for(var m=this.hostname.split(/\./),u=0,T=m.length;T>u;u++){var P=m[u];if(P&&!P.match(E)){for(var N="",I=0,O=P.length;O>I;I++)N+=P.charCodeAt(I)>127?"x":P[I];if(!N.match(E)){var R=m.slice(0,u),L=m.slice(u+1),j=P.match(x);j&&(R.push(j[1]),L.unshift(j[2])),L.length&&(n="/"+L.join(".")+n),this.hostname=R.join(".");break}}}if(this.hostname.length>w?this.hostname="":this.hostname=this.hostname.toLowerCase(),!g){for(var C=this.hostname.split("."),M=[],u=0;u<C.length;++u){var U=C[u];M.push(U.match(/[^A-Za-z0-9_-]/)?"xn--"+h.encode(U):U)}this.hostname=M.join(".")}var F=this.port?":"+this.port:"",D=this.hostname||"";this.host=D+F,this.href+=this.host,g&&(this.hostname=this.hostname.substr(1,this.hostname.length-2),"/"!==n[0]&&(n="/"+n))}if(!_[o])for(var u=0,T=v.length;T>u;u++){var B=v[u],H=encodeURIComponent(B);H===B&&(H=escape(B)),n=n.split(B).join(H)}var W=n.indexOf("#");-1!==W&&(this.hash=n.substr(W),n=n.slice(0,W));var q=n.indexOf("?");if(-1!==q?(this.search=n.substr(q),this.query=n.substr(q+1),t&&(this.query=A.parse(this.query)),n=n.slice(0,q)):t&&(this.search="",this.query={}),n&&(this.pathname=n),S[o]&&this.hostname&&!this.pathname&&(this.pathname="/"),this.pathname||this.search){var F=this.pathname||"",U=this.search||"";this.path=F+U}return this.href=this.format(),this},n.prototype.format=function(){var e=this.auth||"";e&&(e=encodeURIComponent(e),e=e.replace(/%3A/i,":"),e+="@");var t=this.protocol||"",r=this.pathname||"",n=this.hash||"",i=!1,o="";this.host?i=e+this.host:this.hostname&&(i=e+(-1===this.hostname.indexOf(":")?this.hostname:"["+this.hostname+"]"),this.port&&(i+=":"+this.port)),this.query&&u(this.query)&&Object.keys(this.query).length&&(o=A.stringify(this.query));var s=this.search||o&&"?"+o||"";return t&&":"!==t.substr(-1)&&(t+=":"),this.slashes||(!t||S[t])&&i!==!1?(i="//"+(i||""),r&&"/"!==r.charAt(0)&&(r="/"+r)):i||(i=""),n&&"#"!==n.charAt(0)&&(n="#"+n),s&&"?"!==s.charAt(0)&&(s="?"+s),r=r.replace(/[?#]/g,function(e){return encodeURIComponent(e)}),s=s.replace("#","%23"),t+i+r+s+n},n.prototype.resolve=function(e){return this.resolveObject(i(e,!1,!0)).format()},n.prototype.resolveObject=function(e){if(c(e)){var t=new n;t.parse(e,!1,!0),e=t}var r=new n;if(Object.keys(this).forEach(function(e){r[e]=this[e]},this),r.hash=e.hash,""===e.href)return r.href=r.format(),r;if(e.slashes&&!e.protocol)return Object.keys(e).forEach(function(t){"protocol"!==t&&(r[t]=e[t])}),S[r.protocol]&&r.hostname&&!r.pathname&&(r.path=r.pathname="/"),r.href=r.format(),r;if(e.protocol&&e.protocol!==r.protocol){if(!S[e.protocol])return Object.keys(e).forEach(function(t){r[t]=e[t]}),r.href=r.format(),r;if(r.protocol=e.protocol,e.host||k[e.protocol])r.pathname=e.pathname;else{for(var i=(e.pathname||"").split("/");i.length&&!(e.host=i.shift()););e.host||(e.host=""),e.hostname||(e.hostname=""),""!==i[0]&&i.unshift(""),i.length<2&&i.unshift(""),r.pathname=i.join("/")}if(r.search=e.search,r.query=e.query,r.host=e.host||"",r.auth=e.auth,r.hostname=e.hostname||e.host,r.port=e.port,r.pathname||r.search){var o=r.pathname||"",s=r.search||"";r.path=o+s}return r.slashes=r.slashes||e.slashes,r.href=r.format(),r}var a=r.pathname&&"/"===r.pathname.charAt(0),u=e.host||e.pathname&&"/"===e.pathname.charAt(0),h=u||a||r.host&&e.pathname,f=h,d=r.pathname&&r.pathname.split("/")||[],i=e.pathname&&e.pathname.split("/")||[],g=r.protocol&&!S[r.protocol];if(g&&(r.hostname="",r.port=null,r.host&&(""===d[0]?d[0]=r.host:d.unshift(r.host)),r.host="",e.protocol&&(e.hostname=null,e.port=null,e.host&&(""===i[0]?i[0]=e.host:i.unshift(e.host)),e.host=null),h=h&&(""===i[0]||""===d[0])),u)r.host=e.host||""===e.host?e.host:r.host,r.hostname=e.hostname||""===e.hostname?e.hostname:r.hostname,r.search=e.search,r.query=e.query,d=i;else if(i.length)d||(d=[]),d.pop(),d=d.concat(i),r.search=e.search,r.query=e.query;else if(!p(e.search)){if(g){r.hostname=r.host=d.shift();var m=r.host&&r.host.indexOf("@")>0?r.host.split("@"):!1;m&&(r.auth=m.shift(),r.host=r.hostname=m.shift())}return r.search=e.search,r.query=e.query,l(r.pathname)&&l(r.search)||(r.path=(r.pathname?r.pathname:"")+(r.search?r.search:"")),r.href=r.format(),r}if(!d.length)return r.pathname=null,r.search?r.path="/"+r.search:r.path=null,r.href=r.format(),r;for(var v=d.slice(-1)[0],y=(r.host||e.host)&&("."===v||".."===v)||""===v,b=0,w=d.length;w>=0;w--)v=d[w],"."==v?d.splice(w,1):".."===v?(d.splice(w,1),b++):b&&(d.splice(w,1),b--);if(!h&&!f)for(;b--;b)d.unshift("..");!h||""===d[0]||d[0]&&"/"===d[0].charAt(0)||d.unshift(""),y&&"/"!==d.join("/").substr(-1)&&d.push("");var E=""===d[0]||d[0]&&"/"===d[0].charAt(0);if(g){r.hostname=r.host=E?"":d.length?d.shift():"";var m=r.host&&r.host.indexOf("@")>0?r.host.split("@"):!1;m&&(r.auth=m.shift(),r.host=r.hostname=m.shift())}return h=h||r.host&&d.length,h&&!E&&d.unshift(""),d.length?r.pathname=d.join("/"):(r.pathname=null,r.path=null),l(r.pathname)&&l(r.search)||(r.path=(r.pathname?r.pathname:"")+(r.search?r.search:"")),r.auth=e.auth||r.auth,r.slashes=r.slashes||e.slashes,r.href=r.format(),r},n.prototype.parseHost=function(){var e=this.host,t=d.exec(e);t&&(t=t[0],":"!==t&&(this.port=t.substr(1)),e=e.substr(0,e.length-t.length)),e&&(this.hostname=e)}},{punycode:93,querystring:96}],98:[function(e,t,r){t.exports=function(e){return e&&"object"==typeof e&&"function"==typeof e.copy&&"function"==typeof e.fill&&"function"==typeof e.readUInt8}},{}],99:[function(e,t,r){(function(t,n){function i(e,t){var n={seen:[],stylize:s};return arguments.length>=3&&(n.depth=arguments[2]),arguments.length>=4&&(n.colors=arguments[3]),g(t)?n.showHidden=t:t&&r._extend(n,t),E(n.showHidden)&&(n.showHidden=!1),E(n.depth)&&(n.depth=2),E(n.colors)&&(n.colors=!1),E(n.customInspect)&&(n.customInspect=!0),n.colors&&(n.stylize=o),c(n,e,n.depth)}function o(e,t){var r=i.styles[t];return r?"["+i.colors[r][0]+"m"+e+"["+i.colors[r][1]+"m":e}function s(e,t){return e}function a(e){var t={};return e.forEach(function(e,r){t[e]=!0}),t}function c(e,t,n){if(e.customInspect&&t&&A(t.inspect)&&t.inspect!==r.inspect&&(!t.constructor||t.constructor.prototype!==t)){var i=t.inspect(n,e);return b(i)||(i=c(e,i,n)),i}var o=u(e,t);if(o)return o;var s=Object.keys(t),g=a(s);if(e.showHidden&&(s=Object.getOwnPropertyNames(t)),S(t)&&(s.indexOf("message")>=0||s.indexOf("description")>=0))return l(t);if(0===s.length){if(A(t)){var m=t.name?": "+t.name:"";return e.stylize("[Function"+m+"]","special")}if(x(t))return e.stylize(RegExp.prototype.toString.call(t),"regexp");if(k(t))return e.stylize(Date.prototype.toString.call(t),"date");if(S(t))return l(t)}var v="",y=!1,w=["{","}"];if(d(t)&&(y=!0,w=["[","]"]),A(t)){var E=t.name?": "+t.name:"";v=" [Function"+E+"]"}if(x(t)&&(v=" "+RegExp.prototype.toString.call(t)),k(t)&&(v=" "+Date.prototype.toUTCString.call(t)),S(t)&&(v=" "+l(t)),0===s.length&&(!y||0==t.length))return w[0]+v+w[1];if(0>n)return x(t)?e.stylize(RegExp.prototype.toString.call(t),"regexp"):e.stylize("[Object]","special");e.seen.push(t);var _;return _=y?p(e,t,n,g,s):s.map(function(r){return h(e,t,n,g,r,y)}),e.seen.pop(),f(_,v,w)}function u(e,t){if(E(t))return e.stylize("undefined","undefined");if(b(t)){var r="'"+JSON.stringify(t).replace(/^"|"$/g,"").replace(/'/g,"\\'").replace(/\\"/g,'"')+"'";return e.stylize(r,"string")}return y(t)?e.stylize(""+t,"number"):g(t)?e.stylize(""+t,"boolean"):m(t)?e.stylize("null","null"):void 0;
}function l(e){return"["+Error.prototype.toString.call(e)+"]"}function p(e,t,r,n,i){for(var o=[],s=0,a=t.length;a>s;++s)O(t,String(s))?o.push(h(e,t,r,n,String(s),!0)):o.push("");return i.forEach(function(i){i.match(/^\d+$/)||o.push(h(e,t,r,n,i,!0))}),o}function h(e,t,r,n,i,o){var s,a,u;if(u=Object.getOwnPropertyDescriptor(t,i)||{value:t[i]},u.get?a=u.set?e.stylize("[Getter/Setter]","special"):e.stylize("[Getter]","special"):u.set&&(a=e.stylize("[Setter]","special")),O(n,i)||(s="["+i+"]"),a||(e.seen.indexOf(u.value)<0?(a=m(r)?c(e,u.value,null):c(e,u.value,r-1),a.indexOf("\n")>-1&&(a=o?a.split("\n").map(function(e){return"  "+e}).join("\n").substr(2):"\n"+a.split("\n").map(function(e){return"   "+e}).join("\n"))):a=e.stylize("[Circular]","special")),E(s)){if(o&&i.match(/^\d+$/))return a;s=JSON.stringify(""+i),s.match(/^"([a-zA-Z_][a-zA-Z_0-9]*)"$/)?(s=s.substr(1,s.length-2),s=e.stylize(s,"name")):(s=s.replace(/'/g,"\\'").replace(/\\"/g,'"').replace(/(^"|"$)/g,"'"),s=e.stylize(s,"string"))}return s+": "+a}function f(e,t,r){var n=0,i=e.reduce(function(e,t){return n++,t.indexOf("\n")>=0&&n++,e+t.replace(/\u001b\[\d\d?m/g,"").length+1},0);return i>60?r[0]+(""===t?"":t+"\n ")+" "+e.join(",\n  ")+" "+r[1]:r[0]+t+" "+e.join(", ")+" "+r[1]}function d(e){return Array.isArray(e)}function g(e){return"boolean"==typeof e}function m(e){return null===e}function v(e){return null==e}function y(e){return"number"==typeof e}function b(e){return"string"==typeof e}function w(e){return"symbol"==typeof e}function E(e){return void 0===e}function x(e){return _(e)&&"[object RegExp]"===P(e)}function _(e){return"object"==typeof e&&null!==e}function k(e){return _(e)&&"[object Date]"===P(e)}function S(e){return _(e)&&("[object Error]"===P(e)||e instanceof Error)}function A(e){return"function"==typeof e}function T(e){return null===e||"boolean"==typeof e||"number"==typeof e||"string"==typeof e||"symbol"==typeof e||"undefined"==typeof e}function P(e){return Object.prototype.toString.call(e)}function N(e){return 10>e?"0"+e.toString(10):e.toString(10)}function I(){var e=new Date,t=[N(e.getHours()),N(e.getMinutes()),N(e.getSeconds())].join(":");return[e.getDate(),C[e.getMonth()],t].join(" ")}function O(e,t){return Object.prototype.hasOwnProperty.call(e,t)}var R=/%[sdj%]/g;r.format=function(e){if(!b(e)){for(var t=[],r=0;r<arguments.length;r++)t.push(i(arguments[r]));return t.join(" ")}for(var r=1,n=arguments,o=n.length,s=String(e).replace(R,function(e){if("%%"===e)return"%";if(r>=o)return e;switch(e){case"%s":return String(n[r++]);case"%d":return Number(n[r++]);case"%j":try{return JSON.stringify(n[r++])}catch(t){return"[Circular]"}default:return e}}),a=n[r];o>r;a=n[++r])s+=m(a)||!_(a)?" "+a:" "+i(a);return s},r.deprecate=function(e,i){function o(){if(!s){if(t.throwDeprecation)throw new Error(i);t.traceDeprecation?console.trace(i):console.error(i),s=!0}return e.apply(this,arguments)}if(E(n.process))return function(){return r.deprecate(e,i).apply(this,arguments)};if(t.noDeprecation===!0)return e;var s=!1;return o};var L,j={};r.debuglog=function(e){if(E(L)&&(L=t.env.NODE_DEBUG||""),e=e.toUpperCase(),!j[e])if(new RegExp("\\b"+e+"\\b","i").test(L)){var n=t.pid;j[e]=function(){var t=r.format.apply(r,arguments);console.error("%s %d: %s",e,n,t)}}else j[e]=function(){};return j[e]},r.inspect=i,i.colors={bold:[1,22],italic:[3,23],underline:[4,24],inverse:[7,27],white:[37,39],grey:[90,39],black:[30,39],blue:[34,39],cyan:[36,39],green:[32,39],magenta:[35,39],red:[31,39],yellow:[33,39]},i.styles={special:"cyan",number:"yellow","boolean":"yellow",undefined:"grey","null":"bold",string:"green",date:"magenta",regexp:"red"},r.isArray=d,r.isBoolean=g,r.isNull=m,r.isNullOrUndefined=v,r.isNumber=y,r.isString=b,r.isSymbol=w,r.isUndefined=E,r.isRegExp=x,r.isObject=_,r.isDate=k,r.isError=S,r.isFunction=A,r.isPrimitive=T,r.isBuffer=e("./support/isBuffer");var C=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"];r.log=function(){console.log("%s - %s",I(),r.format.apply(r,arguments))},r.inherits=e("inherits"),r._extend=function(e,t){if(!t||!_(t))return e;for(var r=Object.keys(t),n=r.length;n--;)e[r[n]]=t[r[n]];return e}}).call(this,e("_process"),"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"./support/isBuffer":98,_process:92,inherits:91}],100:[function(e,t,r){arguments[4][3][0].apply(r,arguments)},{dup:3}],101:[function(e,t,r){arguments[4][63][0].apply(r,arguments)},{"./default-widget-model":104,"./logger-factory":106,"./util":108,"browser-bunyan":135,dup:63}],102:[function(e,t,r){arguments[4][64][0].apply(r,arguments)},{dup:64}],103:[function(e,t,r){arguments[4][65][0].apply(r,arguments)},{dup:65}],104:[function(e,t,r){arguments[4][66][0].apply(r,arguments)},{dup:66}],105:[function(e,t,r){"use strict";var n=["ar","iw","he","dv","ha","fa","ps","ur","yi","ji"];t.exports={defaultLocale:"en",getDirection:function(e){return n.indexOf(e)>=0?"rtl":"ltr"}}},{}],106:[function(e,t,r){arguments[4][67][0].apply(r,arguments)},{"./util":108,"browser-bunyan":135,dup:67}],107:[function(e,t,r){arguments[4][68][0].apply(r,arguments)},{"./logger-factory":106,"./widget-renderer":114,dup:68,q:223}],108:[function(e,t,r){arguments[4][69][0].apply(r,arguments)},{dup:69,"lodash/lang/cloneDeep":179,"lodash/lang/isArray":181,"lodash/object/merge":190,"lodash/object/omit":191,"lodash/string/endsWith":192,"lodash/string/startsWith":193}],109:[function(e,t,r){"use strict";var n=e("q"),i=e("./util"),o=e("./logger-factory"),s=e("./widget-renderer"),a=e("./config-reader"),c=e("./config-parser"),u=e("./widget-storage"),l=e("./widget-instance-factory"),p=e("./widget-feature-augmenter"),h=e("./config-aggregator"),f=e("./widget-error"),d={POST_READ:"postRead",PRE_RENDER:"preRender",POST_RENDER:"postRender"},g={html:"text/html",hbs:"text/x-handlebars-template",handlebars:"text/x-handlebars-template",soy:"text/x-soy"},m=function(e){this.config=e,this.locale=this.config.locale||null,this.plugins=[],this.features=[],this.widgetInstanceFactory=new l,this.widgetFeatureAugmenter=new p,this.log=o.getLogger();var t=v(this.config);if(t.warnings.length&&this.log.warn(t.warnings.join("\n")),t.errors.length){var r="Problems with widget config:\n	"+t.errors.join("	\n");throw new f(r)}};m.prototype.start=function(){var e=(new Date).getTime(),t=this.log,r=this.config,o=this.locale,s=this.plugins,a=this.features,c=r.initialModel||{},u=r.widgetPath,l=r.configFile||"config.xml";""===u&&(u=".");var p=this.widgetInstanceFactory,m=this.widgetFeatureAugmenter;t.info("Starting widget @ %s...",u),t.info("Entering READ phase.");var v=n({});return r.reader&&(v=v.then(function(){var e=(i.endsWith(u,"/")?u:u+"/")+l;return r.reader.read(e)})),r.parser&&(v=v.then(function(e){return r.parser.parse(e)})),n.all([c,v]).then(function(e){t.debug("Aggregating models...");var r=new h({log:t});return r.combine(e)}).then(function(e){return e.content.type&&e.content.type!==g.html||(e.content.type=b(e),t.debug("The start file type was inferred as [%s]",e.content.type)),t.info("Invoking plugins for POST READ phase..."),y(s,d.POST_READ,[e])}).spread(function(e){t.info("Widget config read for: %s (%s).",e.id,e.name),t.info("Entering INSTANCE CREATION phase...");var n=r.renderer,s=r.storage;e.__id=e.id||i.randomId(),s.init(e.name,e.preferences,e.type),t.debug("Widget storage initialized.");var c=p.makeWidget(e,s,n,o);return t.debug("Widget instance created."),m.addFeaturesToWidget(c,a,e),t.debug("%s feature(s) added to widget.",a.length),[c,n,e]}).spread(function(e,r,n){t.info("Invoking plugins for PRE RENDER phase...");var i=y(s,d.PRE_RENDER,[e,r,n]);return i}).spread(function(e,r,n){t.info("Entering RENDERING phase...");var i=r.render(u,n,e);return[e,r,n,i]}).spread(function(e,r,n){t.info("Invoking plugins for POST RENDER phase...");var i=y(s,d.POST_RENDER,[e,r,n]);return i}).spread(function(r,n,i){var o={},s=(new Date).getTime();return o.time=s-e,o.id=i.id,o.message="Widget rendering for ["+i.name+"] completed in "+o.time+"ms.",o.areaNodes="function"==typeof n.getAreaNodes?n.getAreaNodes():null,t.info(o.message),o}).fail(function(e){throw t.error(e),new f(e,"An error occurred whilst starting the widget.")})},m.prototype.addFeature=function(e){return this.log.info("Adding feature for widget, %s",e.name||"[Anonymous feature]"),"object"==typeof e&&this.features.push(e),this},m.prototype.addPlugin=function(e){return this.log.info("Adding plugin for widget, %s",e.name||"[Anonymous plugin]"),"object"==typeof e&&this.plugins.push(e),this},m.prototype.destroy=function(){this.plugins.forEach(function(e){"function"==typeof e.destroy&&e.destroy()}),this.config.renderer.destroy()};var v=function(e){var t={warnings:[],errors:[]};return"string"!=typeof e.widgetPath?t.errors.push("You must supply a valid widget path"):e.widgetPath.indexOf("config.xml")>=0&&t.errors.push("Please supply the base path of your widget, not its config.xml path"),e.initialModel||e.reader||t.warnings.push("No initial model or widget reader was provided. Can't get any config"),e.reader&&!e.parser&&t.warnings.push("A widget reader was provided, but not a widget config parser"),!e.reader||e.reader instanceof a||t.warnings.push("The configured widget reader might not be a valid ConfigReader instance"),!e.parser||e.parser instanceof c||t.warnings.push("The configured widget parser might not be a valid ConfigParser instance"),e.storage?e.storage instanceof u||t.warnings.push("The configured widget storage might not be a valid WidgetStorage instance"):t.errors.push("No widget storage is configured"),e.renderer?e.renderer instanceof s||t.warnings.push("The configured widget renderer might not be a valid WidgetRenderer instance"):t.errors.push("No widget renderer is configured"),t},y=function(e,t,r){var i=n.all(r);return e.forEach(function(e){var r=e.name||"Anonymous plugin";"function"==typeof e[t]&&(i=i.spread(function(){var r=Array.prototype.slice.call(arguments),n=e[t].apply(e,r);return n instanceof Array||(n=[n].concat(r.slice(1))),n}).fail(function(e){var n="Failed to invoke plugin ["+r+"] for ["+t+"]";throw new f(e,n)}))}),i},b=function(e){var t=e.content.src.match(/\.([A-z0-9]+)$/);return t&&t[1]&&g[t[1]]||e.content.type};t.exports=m},{"./config-aggregator":101,"./config-parser":102,"./config-reader":103,"./logger-factory":106,"./util":108,"./widget-error":111,"./widget-feature-augmenter":112,"./widget-instance-factory":113,"./widget-renderer":114,"./widget-storage":115,q:223}],110:[function(e,t,r){arguments[4][71][0].apply(r,arguments)},{dup:71}],111:[function(e,t,r){arguments[4][72][0].apply(r,arguments)},{dup:72}],112:[function(e,t,r){arguments[4][73][0].apply(r,arguments)},{"./widget-error":111,dup:73}],113:[function(e,t,r){"use strict";var n=e("./util"),i=["author","version","id","authorEmail","authorHref","locale"],o=["description","name","shortName"],s=function(){};s.prototype.makeWidget=function(e,t,r,s){var a={};return i.forEach(function(t){Object.defineProperty(a,t,{enumerable:!0,value:"undefined"!=typeof e[t]?e[t]:""})}),o.forEach(function(t){var r=null;if(s&&e._lang){var i=n.getDescendantLocales(s),o=i.map(function(t){return e._lang[t]}),c=function(e){var r;if(e.length){var n=e.pop();if(n&&(r=n[t]),"string"!=typeof r)return c(e)}return r};r=c(o)}if("string"!=typeof r&&"string"==typeof e[t])r=e[t];else if("string"!=typeof r&&e.defaultlocale){var u=e._lang[e.defaultlocale];u&&(r=u[t])}Object.defineProperty(a,t,{enumerable:!0,value:"string"==typeof r?r:""})}),Object.defineProperty(a,"width",{enumerable:!0,get:function(){return r.getWidth()}}),Object.defineProperty(a,"height",{enumerable:!0,get:function(){return r.getHeight()}}),Object.defineProperty(a,"preferences",{enumerable:!1,value:t}),a},t.exports=s},{"./util":108}],114:[function(e,t,r){arguments[4][75][0].apply(r,arguments)},{"./util":108,dup:75}],115:[function(e,t,r){arguments[4][76][0].apply(r,arguments)},{dup:76}],116:[function(e,t,r){(function(r){"use strict";r.env.Q_DEBUG=window.Q_DEBUG||!1;var n=e("../core/widget-engine"),i=e("../core/config-reader"),o=e("../core/config-parser"),s=e("../core/widget-renderer"),a=e("../core/widget-storage"),c=e("../strategies/parser/auto-config-parser"),u=e("../strategies/reader/xhr-widget-reader"),l=e("../strategies/storage/web-storage-decorator"),p=e("../strategies/renderer/html5-seamless-renderer"),h=e("../strategies/renderer/html5-container-renderer"),f=e("../strategies/storage/html5-local-storage"),d=e("../strategies/storage/temp-storage"),g=e("../strategies/renderer/preprocessors/handlebars-preprocessor"),m=e("../plugins/cxp-additions-plugin"),v=e("../plugins/replace-config-vars-plugin"),y=e("../plugins/backbase-format-plugin"),b=e("../core/logger-factory"),w=null,E=function(){return w||(w=new g)},x=function(e){b.createLogger({parentLog:e.log,loggerName:"container",logLevel:e.logLevel,appendId:!0})};x.prototype.init=function(e){var t=e.widgetUrl,r=e.widgetEl,i=e.locale||null,o=e.useFolderLocalization||!1,s=e.reader||(e.initialModel?null:new u),a=e.parser||new c,l=e.renderer||new h(r,{locale:i,useFolderLocalization:o,configVars:e.configVars||{}});l.addPreprocessor("text/x-handlebars-template",E());var p=e.storage||new f;this.widgetEngine=new n({configFile:e.configFile,widgetPath:t,locale:e.locale,initialModel:e.initialModel,renderer:l,parser:a,reader:s,storage:p}),this.widgetEngine.addPlugin(new m({path:t,locale:e.locale}))},x.prototype.start=function(){return this.widgetEngine.start()},x.prototype.addPlugin=function(e){return this.widgetEngine.addPlugin(e),this},x.prototype.addFeature=function(e){return this.widgetEngine.addFeature(e),this},x.prototype.getLogger=function(){return this.log},x.prototype.destroy=function(){return this.widgetEngine.destroy()};var _=function(e){b.createLogger({parentLog:e.log,loggerName:"widget",logLevel:e.logLevel,appendId:!0})};_.prototype.init=function(e){var t=e.widgetUrl,r=e.widgetEl,i=e.locale||null,o=e.useFolderLocalization||!1,s=e.reader||(e.initialModel?null:new u),a=e.parser||new c,l=e.renderer||new p(r,{locale:i,configVars:e.configVars||{},useFolderLocalization:o});l.addPreprocessor("text/x-handlebars-template",E());var h=e.storage||new f;this.widgetEngine=new n({configFile:e.configFile,widgetPath:t,parser:a,reader:s,renderer:l,storage:h,locale:e.locale,initialModel:e.initialModel}),this.widgetEngine.addPlugin(new m({path:t,locale:e.locale}))},_.prototype.start=function(){return this.widgetEngine.start()},_.prototype.addPlugin=function(e){return this.widgetEngine.addPlugin(e),this},_.prototype.addFeature=function(e){return this.widgetEngine.addFeature(e),this},_.prototype.getLogger=function(){return this.log},_.prototype.destroy=function(){return this.widgetEngine.destroy()},t.exports={WidgetEngine:_,ContainerEngine:x,ConfigReader:i,ConfigParser:o,WidgetRenderer:s,WidgetStorage:a,XhrWidgetReader:u,AutoConfigParser:c,Html5SeamlessRenderer:p,WebStorageDecorator:l,Html5LocalStorage:f,TempStorage:d,ReplaceConfigVarsPlugin:v,BackbaseFormatPlugin:y}}).call(this,e("_process"))},{"../core/config-parser":102,"../core/config-reader":103,"../core/logger-factory":106,"../core/widget-engine":109,"../core/widget-renderer":114,"../core/widget-storage":115,"../plugins/backbase-format-plugin":117,"../plugins/cxp-additions-plugin":118,"../plugins/replace-config-vars-plugin":119,"../strategies/parser/auto-config-parser":120,"../strategies/reader/xhr-widget-reader":126,"../strategies/renderer/html5-container-renderer":127,"../strategies/renderer/html5-seamless-renderer":128,"../strategies/renderer/preprocessors/handlebars-preprocessor":129,"../strategies/storage/html5-local-storage":131,"../strategies/storage/temp-storage":133,"../strategies/storage/web-storage-decorator":134,_process:92}],117:[function(e,t,r){(function(r,n){"use strict";function i(e){return e._items}function o(e,t){var r=[];if(e)for(var n=0;n<e.childNodes.length;n++)e.childNodes[n].hasClass(t)&&r.pus(e.childNodes[n]);return r}function s(e,t){for(;e&&null!==e.parentNode;e=e.parentNode)if(a(e,t))return e;return null}function a(e,t){return e.classList?e.classList.contains(t):new RegExp("(^| )"+t+"( |$)","gi").test(e.className)}function c(e){var t=[];for(var r in e)e.hasOwnProperty(r)&&t.push(r+"="+encodeURIComponent(e[r]));return t.join("&")}function u(e){var t=new E;return Object.keys(e).length&&Object.keys(e).forEach(function(r){t.append(r,e[r])}),t}function l(e,t){var r=new DOMParser,n=r.parseFromString(e,"text/html"),i=x(n.getElementsByTagName("img"));return i.forEach(function(e){var r=e.getAttribute("src");r&&f.isUrlSiteRelative(r)&&e.setAttribute("src",p(t,r))}),n.body.innerHTML}function p(e,t){var r,n;for(r=1;r<Math.min(e.length,t.length)&&(n=e.substr(-1*r,r),0!==t.indexOf(n));r++);var i=n?w.resolve(e.substr(0,e.length-n.length),t):w.resolve(e,t);return i}function h(e,t){function r(e,t){return t=t[e.shift()],e.length>0&&"object"==typeof t?r(e,t):t}var n=e.split(/\./);return n.shift(),r(n,t)}var f=e("../core/util"),d=e("../core/logger-factory"),g=e("browser-bunyan"),m=e("event-target"),v=e("../strategies/storage/storage-event"),y=e("q"),b=e("fetchify")(y.Promise).fetch,w=e("url"),E=n.FormData,x=Array.prototype.slice.call.bind(Array.prototype.slice),_=function(e){e=e||{},this.name="Backbase Format",this.portalConf=e.portalConf||{},this.contextRoot=e.contextRoot||"",this.remoteContextRoot=e.remoteContextRoot||"",this.makeIncludedRefsAbsolute=e.makeIncludedRefsAbsolute||!1,this.window="undefined"==typeof window?e.window:window,this.log=d.getLogger(),this._inlineScriptTags=[]};_.prototype.preRender=function(e,t,o){var s=this;this.log.info("Backbase format plugin is running in PRE RENDER phase...");var a=f.cloneDeep(e);a.width=e.width,a.height=e.height,a.preferences=e.preferences,a.features=e.features,a.id=o.id||Math.random().toString(36).substr(2,5),a.name=o.name;var c=e.preferences.eventTarget?e.preferences.eventTarget.indexOf(e):-1;c>-1&&(e.preferences.eventTarget[c]=a),a.myDefinition={sUrl:o.content.src},a.nodeName="backbaseWidget",a.tagName="backbaseWidget",a.tags=f.isArray(this.portalConf.tags)?this.portalConf.tags:[],e.preferences.getItem("title")||e.preferences.defineItem({name:"title",value:o["bb:title"],readonly:!1}),e.preferences.getItem("src")||e.preferences.defineItem({name:"src",value:o.content.src,readonly:!1}),e.preferences.getItem("thumbnailUrl")||e.preferences.defineItem({name:"thumbnailUrl",value:o.icons[0],readonly:!1}),a.model={jxid:"VIEW-"+o.name,localName:"Widget",name:o.name,tag:"widget",tagName:"Widget",contextItemName:e.features&&e.features.cxp&&e.features.cxp.config?e.features.cxp.config.get("portalName"):null,extendedItemName:o["bb:extendedItemName"]||null,parentItemName:o["bb:parentItemName"]||null,securityProfile:o["bb:securityProfile"]||null,uuid:o.id||null,preferences:i(e.preferences),tags:f.isArray(o["bb:tags"])?o["bb:tags"]:[]},a.model.addEventListener=m.addEventListener,a.model.removeEventListener=m.removeEventListener,a.model.dispatchEvent=m.dispatchEvent,a.getPreference=function(t){return e.preferences.getItem(t)},a.getPreferenceFromParents=a.getPreference,a.getAreaPreference=function(){return e.preferences.getItem("area")||0},a.getOrderPreference=function(){return e.preferences.getItem("order")},a.setPreference=function(t,r){e.preferences.setItem(t,r)},a.getDefinition=function(){return a.myDefinition},a.model.save=function(t){r.nextTick(function(){if("function"==typeof t){var r={contextItemName:a.model.contextItemName,name:a.name,preferences:e.preferences,tag:"widget"},i={status:204,statusText:"No Content",readyState:4};t.call(n,r,i)}})},a.model.getPreference=function(t){return e.preferences.getItem(t)},a.model.setPreference=function(t,r){e.preferences.setItem(t,r)};var u="PrefModified";return a.addEventListener&&a.dispatchEvent&&a.addEventListener("storage",function(t){s.log.debug("Chaining StorageEvent to Backbase 'PrefModified' event...");var r=new v(u);r.initStorageEvent(u,!1,!1,t.key,t.oldValue,t.newValue,t.url,e.preferences),a.model.dispatchEvent(r)}),this.log.info("Backbase format plugin PRE RENDER done."),a},_.prototype.postRender=function(e,t,r){function n(){if(!_){var e=w.querySelector("div[g\\:onload]");e&&(_=e.getAttribute("g:onload"))}_&&(p.debug("Found g:onload attribute: [%s]",_),i(_))}function i(e){try{p.debug("Executing g:onload script...");var t=P+e+N,r=m.createElement("script");r.type="text/javascript",r.innerHTML=t,m.body.appendChild(r),a._inlineScriptTags.push(r)}catch(n){p.warn("g:onload failed!"),p.error(n)}p.info("Backbase format plugin POST RENDER done.")}var a=this,p=this.log;p.info("Backbase format plugin is running in POST RENDER phase...");var d=this.window,m=d.document,v=r.content?r.content.src.replace(/\/[^\/]+$/,""):"";v=v.replace(/\$\(contextRoot\)/,this.contextRoot);var w,E=t.getWidgetNode(),_=E.getAttribute("g:onload");if(_){w=m.createElement("div"),w.className="bp-widget-body";var k=E.parentNode,S=E.nextSibling;w.appendChild(E),S?k.insertBefore(w,S):k.appendChild(w),e.body=w;var A=s(w,"bp-widget");e.htmlNode=A,e.htmlHead=o(A,"bp-widget-head")[0],e.htmlFoot=o(A,"bp-widget-foot")[0]}else w=E;var T=d.widgets?"window.widgets['"+r.__id+"']":"window.widget",P="\n/*seamless widget wrapper*/\n(function(widget, __WIDGET__, __GADGET__) {\n",N="\n})( "+T+", "+T+", "+T+")",I=[],O=r.content.src,R=f.isUrlAbsolute(O)?O:v+"/"+O,L=R.substring(0,R.lastIndexOf("/")+1),j=x(w.getElementsByTagName("g:include"));p.debug("Found %s g:include(s)",j.length),j.forEach(function(t){var n=t.getAttribute("src"),i=t.getAttribute("proxy")&&"true"===t.getAttribute("proxy"),o=t.getAttribute("method")?t.getAttribute("method"):"GET";p.debug("Processing g:include with data: [src=%s, proxy=%s, method=%s]",n,i,o);var s,d,v={},w={},E=/\$\{([a-zA-Z0-9-_]+)\}/,_=a.remoteContextRoot||a.contextRoot,k=x(t.getElementsByTagName("g:http-preference-param"));k.forEach(function(t){var r=t.getAttribute("name");v[r]=e.getPreference(r),p.debug("Added http param using g:http-preference-param: [%s: %s",r,v[r])});var S=x(t.getElementsByTagName("g:http-preference-param-map"));S.forEach(function(e){var t=e.getAttribute("dataType")||e.getAttribute("datatype");r.preferences&&r.preferences.forEach(function(e){if(e["bb.type"]===t){var r=t+"."+e.name;v[r]=e.value,p.debug("Added httpparam using g:http-preference-param-map: [%s: %s]",r,e.value)}})});var A=x(t.getElementsByTagName("g:http-param")),T=x(t.getElementsByTagName("g:http-proxy-param"));A.concat(T).forEach(function(t){var r=t.getAttribute("name"),n=t.getAttribute("value");n=n.replace(E,function(t,r){return"contextRoot"===r?_:e.getPreference(r)}),0===n.indexOf("__WIDGET__")&&(n=h(n,e)),"g:http-proxy-param"===t.tagName.toLowerCase()?(w[r]=n,p.debug("Added http proxy param using g:http-proxy-param: [%s: %s]",r,n)):(v[r]=n,p.debug("Added http param using g:http-param: [%s: %s]",r,n))}),n&&(n=n.replace(E,function(t,r){return e.getPreference(r)}),n=n.replace("$(contextRoot)",_),f.isUrlDocumentRelative(n)&&(n=L+n,p.debug("Update g:include src to [%s]",n)));var P={};i?(s=a.remoteContextRoot+"/proxy",n&&(w.url=n,Object.keys(v).length&&(w.url+=(w.url.indexOf("?")>=0?"&":"?")+c(v))),P=w):(s=n,P=v);var N={};"post"===o.toLowerCase()?N={method:"post",body:u(P)}:Object.keys(P).length&&(s+=(s.indexOf("?")>=0?"&":"?")+c(P)),p.level()<=g.DEBUG&&p.debug("Making g:include http request to [%s] with fetch opts: [%s]",s,JSON.stringify(N),null,"	"),d=b(s,N);var O=m.createElement("div");O.className="bp-g-include",O.setAttribute("data-src",s),t.parentNode.insertBefore(O,t.nextSibling),d.then(function(e){return p.debug("g:include request to [%s] completed with status: %s",s,e.status),e.status>=200&&e.status<300?y.Promise.resolve(e.text()):y.Promise.reject(e.statusText)}).fail(function(e){return"Unable to resolve include ( "+e+" )"}).then(function(e){p.trace("Received html response:\n%s",e),a.makeIncludedRefsAbsolute&&a.remoteContextRoot&&(e=l(e,a.remoteContextRoot)),O.innerHTML=e,t.parentNode.removeChild(t),p.trace("Added HTML to DOM:\n%s",e)}),I.push(d)});var C=y.allSettled(I);return C.then(function(e){var t=e.filter(function(e){return"rejected"===e.state}).length;t>0&&p.warn("%s includes failed to resolve.",t),n()}),[e,t,r].concat(C)},_.prototype.destroy=function(){this._inlineScriptTags.forEach(function(e){e.remove()})},t.exports=_}).call(this,e("_process"),"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"../core/logger-factory":106,"../core/util":108,"../strategies/storage/storage-event":132,_process:92,"browser-bunyan":135,"event-target":100,fetchify:136,q:223,url:97}],118:[function(e,t,r){"use strict";var n=e("event-target"),i=function(e){e=e||{},this.name="CXP Additions Plugin"};i.prototype.preRender=function(e){e.addEventListener=n.addEventListener,e.removeEventListener=n.removeEventListener,e.dispatchEvent=n.dispatchEvent;var t=e.preferences.eventTarget=e.preferences.eventTarget||[];return-1===t.indexOf(e)&&t.push(e),e},t.exports=i},{"event-target":100}],119:[function(e,t,r){"use strict";function n(e,t,r,n,i){if("string"==typeof t)for(var s in r)if(r.hasOwnProperty(s)){var a=new RegExp(n.start+s+n.end,"g");i.level()<=o.DEBUG&&a.test(t)&&i.debug("Replacing occurences of [%s] with [%s] where [%s=%s]",a,r[s],e,t),t=t.replace(a,r[s])}return t}var i=e("../core/logger-factory"),o=e("browser-bunyan"),s=function(e,t){t=t||{},this.name="Replace Config Vars",this.varMap=e,this.full=!!t.full,this.interpolateStartRegex=t.interpolateStartRegex||"\\$\\(",this.interpolateEndRegex=t.interpolateEndRegex||"\\)",this.log=i.getLogger()};s.prototype.postRead=function(e){function t(e){for(var o in e)e.hasOwnProperty(o)&&!e._ignoreReplace&&(e[o]=n(o,e[o],r.varMap,{start:r.interpolateStartRegex,end:r.interpolateEndRegex},i),null!==e[o]&&"object"==typeof e[o]&&t(e[o]))}var r=this,i=this.log;return i.info("Replace config vars plugin is running is POST READ phase..."),r.full?(i.debug("Doing full config vars replacement..."),t(e)):(i.debug("Doing minimal config vars replacement (just widget src and icons array)..."),e.content&&e.content.src&&(e.content.src=n("src",e.content.src,r.varMap,{start:r.interpolateStartRegex,end:r.interpolateEndRegex},i)),e.icons&&e.icons.forEach(function(e,t,o){o[t]=n("icons["+t+"]",e,r.varMap,{start:r.interpolateStartRegex,end:r.interpolateEndRegex},i)})),i.info("Replace config vars plugin in POST READ is DONE."),e},t.exports=s},{"../core/logger-factory":106,"browser-bunyan":135}],120:[function(e,t,r){"use strict";var n=e("../../core/config-parser"),i=e("../../core/widget-error"),o=e("../../core/logger-factory"),s={json:{parser:e("./commonjs-package-config-parser"),testFn:function(e){return"string"==typeof e&&0===e.trim().indexOf("{")}},backbaseXml:{parser:e("./backbase-sax-config-parser"),testFn:function(e){return"string"==typeof e&&e.trim().indexOf("<catalog")>=0}},w3cXml:{parser:e("./w3c-sax-config-parser"),testFn:function(e){return"string"==typeof e&&0===e.trim().indexOf("<widget")&&e.trim().indexOf("<contextItemName")<0}},jsObject:{parser:e("./js-object-parser"),testFn:function(e){return"object"==typeof e}}},a=function(){this.log=o.getLogger(),this.parserMap=s};a.prototype=Object.create(n.prototype),a.prototype.parse=function(e){var t=null;for(var r in this.parserMap)if(this.parserMap.hasOwnProperty(r)){var n=this.parserMap[r];if(n.testFn(e)){this.log.debug("Parsing widget config as: %s",r),t=n.parser;break}}if(null===t)throw new i("Could not determine the config parser to use");var o=new t;return o.parse(e)},a.prototype.addParserStrategy=function(e,t,r){this.parserMap[e]={parser:t,testFn:r}},t.exports=a},{"../../core/config-parser":102,"../../core/logger-factory":106,"../../core/widget-error":111,"./backbase-sax-config-parser":121,"./commonjs-package-config-parser":122,"./js-object-parser":123,"./w3c-sax-config-parser":124}],121:[function(e,t,r){"use strict";var n=e("sax"),i=e("q"),o=e("../../core/util"),s=e("../../core/config-parser"),a=e("../../core/locale"),c={UUID_ELEMENT:"uuid",NAME_ELEMENT:"name",PROPERTY_ELEMENT:"property",VALUE_ELEMENT:"value",NAME_ATTRIBUTE:"name",READONLY_ATTRIBUTE:"readonly",TYPE_ATTRIBUTE:"type",LOCALE_ELEMENT:"locale",DIR_ELEMENT:"dir",SRC:"src"},u={version:"version",width:"width",height:"height",viewmodes:"viewmodes",title:"bb:title",shortName:"shortName",description:"description",author:"author",authorHref:"authorHref",authorEmail:"authorEmail",license:"license",licenseHref:"licenseHref",thumbnailUrl:"icons"},l=function(){};l.prototype=Object.create(s.prototype),l.prototype.parse=function(t){var r=i.defer(),s=n.parser(!0,{trim:!0,lowercase:!0,xmlns:!0,position:!1,normalize:!0}),l=o.cloneDeep(e("../../core/default-widget-model"));"undefined"==typeof l.preferences&&(l.preferences=[]);var p=null,h=null,f=!1,d=null;return s.onopentag=function(e){e.parent=p,p=e},s.onclosetag=function(){var e=p.name===c.VALUE_ELEMENT&&!u.hasOwnProperty(h)&&h!==c.SRC;if(e){var t=l.preferences.filter(function(e){return e.name===h});t.length||l.preferences.push({name:h,value:"",readonly:o.parseBoolean(f),"bb.type":d||null})}if(p&&p.parent){var r=p.parent;delete p.parent,p=r}f=!1,d=null},s.onattribute=function(e){"xmlns"!==e.name&&(this.tag.name===c.PROPERTY_ELEMENT&&e.name===c.NAME_ATTRIBUTE&&(h=e.value),this.tag.name===c.PROPERTY_ELEMENT&&e.name===c.READONLY_ATTRIBUTE&&(f=e.value),this.tag.name===c.VALUE_ELEMENT&&e.name===c.TYPE_ATTRIBUTE&&(d=e.value))},s.ontext=function(e){switch(p.name){case c.NAME_ELEMENT:l.name=e;break;case c.UUID_ELEMENT:l.id=e;break;case c.LOCALE_ELEMENT:l.locale=e;break;case c.DIR_ELEMENT:l.dir=e;break;case c.VALUE_ELEMENT:if(u.hasOwnProperty(h)){var t=u[h];"icons"===t||"viewmodes"===t?("undefined"==typeof l[t]&&(l[t]=[]),l[t].push(e)):l[t]=e}else h===c.SRC?l.content.src=e:l.preferences.push({name:h,value:e,readonly:o.parseBoolean(f),"bb.type":d||null})}},s.onerror=function(e){r.reject(new Error(e))},s.onend=function(){l.locale=l.locale||a.defaultLocale,l.dir=l.dir||a.getDirection(l.locale),r.resolve(l)},s.write(t).end(),r.promise},t.exports=l},{"../../core/config-parser":102,"../../core/default-widget-model":104,"../../core/locale":105,"../../core/util":108,q:223,sax:89}],122:[function(e,t,r){"use strict";var n=e("q"),i=e("../../core/config-parser"),o=e("../../core/util"),s=function(){};s.prototype=Object.create(i.prototype),s.prototype.parse=function(t){try{var r=JSON.parse(t),i=o.cloneDeep(e("../../core/default-widget-model"));return i.id=r.name||i.id,i.version=r.version||i.version,i.description=r.description||i.description,i._lang=r.locales||i._lang,Array.isArray(r.contributors)&&r.contributors.length>0&&(i.author=r.contributors[0].name||i.author,i.authorEmail=r.contributors[0].email||i.authorEmail,i.authorHref=r.contributors[0].web||i.authorHref),Array.isArray(r.licenses)&&r.licenses.length>0?(i.license=r.licenses[0].type||i.license,i.licenseHref=r.contributors[0].url||i.licenseHref):"string"==typeof i.license&&(i.license=r.license),i.defaultlocale=r.defaultlocale||i.defaultlocale,i.width=r.width||i.width,i.height=r.height||i.height,i.viewmodes=r.viewmodes||i.viewmodes,i.name=r.fullName||i.name,i.shortName=r.shortName||i.shortName,i.preferences=r.preferences||i.preferences,i.features=r.features||i.features,i.icons=r.icons||i.icons,i.content=r.content||i.content,n.Promise.resolve(i)}catch(s){return n.Promise.reject(s)}},t.exports=s},{"../../core/config-parser":102,"../../core/default-widget-model":104,"../../core/util":108,q:223}],123:[function(e,t,r){arguments[4][81][0].apply(r,arguments)},{"../../core/config-parser":102,dup:81}],124:[function(e,t,r){"use strict";var n=e("sax"),i=e("q"),o=e("./w3c-xml-constants"),s=e("../../core/util"),a=e("../../core/config-parser"),c=function(){};c.prototype=Object.create(a.prototype),c.prototype.parse=function(t){function r(e,t){for(var r=0;r<e.length;r++)if(e[r][0]===t)return e[r][1];return null}function a(e,t,n,i){var s;t.attributes&&t.attributes[o.LANG_ATTRIBUTE]?s=t.attributes[o.LANG_ATTRIBUTE].value:t.attribList&&(s=r(t.attribList,o.LANG_ATTRIBUTE));var a="string"==typeof s?s:p;a?(e._lang=e._lang||{},e._lang[a]=e._lang[a]||{},
e._lang[a][n]=i):e[n]=i}var c=i.defer(),u=n.parser(!0,{trim:!0,lowercase:!0,xmlns:!0,position:!1,normalize:!0}),l=s.cloneDeep(e("../../core/default-widget-model"));"undefined"==typeof l.preferences&&(l.preferences=[]);var p=null,h=null;return u.onopentag=function(e){e.parent=h,h=e},u.onclosetag=function(){if(h&&h.parent){var e=h.parent;delete h.parent,h=e}},u.onattribute=function(e){if("xmlns"!==e.name)if(this.tag.name===o.WIDGET_ELEMENT)e.name===o.LANG_ATTRIBUTE&&(p=e.value),e.name===o.DEFAULTLOCALE_ATTRIBUTE&&(l.defaultlocale=e.value),e.name===o.ID_ATTRIBUTE?l.id=e.value:e.name===o.VERSION_ATTRIBUTE?l.version=e.value:e.name===o.WIDTH_ATTRIBUTE?l.width=e.value:e.name===o.HEIGHT_ATTRIBUTE?l.height=e.value:e.name===o.MODE_ATTRIBUTE&&"string"==typeof e.value&&(l.viewmodes=e.value.split(/\s+/));else if(h&&h.name===o.WIDGET_ELEMENT)if(this.tag.name===o.NAME_ELEMENT)e.name===o.SHORT_ATTRIBUTE&&a(l,this,"shortName",e.value);else if(this.tag.name===o.AUTHOR_ELEMENT)e.name===o.HREF_ATTRIBUTE&&(l.authorHref=e.value),e.name===o.EMAIL_ATTRIBUTE&&(l.authorEmail=e.value);else if(this.tag.name===o.PREFERENCE_ELEMENT)e.name===o.NAME_ATTRIBUTE&&l.preferences.push({name:e.value,value:r(this.attribList,o.VALUE_ATTRIBUTE),readonly:s.parseBoolean(r(this.attribList,o.READONLY_ATTRIBUTE))});else if(this.tag.name===o.FEATURE_ELEMENT)e.name===o.NAME_ATTRIBUTE&&l.features.push({name:e.value,required:s.parseBoolean(r(this.attribList,o.REQUIRED_ATTRIBUTE)),params:[]});else if(this.tag.name===o.ICON_ELEMENT){if(e.name===o.SOURCE_ATTRIBUTE){var t={src:e.value};t.width=r(this.attribList,o.WIDTH_ATTRIBUTE),t.height=r(this.attribList,o.HEIGHT_ATTRIBUTE),l.icons.push(t)}}else this.tag.name===o.CONTENT_ELEMENT?e.name===o.SOURCE_ATTRIBUTE&&(l.content.src=e.value,l.content.type=r(this.attribList,o.TYPE_ATTRIBUTE),l.content.encoding=r(this.attribList,o.CHARSET_ATTRIBUTE)):this.tag.name===o.LICENSE_ELEMENT&&e.name===o.HREF_ATTRIBUTE&&(l.licenseHref=e.value);else if(h&&h.name===o.FEATURE_ELEMENT&&this.tag.name===o.PARAM_ELEMENT&&"name"===e.name){var n=l.features.filter(function(e){return h.attributes.name.value=e.name})[0];n.params.push({name:r(this.attribList,o.NAME_ATTRIBUTE),value:r(this.attribList,o.VALUE_ATTRIBUTE)})}},u.ontext=function(e){this.tag.name===o.NAME_ELEMENT&&a(l,this.tag,"name",e),this.tag.name===o.DESCRIPTION_ELEMENT&&a(l,this.tag,"description",e),this.tag.name===o.AUTHOR_ELEMENT&&(l.author=e),this.tag.name===o.LICENSE_ELEMENT&&a(l,this.tag,"license",e)},u.onerror=function(e){c.reject(new Error(e))},u.onend=function(){c.resolve(l)},u.write(t).end(),c.promise},t.exports=c},{"../../core/config-parser":102,"../../core/default-widget-model":104,"../../core/util":108,"./w3c-xml-constants":125,q:223,sax:89}],125:[function(e,t,r){"use strict";var n={WIDGET_ELEMENT:"widget",DEFAULTLOCALE_ATTRIBUTE:"defaultlocale",ID_ATTRIBUTE:"id",VERSION_ATTRIBUTE:"version",MODE_ATTRIBUTE:"viewmodes",VIEWMODES:["windowed","floating","fullscreen","maximized","minimized","all"],DEFAULT_VIEWMODE:"floating",NAME_ELEMENT:"name",SHORT_ATTRIBUTE:"short",DESCRIPTION_ELEMENT:"description",AUTHOR_ELEMENT:"author",EMAIL_ATTRIBUTE:"email",LICENSE_ELEMENT:"license",ICON_ELEMENT:"icon",ACCESS_ELEMENT:"access",ORIGIN_ATTRIBUTE:"origin",SUBDOMAINS_ATTRIBUTE:"subdomains",SUPPORTED_SCHEMES:["http","https"],CONTENT_ELEMENT:"content",TYPE_ATTRIBUTE:"type",CHARSET_ATTRIBUTE:"encoding",DEFAULT_CHARSET:"UTF-8",DEFAULT_MEDIA_TYPE:"text/html",FEATURE_ELEMENT:"feature",REQUIRED_ATTRIBUTE:"required",PARAM_ELEMENT:"param",PREFERENCE_ELEMENT:"preference",READONLY_ATTRIBUTE:"readonly",UPDATE_ELEMENT:"update-description",HEIGHT_ATTRIBUTE:"height",WIDTH_ATTRIBUTE:"width",HREF_ATTRIBUTE:"href",NAME_ATTRIBUTE:"name",SOURCE_ATTRIBUTE:"src",VALUE_ATTRIBUTE:"value",LANG_ATTRIBUTE:"xml:lang",DEFAULT_LANG:"en",DIR_ATRRIBUTE:"dir",DEFAULT_WIDGET_VERSION:"1.0",UNKNOWN:"unknown",DEFAULT_HEIGHT_SMALL:32,DEFAULT_WIDTH_SMALL:32,DEFAULT_HEIGHT_LARGE:300,DEFAULT_WIDTH_LARGE:150,MANIFEST_FILE:"config.xml",MANIFEST_NAMESPACE:"http://www.w3.org/ns/widgets",SUPPORTED_CONTENT_TYPES:["text/html","image/svg+xml","application/xhtml+xml"],START_FILES:["index.htm","index.html","index.svg","index.xhtml","index.xht"],DEFAULT_ICON_FILES:["icon.svg","icon.ico","icon.png","icon.gif","icon.jpg"]};Object.freeze(n),t.exports=n},{}],126:[function(e,t,r){"use strict";var n=e("q"),i=e("fetchify")(n.Promise).fetch,o=e("../../core/config-reader"),s=e("../../core/widget-error"),a=e("../../core/logger-factory"),c=function(e){e=e||{},this.log=a.getLogger(),this.useCache="boolean"==typeof e.useCache?e.useCache:!0,this.responseCache={}};c.prototype=Object.create(o.prototype),c.prototype.read=function(e){var t=this,r=this.log;return r.debug("Making http request for widget config to [%s]...",e),this.responseCache[e]?(this.log.debug("Using cached response for [%s]",e),this.responseCache[e]):i(e).then(function(t){return r.debug("Response received for [%s]. Status: %s.",e,t.status),t.status>=200&&t.status<300?n.Promise.resolve(t):n.Promise.reject(new Error(t.statusText))}).then(function(e){return e.text()}).then(function(n){return r.trace("Received config:\n%s",n),t.useCache&&(t.responseCache[e]=n),n}).fail(function(t){throw new s(t,"Failed to XHR get from "+e)})},t.exports=c},{"../../core/config-reader":103,"../../core/logger-factory":106,"../../core/widget-error":111,fetchify:136,q:223}],127:[function(e,t,r){arguments[4][82][0].apply(r,arguments)},{"./html5-seamless-renderer":128,dup:82}],128:[function(e,t,r){"use strict";function n(e,t){var r=this,n=["getElementById","getElementsByName","getElementsByTagName","getElementsByClassName","querySelector","querySelectorAll","body","baseURI"];for(var i in t)"function"!=typeof t[i]||i in r?i in r||(n.indexOf(i)?r[i]=e[i]:r[i]=t[i]):!function(i){n.indexOf(i)?r[i]=function(){return e[i].apply(e,Array.prototype.slice.call(arguments,0))}:r[i]=function(){return t[i].apply(t,Array.prototype.slice.call(arguments,0))}}(i)}var i=e("q"),o=e("fetchify")(i.Promise).fetch,s=e("../../core/preprocessing-widget-renderer"),a=e("../../core/widget-error"),c=e("../../core/widget-error-codes"),u=e("../../core/util"),l=e("../../core/logger-factory"),p=e("browser-bunyan"),h=e("url"),f={},d=e("./util/resource-loader"),g=function(e,t){if(s.call(this),"undefined"==typeof window.DOMParser)throw new Error("DOMParser is not shimmed or a native object. This renderer will not work");t=t||{},this.widgetContainerEl=e,this.parsingFormat=t.parsingFormat||null,this.locale=t.locale||null,this.configVars=t.configVars||{},this.useFolderLocalization=t.useFolderLocalization||!1,this.log=l.getLogger(),this.widgetEl=null,this._widgetInstanceReferences=[],this._inlineScriptTags=[]};g.prototype=Object.create(s.prototype),g.prototype.fetchStartFile=function(e,t){this.path=e;var r=this.log;r.debug("Starting HTML5 seamless rendering...");var n=this.getStartFilePaths(e,t,this.locale);this.useFolderLocalization||(n=n.slice(0,1));var i=n.pop();this.startFileDir=i.substring(0,i.lastIndexOf("/")+1),r.debug("Using widget start file @ %s",i);var s=f[i];return s||(r.debug("Requesting start file..."),s=o(i).then(function(e){if(r.debug("Start file request resolved/ Status: %s",e.status),0===e.status||200===e.status)return e._body;var t=new Error(e.statusText);throw t.code=e.status,t}).then(function(e){return r.trace("Received HTML\n: %s",e),e}).fail(function(e){var t=new a(e,"Failed to fetch "+i);throw 404===e.code&&(t.code=c.STARTFILE_NOT_FOUND),t}),s.then(function(){f[i]=s})),s},g.prototype.process=function(e,t,r){function i(e){return isNaN(parseInt(e))?e:e+"px"}var o=this,s=this.log,c=d(),l="/*seamless widget wrapper*/\n(function(widget, document) {\n",f="\n})( window.widgets['"+e.__id+"'], window.widgets.documents['"+e.__id+"'])",g=new DOMParser,m=this.parsingFormat||"text/html",v=g.parseFromString(r,m);window.widgets=window.widgets||{},window.widgets[e.__id]=t,this._widgetInstanceReferences.push(e.__id);var y=new n(this.widgetContainerEl,document);Object.defineProperty(t,"baseURI",{enumerable:!0,value:this.path}),window.widgets.documents=window.widgets.documents||{},window.widgets.documents[e.__id]=y;var b=[],w=Array.prototype.slice.call(v.getElementsByTagName("link"));w.forEach(function(e){if("stylesheet"===e.rel&&e.getAttribute("href")){var t=e.getAttribute("href");t=o._replacePathVars(t),u.isUrlDocumentRelative(t)&&(t=h.resolve(o.startFileDir,t)),e.parentNode.removeChild(e),b.push(t)}}),s.level()<=p.DEBUG&&s.debug("Using resource loader to load %s CSS resource(s): %s ...",b.length,b.join(", ")),c.loadCss(b);var E=Array.prototype.slice.call(v.getElementsByTagName("style"));E.forEach(function(e){document.head.appendChild(e)});var x=[],_=[],k=Array.prototype.slice.call(v.getElementsByTagName("script"));k.forEach(function(e){var t=e.innerHTML;if(t)e.type&&"text/javascript"!==e.type||(s.trace("Queuing script to inline:\n%s",t),_.push(t));else{var r=e.getAttribute("src");r&&(r=o._replacePathVars(r),u.isUrlDocumentRelative(r)&&(r=h.resolve(o.startFileDir,r)),x.push(r))}}),s.level()<=p.DEBUG&&s.debug("Using resource loader to load %s JS resource(s): %s ...",x.length,x.join(", "));var S=c.loadScripts(x),A=Array.prototype.slice.call(v.getElementsByTagName("img"));A.forEach(function(e){var t=e.getAttribute("src");if(t){var r=o._replacePathVars(t);if(u.isUrlDocumentRelative(r)){var n=h.resolve(o.startFileDir,r);r=n,s.debug("Image src updated from [%s] to [%s].",t,n)}e.getAttribute("src")!==r&&(e.src=r)}});var T=document.createElement("div");T.id=e.__id,T.setAttribute("data-widget",e.name),Object.defineProperty(t,"body",{enumerable:!0,writable:!0,value:T}),e.width&&(T.style.width=i(e.width),s.debug("Widget width set to %s.",T.style.width)),e.height&&(T.style.height=i(e.height),s.debug("Widget height set to %s.",T.style.height));for(var P=v.getElementsByTagName("body")[0],N=P.getAttribute("onload"),I=0;I<P.attributes.length;I++){var O=P.attributes[I];O.specified&&"onload"!==O.name&&T.setAttribute(O.name,O.value)}return T.innerHTML=P.innerHTML,this.widgetContainerEl.appendChild(T),this.widgetEl=T,S.then(function(e){if(s.debug("JS resources have loaded."),e){var t=e.filter(function(e){return"rejected"===e.state}).length;t>0&&s.warn("%s scripts failed to load.",t)}N&&(_.push(N),s.debug("Found onload attribute to execute [%s]",N)),s.debug("Adding %s inline script(s). (Including an onload attribute if any)...",_.length);var r=l+_.join("\n")+f,n=document.createElement("script");n.innerHTML=r,document.body.appendChild(n),o._inlineScriptTags.push(n)})["catch"](function(e){throw new a(e,"Failed to render HTML5 seamless widget")})},g.prototype.getWidgetNode=function(){return this.widgetEl||null},g.prototype.getParentNode=function(){return this.widgetContainerEl||null},g.prototype.setParentNode=function(e){this.widgetContainerEl=e},g.prototype.getWidth=function(){return this.getWidgetNode()?this.getWidgetNode().offsetWidth:"auto"},g.prototype.getHeight=function(){return this.getWidgetNode()?this.getWidgetNode().offsetHeight:"auto"},g.prototype._replacePathVars=function(e){var t=this.log,r=this.configVars;for(var n in r)if(r.hasOwnProperty(n)){var i=new RegExp("\\$\\("+n+"\\)","g");t.level()<=p.DEBUG&&i.test(e)&&t.debug("Updating resource url. Replacing %s for %s in [%s]",i,r[n],e),e=e.replace(i,r[n])}return e},g.prototype.destroy=function(){for(var e=this.widgetEl.getAttribute("data-widget"),t=this.widgetEl.parentElement,r=null;t;){var n=t.getAttribute("data-chrome");if(n===e){r=t;break}t=t.parentElement}r?r.parentElement.removeChild(r):(this.widgetEl.parentElement.removeChild(this.widgetEl),this.widgetEl=null),this._inlineScriptTags.forEach(function(e){e.parentElement.removeChild(e)}),this._inlineScriptTags=[],this._widgetInstanceReferences.forEach(function(e){delete window.widgets[e]}),this._widgetInstanceReferences=[]},g.prototype._clearCache=function(){f={}},t.exports=g},{"../../core/logger-factory":106,"../../core/preprocessing-widget-renderer":107,"../../core/util":108,"../../core/widget-error":111,"../../core/widget-error-codes":110,"./util/resource-loader":130,"browser-bunyan":135,fetchify:136,q:223,url:97}],129:[function(require,module,exports){"use strict";var Handlebars=require("handlebars/dist/handlebars.min"),WidgetError=require("../../../core/widget-error"),loggerFactory=require("../../../core/logger-factory"),HandlebarsPreprocessor=function(){this.name="Handlebars Preprocessor",this.log=loggerFactory.getLogger(),this.templateCache={},this.hbs=Handlebars.create();var e=HandlebarsPreprocessor.cxpHelpers;for(var t in e)e.hasOwnProperty(t)&&this.hbs.registerHelper(t,e[t])};HandlebarsPreprocessor.prototype.process=function(widgetModel,startFileContent,context){var log=this.log,errMessage,templateKey=widgetModel.id+widgetModel.content.src,template=this.templateCache[templateKey];if(!template){if(widgetModel.content.src&&widgetModel.content.src.match(/\.js$/)){var precompiledTemplate=null;try{eval("precompiledTemplate = "+startFileContent),template=this.hbs.template(precompiledTemplate)}catch(err){throw errMessage="There was a problem evaluating a pre-compiled handlebars template. Ensure it was compiled using the simple option. E.g.`handlebars index.handlebars -s -f index.js`",this.log.error(err,errMessage),new WidgetError(err,errMessage)}}else{log.debug("Compiling handlebars template instance for %s",templateKey);try{template=this.hbs.compile(startFileContent)}catch(err){throw errMessage="There was a problem compiling a handlebars template",this.log.error(err,errMessage),new WidgetError(err,errMessage)}}this.templateCache[templateKey]=template}var result=template(context);return log.trace("Using compiled Handlebars start file for %s:\n%s",templateKey,result),result},HandlebarsPreprocessor.prototype.registerHelper=function(e,t){this.hbs.registerHelper(e,t)},HandlebarsPreprocessor.prototype.registerPartial=function(e,t){this.hbs.registerPartial(e,t)},HandlebarsPreprocessor.cxpHelpers={range:function(e,t,r){var n="";e=parseInt(e),t=parseInt(t);for(var i=e;t>=i;i++)n+=r.fn({index:i,from:e,to:t});return n},withPreference:function(e,t){if(this.preferences){var r=this.preferences.filter(function(t){return t.name===e})[0];return t.fn(r)}},getPreferenceValue:function(e){if(this.preferences){var t=this.preferences.filter(function(t){return t.name===e})[0];return t?t.value:null}return null},add:function(e,t){return Math.floor(parseFloat(e)+parseFloat(t))},subtract:function(e,t){return Math.floor(parseFloat(e)-parseFloat(t))},multiply:function(e,t){return Math.floor(parseFloat(e)*parseFloat(t))},divide:function(e,t){return Math.floor(parseFloat(e)/parseFloat(t))},mod:function(e,t){return Math.floor(parseFloat(e)%parseFloat(t))},equal:function(e,t,r){return e===t?r.fn(this):r.inverse(this)},hasViewHint:function(){for(var e=Array.prototype.slice.call(arguments),t=e[e.length-1],r=e.slice(0,e.length-1),n=0;n<r.length;n++)if(this["bb:viewhints"]&&this["bb:viewhints"].indexOf(r[n])>=0)return t.fn(this);return t.inverse(this)}},module.exports=HandlebarsPreprocessor},{"../../../core/logger-factory":106,"../../../core/widget-error":111,"handlebars/dist/handlebars.min":137}],130:[function(e,t,r){"use strict";function n(){this.initilized=!1}var i=e("q"),o={};t.exports=function(){return new n},n.prototype._init=function(){this.initilized||(this.head=document.getElementsByTagName("head")[0]||document.documentElement,this.asyncSupported="undefined"!=typeof document.createElement("script").async,this.initilized=!0)},n.prototype.loadScripts=function(e){return e instanceof Array||(e=[e]),this._init(),this.asyncSupported?this._loadScriptsASync(e):this._loadScriptsSync(e)},n.prototype._loadScriptsASync=function(e){var t=this,r=e.filter(function(e){return!o[e]}).map(function(e){var r=document.createElement("script");r.src=e,r.async=!1;var n=t._createScriptPromise(r);return o[r.src]=n,t.head.insertBefore(r,t.head.firstChild),n});return i.allSettled(r)},n.prototype._loadScriptsSync=function(e){function t(e){if(!o[e]){var t=document.createElement("script");t.src=e,o[e]=n._createScriptPromise(t),s.push(o[e]),n.head.insertBefore(t,n.head.firstChild)}return o[e]}function r(n){var i=t(e[n]);return n++,e[n]?i.then(function(){return r(n)})["catch"](function(){return r(n)}):s}var n=this,s=[];return e.length?i.allSettled(r(0)):i()},n.prototype._createScriptPromise=function(e){var t=e.src;return i.Promise(function(r,n){e.onload=function(){r(t)},e.onerror=function(){n(t)}})},n.prototype.loadCss=function(e){e instanceof Array||(e=[e]),this._init();var t=this,r=t.head,n=[];return e.forEach(function(e){if(o[e])n.push(o[e]);else{var t=document.createElement("link");t.setAttribute("rel","stylesheet"),t.setAttribute("type","text/css"),t.setAttribute("href",e);var s=i.Promise.resolve(e);o[e]=s,n.push(s);var a=Array.prototype.slice.call(r.getElementsByTagName("link")).filter(function(e){return"stylesheet"===e.rel});if(a.length){var c=a.pop();c.parentNode.insertBefore(t,c.nextSibling)}else r.insertBefore(t,r.firstChild)}}),i.all(n)},n.prototype._clearCache=function(){o={}}},{q:223}],131:[function(e,t,r){arguments[4][86][0].apply(r,arguments)},{"./web-storage-decorator":134,dup:86}],132:[function(e,t,r){arguments[4][87][0].apply(r,arguments)},{"../../core/util":108,dup:87}],133:[function(e,t,r){"use strict";var n=e("./web-storage-decorator"),i=function(){};i.prototype.getItem=function(e){return"undefined"!=typeof this[e]?this[e]:null},i.prototype.setItem=function(e,t){this[e]=t},i.prototype.removeItem=function(e){delete this[e]},i.prototype.clear=function(){for(var e in this)this.hasOwnProperty(e)&&"string"==typeof this[e]&&this.removeItem(e)},i.prototype.key=function(e){return Object.keys(this)[e]},Object.defineProperty(i.prototype,"length",{enumerable:!1,configurable:!1,get:function(){return Object.keys(this).length}});var o=function(){var e=new i;n.call(this,e)};o.prototype=Object.create(n.prototype),t.exports=o},{"./web-storage-decorator":134}],134:[function(e,t,r){(function(r){"use strict";function n(e){this.eventTarget=[],this.log=i.getLogger(),this._items=[],this._storage=e,this._prefix="",this._eventsEnabled=!1;var t=this;Object.defineProperty(this,"length",{enumerable:!1,configurable:!1,get:function(){return Object.keys(t._items).length}})}var i=e("../../core/logger-factory"),o=e("browser-bunyan"),s=e("../../core/widget-storage"),a=e("../../core/widget-error"),c=e("./storage-event"),u=e("../../core/util");n.prototype=Object.create(s.prototype),n.prototype.init=function(e,t){var r=this,n=this.log;this._prefix=e||"",n.debug("Initializing preference storage for widget [%s]",e),n.debug("Using internal storage [%s]",this._storage.toString()),n.level()<=o.TRACE&&n.trace("Initializing storage with the following preferences:\n %s",JSON.stringify(t)),t&&(this._items=t.map(function(e){return r.defineItem(e)})),this._eventsEnabled=!0},n.prototype.getItem=function(e){var t=this._storage.getItem(this._prefix+e);if("undefined"==typeof t||null===t){var r=this._getItemDefinition(e)||null;t=r?r.value:null}return"undefined"==typeof t&&(t=null),this.log.trace("Getting preference [%s=%s]",e,t),t},n.prototype.defineItem=function(e){var t=this,r=e.name;this._items.push(e);var n={enumerable:!0,configurable:!0,get:function(){return t.getItem(r)},set:function(e){return t.setItem(t._prefix+r,e)}};return Object.defineProperty(this,r,n),e},n.prototype.setItem=function(e,t,r){var n=this._getItemDefinition(e);if(n&&n.readonly){var i=u.format("Attempted to set readonly preference [%s=%s]",e,t);throw this.log.warn(i),new a(i)}return this.log.debug("Setting preference to storage [%s=%s]",e,t),null===t?this.removeItem(e):(this._notify(e,this.getItem(e),t),this._storage.setItem(this._prefix+e,t,r))},n.prototype.removeItem=function(e){return this._notify(e,this.getItem(e),null),this.log.debug("Removing preference from storage [%s]",e),this._storage.removeItem(this._prefix+e)},n.prototype.clear=function(){var e=this;this._notify(null,null,null),this.log.debug("Clearing preferences"),this._eventsEnabled=!1,Object.keys(this._storage).filter(function(t){return 0===t.indexOf(e._prefix)}).forEach(function(t){e.removeItem(t.substr(e.prefix.length))}),this._eventsEnabled=!0},n.prototype.key=function(e){var t=this,r=Object.keys(this._storage).filter(function(e){return 0===e.indexOf(t._prefix)}).length,n=r.length;return e>=n?null:r[e]},n.prototype.keys=function(){var e=this,t=Object.keys(this._storage).filter(function(t){return 0===t.indexOf(e._prefix)});return 0===t.length?[]:t.map(function(t){return t.slice(e._prefix.length)})},n.prototype._getItemDefinition=function(e){var t=this._items.filter(function(t){return e===t.name})[0];return t||null},n.prototype._notify=function(e,t,n){if(this._eventsEnabled){var i=this,s=u.isArray(this.eventTarget)?this.eventTarget:[this.eventTarget];s.filter(function(e){return void 0!==e&&null!==e}).forEach(function(s){if("function"!=typeof s.dispatchEvent){var a="Cannot dispatch StorageEvent for preferences. An event target was provided, but it does not implement the EventTarget interface. [%s, %s, %s]";return void i.log.warn(a,e,t,n)}var u=new c("storage");u.initStorageEvent("storage",!1,!1,e,t,n,i._prefix,i),r.nextTick(function(){i.log.level()<=o.DEBUG&&i.log.debug("Sending StorageEvent [%s] ",u),s.dispatchEvent(u)})})}},t.exports=n}).call(this,e("_process"))},{"../../core/logger-factory":106,"../../core/util":108,"../../core/widget-error":111,"../../core/widget-storage":115,"./storage-event":132,_process:92,"browser-bunyan":135}],135:[function(e,t,r){arguments[4][2][0].apply(r,arguments)},{dup:2}],136:[function(e,t,r){arguments[4][4][0].apply(r,arguments)},{dup:4}],137:[function(e,t,r){arguments[4][5][0].apply(r,arguments)},{dup:5}],138:[function(e,t,r){arguments[4][6][0].apply(r,arguments)},{dup:6}],139:[function(e,t,r){arguments[4][7][0].apply(r,arguments)},{"./cachePush":160,"./getNative":165,dup:7}],140:[function(e,t,r){arguments[4][8][0].apply(r,arguments)},{dup:8}],141:[function(e,t,r){arguments[4][9][0].apply(r,arguments)},{dup:9}],142:[function(e,t,r){arguments[4][10][0].apply(r,arguments)},{dup:10}],143:[function(e,t,r){arguments[4][11][0].apply(r,arguments)},{dup:11}],144:[function(e,t,r){arguments[4][12][0].apply(r,arguments)},{"../object/keys":188,"./baseCopy":146,dup:12}],145:[function(e,t,r){arguments[4][13][0].apply(r,arguments)},{"../lang/isArray":181,"../lang/isObject":184,"./arrayCopy":140,"./arrayEach":141,"./baseAssign":144,"./baseForOwn":151,"./initCloneArray":167,"./initCloneByTag":168,"./initCloneObject":169,dup:13}],146:[function(e,t,r){arguments[4][14][0].apply(r,arguments)},{dup:14}],147:[function(e,t,r){arguments[4][15][0].apply(r,arguments)},{"./baseIndexOf":152,"./cacheIndexOf":159,"./createCache":163,dup:15}],148:[function(e,t,r){arguments[4][16][0].apply(r,arguments)},{"../lang/isArguments":180,"../lang/isArray":181,"./arrayPush":143,"./isArrayLike":170,"./isObjectLike":174,dup:16}],149:[function(e,t,r){arguments[4][17][0].apply(r,arguments)},{"./createBaseFor":162,dup:17}],150:[function(e,t,r){arguments[4][18][0].apply(r,arguments)},{"../object/keysIn":189,"./baseFor":149,dup:18}],151:[function(e,t,r){arguments[4][19][0].apply(r,arguments)},{"../object/keys":188,"./baseFor":149,dup:19}],152:[function(e,t,r){arguments[4][20][0].apply(r,arguments)},{"./indexOfNaN":166,dup:20}],153:[function(e,t,r){arguments[4][21][0].apply(r,arguments)},{"../lang/isArray":181,"../lang/isObject":184,"../lang/isTypedArray":186,"../object/keys":188,"./arrayEach":141,"./baseMergeDeep":154,"./isArrayLike":170,"./isObjectLike":174,dup:21}],154:[function(e,t,r){arguments[4][22][0].apply(r,arguments)},{"../lang/isArguments":180,"../lang/isArray":181,"../lang/isPlainObject":185,"../lang/isTypedArray":186,"../lang/toPlainObject":187,"./arrayCopy":140,"./isArrayLike":170,dup:22}],155:[function(e,t,r){arguments[4][23][0].apply(r,arguments)},{dup:23}],156:[function(e,t,r){arguments[4][24][0].apply(r,arguments)},{dup:24}],157:[function(e,t,r){arguments[4][25][0].apply(r,arguments)},{"../utility/identity":194,dup:25}],158:[function(e,t,r){arguments[4][26][0].apply(r,arguments)},{dup:26}],159:[function(e,t,r){arguments[4][27][0].apply(r,arguments)},{"../lang/isObject":184,dup:27}],160:[function(e,t,r){arguments[4][28][0].apply(r,arguments)},{"../lang/isObject":184,dup:28}],161:[function(e,t,r){arguments[4][29][0].apply(r,arguments)},{"../function/restParam":138,"./bindCallback":157,"./isIterateeCall":172,dup:29}],162:[function(e,t,r){arguments[4][30][0].apply(r,arguments)},{"./toObject":178,dup:30}],163:[function(e,t,r){arguments[4][31][0].apply(r,arguments)},{"./SetCache":139,"./getNative":165,dup:31}],164:[function(e,t,r){arguments[4][32][0].apply(r,arguments)},{"./baseProperty":155,dup:32}],165:[function(e,t,r){arguments[4][33][0].apply(r,arguments)},{"../lang/isNative":183,dup:33}],166:[function(e,t,r){arguments[4][34][0].apply(r,arguments)},{dup:34}],167:[function(e,t,r){arguments[4][35][0].apply(r,arguments)},{dup:35}],168:[function(e,t,r){arguments[4][36][0].apply(r,arguments)},{"./bufferClone":158,dup:36}],169:[function(e,t,r){arguments[4][37][0].apply(r,arguments)},{dup:37}],170:[function(e,t,r){arguments[4][38][0].apply(r,arguments)},{"./getLength":164,"./isLength":173,dup:38}],171:[function(e,t,r){arguments[4][39][0].apply(r,arguments)},{dup:39}],172:[function(e,t,r){arguments[4][40][0].apply(r,arguments)},{"../lang/isObject":184,"./isArrayLike":170,"./isIndex":171,dup:40}],173:[function(e,t,r){arguments[4][41][0].apply(r,arguments)},{dup:41}],174:[function(e,t,r){arguments[4][42][0].apply(r,arguments)},{dup:42}],175:[function(e,t,r){arguments[4][43][0].apply(r,arguments)},{"./toObject":178,dup:43}],176:[function(e,t,r){arguments[4][44][0].apply(r,arguments)},{"./baseForIn":150,dup:44}],177:[function(e,t,r){arguments[4][45][0].apply(r,arguments)},{"../lang/isArguments":180,"../lang/isArray":181,"../object/keysIn":189,"./isIndex":171,"./isLength":173,dup:45}],178:[function(e,t,r){arguments[4][46][0].apply(r,arguments)},{"../lang/isObject":184,dup:46}],179:[function(e,t,r){arguments[4][47][0].apply(r,arguments)},{"../internal/baseClone":145,"../internal/bindCallback":157,dup:47}],180:[function(e,t,r){arguments[4][48][0].apply(r,arguments)},{"../internal/isArrayLike":170,"../internal/isObjectLike":174,dup:48}],181:[function(e,t,r){arguments[4][49][0].apply(r,arguments)},{"../internal/getNative":165,"../internal/isLength":173,"../internal/isObjectLike":174,dup:49}],182:[function(e,t,r){arguments[4][50][0].apply(r,arguments)},{"./isObject":184,dup:50}],183:[function(e,t,r){arguments[4][51][0].apply(r,arguments)},{"../internal/isObjectLike":174,"./isFunction":182,dup:51}],184:[function(e,t,r){arguments[4][52][0].apply(r,arguments)},{dup:52}],185:[function(e,t,r){arguments[4][53][0].apply(r,arguments)},{"../internal/baseForIn":150,"../internal/isObjectLike":174,"./isArguments":180,dup:53}],186:[function(e,t,r){arguments[4][54][0].apply(r,arguments)},{"../internal/isLength":173,"../internal/isObjectLike":174,dup:54}],187:[function(e,t,r){arguments[4][55][0].apply(r,arguments)},{"../internal/baseCopy":146,"../object/keysIn":189,dup:55}],188:[function(e,t,r){arguments[4][56][0].apply(r,arguments)},{"../internal/getNative":165,"../internal/isArrayLike":170,"../internal/shimKeys":177,"../lang/isObject":184,dup:56}],189:[function(e,t,r){arguments[4][57][0].apply(r,arguments)},{"../internal/isIndex":171,"../internal/isLength":173,"../lang/isArguments":180,"../lang/isArray":181,"../lang/isObject":184,dup:57}],190:[function(e,t,r){arguments[4][58][0].apply(r,arguments)},{"../internal/baseMerge":153,"../internal/createAssigner":161,dup:58}],191:[function(e,t,r){arguments[4][59][0].apply(r,arguments)},{"../function/restParam":138,"../internal/arrayMap":142,"../internal/baseDifference":147,"../internal/baseFlatten":148,"../internal/bindCallback":157,"../internal/pickByArray":175,"../internal/pickByCallback":176,"./keysIn":189,dup:59}],192:[function(e,t,r){arguments[4][60][0].apply(r,arguments)},{"../internal/baseToString":156,dup:60}],193:[function(e,t,r){arguments[4][61][0].apply(r,arguments)},{"../internal/baseToString":156,dup:61}],194:[function(e,t,r){arguments[4][62][0].apply(r,arguments)},{dup:62}],195:[function(e,t,r){"use strict";function n(e){return new s(e)}var i=e("./cxp-util"),o=e("browser-bunyan"),s=function(e){e=e||{};var t="cxp-web";this.log=e.log?e.log.child({childName:t}):o.createLogger({name:t||"logger",streams:Array.isArray(e.logStreams)?e.logStreams:[{level:e.logLevel||"info",stream:new o.ConsoleFormattedStream,type:"raw"}]}),this.settings={},e.contextRoot&&this.set("contextRoot",e.contextRoot),e.remoteContextRoot&&this.set("remoteContextRoot",e.remoteContextRoot)};s.prototype.util=i,s.prototype.set=function(e,t){this.settings[e]=t},s.prototype.get=function(e){return this.settings[e]},s.prototype.enable=function(e){this.settings[e]=!0},s.prototype.disable=function(e){this.settings[e]=!1},s.prototype.enabled=function(e){return this.settings[e]},s.prototype.disabled=function(e){return!this.settings[e]},s.prototype.getLogger=function(){return this.log},t.exports={Configuration:s,createInstance:n}},{"./cxp-util":196,"browser-bunyan":135}],196:[function(e,t,r){"use strict";t.exports={getPreference:function(e,t){return e.preferences?e.preferences.filter(function(e){return e.name===t})[0]||null:void 0},getPreferenceValue:function(e,t){var r=this.getPreference(e,t);return r?r.value:null}}},{}],197:[function(e,t,r){"use strict";var n=e("./render/render.js"),i=e("./configuration/configuration.js"),o=e("./model/strategies/xml-cxp-model"),s=e("./navigation/navigation");t.exports={getRenderer:n.createInstance,createConfiguration:i.createInstance,getModel:o.createInstance,getNavigation:s.getInstance}},{"./configuration/configuration.js":195,"./model/strategies/xml-cxp-model":214,"./navigation/navigation":217,"./render/render.js":218}],198:[function(e,t,r){"use strict";function n(e,t,r,n){this.config=e,this.type=r,this._filter=n||null,this._requiredParams=this._getRequiredParams(),this._cache=t,this.logger=this.config.getLogger().child({childName:"item-collection-context"})}t.exports=n,n.prototype._getRequiredParams=function(){switch(this.type){case"link":return{depth:10,ps:50};case"page":return{depth:10};default:return null}},n.prototype.get=function(){throw new Error("Method not implemented")},n.prototype.create=function(e){throw new Error("Method not implemented")},n.prototype.filter=function(e,t,r){throw new Error("Method not implemented")}},{}],199:[function(e,t,r){"use strict";function n(e,t,r,n,i){this.config=e,this.itemName=r,this.itemType=n,this.findById=i||!1,this._requiredParams=this._getRequiredParams()||{},this._cache=t,this.logger=this.config.getLogger().child({childName:"item-collection-context"})}t.exports=n,n.prototype._getRequiredParams=function(){switch(this.itemType){case"link":case"page":return{depth:10};default:return null}},n.prototype.get=function(e){throw new Error("Method not implemented")},n.prototype.update=function(e){throw new Error("Method not implemented")},n.prototype.remove=function(){throw new Error("Method not implemented")}},{}],200:[function(e,t,r){"use strict";var n=["ar","iw","he","dv","ha","fa","ps","ur","yi","ji"];t.exports={defaultLocale:"en",getDirection:function(e){return n.indexOf(e)>=0?"rtl":"ltr"}}},{}],201:[function(e,t,r){"use strict";function n(){this.items={}}t.exports=n,n.prototype.update=function(e,t,r){this.items[e]||(this.items[e]={}),this.items[e][t]=r},n.prototype.get=function(e,t){return this.items[e]&&this.items[e][t]},n.prototype.remove=function(e,t){if(!this.items[e]||!this.items[e][t])return null;var r=this.items[e][t];return delete this.items[e][t],r}},{}],202:[function(e,t,r){"use strict";function n(e,t,r,n){var o=n||("order"===t?"double":"string"),s=i(e,t);s?(s.value=r,s["bb.type"]!==o&&(s["bb.type"]=o)):e.preferences.push({name:t,value:r,"bb.type":o})}function i(e,t){return e.preferences.filter(function(e){return e.name===t})[0]}function o(){var e=4294967295*Math.random()|0,t=4294967295*Math.random()|0,r=4294967295*Math.random()|0,n=4294967295*Math.random()|0;
return a[255&e]+a[e>>8&255]+a[e>>16&255]+a[e>>24&255]+"-"+a[255&t]+a[t>>8&255]+"-"+a[t>>16&15|64]+a[t>>24&255]+"-"+a[63&r|128]+a[r>>8&255]+"-"+a[r>>16&255]+a[r>>24&255]+a[255&n]+a[n>>8&255]+a[n>>16&255]+a[n>>24&255]}function s(e){return e+o()}t.exports={modifyPreference:n,getPreference:i,generateItemName:s};for(var a=[],c=0;256>c;c++)a[c]=(16>c?"0":"")+c.toString(16)},{}],203:[function(e,t,r){"use strict";function n(e){this.config=e,this.helpers=s,this._cache=new a}var i=e("events").EventEmitter,o=e("util"),s=e("../core/model-helpers"),a=e("../core/model-cache");t.exports=n,o.inherits(n,i),n.prototype.items=function(e){throw new Error("Method not implemented")},n.prototype.item=function(e,t){throw new Error("Method not implemented")},n.prototype.itemById=function(e,t){throw new Error("Method not implemented")}},{"../core/model-cache":201,"../core/model-helpers":202,events:90,util:99}],204:[function(e,t,r){"use strict";function n(e){this.configuration=e;var t=e.get("remoteContextRoot");if("string"!=typeof t)throw new Error("RestApiConsumer needs remoteContextRoot variable to be set");/\/$/.test(t)===!1&&(t+="/"),this.baseUrl=t,this.logger=e.getLogger().child({childName:"rest-api-consumer"})}function i(e){return new n(e)}function o(e){return c.isObject(e)?"application/json":e.indexOf("<?xml")>=0?"text/xml":void 0}var s=e("q"),a=e("fetchify")(s.Promise).fetch,c=e("../../util")._;t.exports={RestApiConsumer:n,createInstance:i},n.prototype._encodeQueryParameters=function(e){var t=[];return Object.keys(e).forEach(function(r){c.isArray(e[r])?e[r].forEach(function(e){t.push(r+"[]="+encodeURIComponent(e))}):t.push(r+"="+encodeURIComponent(e[r]))}),t.join("&")},n.prototype._buildUrl=function(e,t){var r=this._encodeQueryParameters(t||{}),n=this.baseUrl+e;return r.length>0&&(n+=(e.indexOf("?")>=0?"&":"?")+r),n},n.prototype._makeRequest=function(e,t,r){var n=this,i=this._buildUrl(e,t);this.logger.debug("Making %s request to: %s",r.method,i);var o=a(i,r||{}).then(function(e){if(e.status<200||e.status>=300){var t=new Error(e.statusText);throw t.response=e,t}return n.logger.debug("Request successful server responds %s",e.status),e});return o["catch"](function(e){n.logger.error("Request failed with: %s",e)}),o},n.prototype.get=function(e,t){return this._makeRequest(e,t,{method:"GET"})},n.prototype.post=function(e,t){var r={};c.isObject(t)&&(t=JSON.stringify(t));var n=o(t);return n&&(r["Content-Type"]=n),this._makeRequest(e,{},{method:"POST",body:t,headers:r})},n.prototype.put=function(e,t){var r={};c.isObject(t)&&(t=JSON.stringify(t));var n=o(t);return n&&(r["Content-Type"]=n),this._makeRequest(e,{},{method:"PUT",body:t,headers:r})},n.prototype["delete"]=function(e,t){return this._makeRequest(e,t,{method:"DELETE"})}},{"../../util":221,fetchify:136,q:223}],205:[function(e,t,r){"use strict";var n=e("./xml-builder");t.exports=function(e){var t=new n;return t.beginElement("widget"),t.beginElement("properties"),e.forEach(function(e){var r={name:e.name};e["bb:label"]&&(r.label=e["bb:label"]),e["bb:viewhints"]&&e["bb:viewhints"].length>0&&(r.viewHint=e["bb:viewhints"].join(",")),t.beginElement("property",r),t.beginElement("value"),t.text(e.value),t.endElement("value"),t.endElement("property")}),t.endElement("properties"),t.endElement("widget"),t.toString()}},{"./xml-builder":207}],206:[function(e,t,r){"use strict";function n(e,t,r){i(e,{name:"TemplateName",readonly:!1,value:r?"container-default":"Standard_Widget"}),i(e,{name:"widgetChrome",readonly:!1,value:"$(contextRoot)/static/backbase.com.2012.aurora/html/chromes/widget_none.html",viewhints:["select-one","designModeOnly","user"]}),t.content&&t.content.src&&i(e,{name:"src",readonly:!1,value:t.content.src}),t["bb:settingsContent"]&&t["bb:settingsContent"].src&&i(e,{name:"settingsSrc",readonly:!1,value:t["bb:settingsContent"].src}),t.viewmodes&&t.viewmodes.length>0&&i(e,{name:"viewmodes",readonly:!1,value:t.viewmodes.join(" ")});var n={description:"Description"},o=["author","authorEmail","authorHref","license","licenseHref","shortName","title","description"];o.forEach(function(r){if(t[r]){var o=n[r]||r;i(e,{name:o,readonly:!1,value:t[r]})}});var s=t.icons||[];s.forEach(function(t,r){var n=0===r?"thumbnailUrl":"icon";i(e,{name:n,readonly:!1,value:t})});var a=t.preferences||[];a.forEach(function(t){i(e,t)})}function i(e,t){var r={name:t.name,readonly:t.readonly||!1};t["bb:label"]&&(r.label=t["bb:label"]),t["bb:viewhints"]&&t["bb:viewhints"].length>0&&(r.viewHint=t["bb:viewhints"].join(",")),e.beginElement("property",r);var n=t["bb.type"]||("order"===t.name?"double":"string");e.beginElement("value",{type:n}),e.text(t.value),e.endElement("value"),e.endElement("property")}var o=e("./xml-builder");t.exports=function(e,t){t=t||!1;var r=new o;return r.beginElement(t?"container":"widget"),e.name&&(r.beginElement("name"),r.text(e.name),r.endElement("name")),e["bb:contextItemName"]&&(r.beginElement("contextItemName"),r.text(e["bb:contextItemName"]),r.endElement("contextItemName")),e["bb:extendedItemName"]&&(r.beginElement("extendedItemName"),r.text(e["bb:extendedItemName"]),r.endElement("extendedItemName")),e["bb:parentItemName"]&&(r.beginElement("parentItemName"),r.text(e["bb:parentItemName"]),r.endElement("parentItemName")),r.beginElement("properties"),n(r,e,t),r.endElement("properties"),e["bb:tags"]&&e["bb:tags"].length>0&&(r.beginElement("tags"),e["bb:tags"].forEach(function(e){r.beginElement("tag",{type:e.type}),r.text(e.name),r.endElement("tag")}),r.endElement("tags")),e.id&&(r.beginElement("uuid"),r.text(e.id),r.endElement("uuid")),r.endElement(t?"container":"widget"),r.toString()}},{"./xml-builder":207}],207:[function(e,t,r){"use strict";function n(){this.xml='<?xml version="1.0" encoding="UTF-8" standalone="yes"?>'}t.exports=n,n.prototype.beginElement=function(e,t){var r="";t&&(r=Object.keys(t).reduce(function(e,r){return e+" "+r+'="'+t[r]+'"'},"")),this.xml+="<"+e+r+">"},n.prototype.endElement=function(e){this.xml+="</"+e+">"},n.prototype.text=function(e){this.xml+=e},n.prototype.toString=function(){return this.xml}},{}],208:[function(e,t,r){"use strict";function n(e,r){var n="generate"+r[0].toUpperCase()+r.substr(1);return t.exports[n](e)}function i(e){return s(e,!0)}var o=e("./widget-preferences-generator"),s=e("./widget-xml-generator");t.exports={generate:n,generateWidget:s,generateContainer:i,generateWidgetPreferences:o}},{"./widget-preferences-generator":205,"./widget-xml-generator":206}],209:[function(e,t,r){"use strict";function n(e){var t={};e.descendantWithPath("properties").eachChild(function(e){t[e.attr.name]=e.children[0].val});var r=t.itemType;"menuHeader"===r&&(r="LINK");var l={itemType:r,children:[],title:t.title,name:e.valueWithPath("name"),locale:e.valueWithPath("locale")||u.defaultLocale};switch(l.id=e.valueWithPath("uuid"),r){case"LINK":i(e,l,t);break;case"divider":s(e,l,t);break;case"page":o(e,l,t);break;case"externalLink":a(e,l,t);break;case"redirect":c(e,l,t)}return l.children=e.descendantWithPath("children").children.map(function(e){return n(e)}),l}function i(e,t,r){t.navPattern=null}function o(e,t,r){t.itemRef=r.ItemRef,t.href=r.generatedUrl,r.Url&&(t.url=r.Url),t.generatedUrl=r.generatedUrl}function s(e,t,r){t.className=r.className}function a(e,t,r){t.url=r.Url}function c(e,t,r){t.redirectionMethod=r.redirectionMethod,t.url=r.Url,t.targetPage=r.targetPage}var u=e("../core/locale");t.exports={parse:n}},{"../core/locale":200}],210:[function(e,t,r){"use strict";function n(e){var t={viewmodes:[],children:[]},r=e.descendantWithPath(a.properties),n={};t.preferences=[],r.eachChild(function(e){var r=e.attr.name.trim(),i="true"===e.attr.readonly,o=e.childNamed("value"),a="contentRef"===o.attr.type||"linkRef"===o.attr.type,c=o.val||"";if(c=c.trim(),n[r]=c,!(s.indexOf(r)>=0)){var u={name:r[0].toLowerCase()+r.substr(1),value:c,readonly:i};a&&(u["bb.type"]=o.attr.type),t.preferences.push(u)}}),t.id=e.valueWithPath(a.id),t.name=e.valueWithPath(a.name).trim(),t.title=n[o.title],t.shortName=n[o.shortName],t.description=n[o.description],t.locale=e.valueWithPath(a.locale)||i.defaultLocale,t.dir=e.valueWithPath(a.dir)||i.getDirection(t.locale),t.securityProfile=e.valueWithPath(a.securityProfile),t.lockState=e.valueWithPath(a.lockState);var c=e.valueWithPath(a.manageable);c&&(t.manageable="true"===c.toLowerCase()),t.icons=[],n[o.thumbnailUrl]&&t.icons.push(n[o.thumbnailUrl]),n[o.icon]&&t.icons.push(n[o.icon]),t.tags=[];var u=e.descendantWithPath(a.tags);return u&&u.eachChild(function(e,r,n){t.tags.push({type:e.attr.type,name:e.val.trim()})}),t}var i=e("../core/locale");t.exports={parse:n};var o={description:"Description",title:"title",shortName:"shortName",thumbnailUrl:"thumbnailUrl",icon:"icon"},s=[o.description,o.shortName,o.thumbnailUrl,o.icon],a={id:"uuid",properties:"properties",name:"name",tags:"tags",locale:"locale",dir:"dir",securityProfile:"securityProfile",lockState:"lockState",manageable:"manageable"}},{"../core/locale":200}],211:[function(e,t,r){"use strict";function n(e){return e.childrenNamed("link").map(i.parse)}var i=e("./link-xml-parser");t.exports={parse:n}},{"./link-xml-parser":209}],212:[function(e,t,r){"use strict";function n(e,t){var r={type:e.name,content:{src:"",type:"text/html",encoding:"UTF-8"},"bb:settingsContent":{src:null}},u=e.descendantWithPath(c.properties),l={};r.preferences=[],u.eachChild(function(e){var t=e.attr.label?e.attr.label.trim():"",n=i(e.attr.viewHint),o=e.attr.name.trim(),s="true"===e.attr.readonly,c=e.childNamed("value"),u="contentRef"===c.attr.type||"linkRef"===c.attr.type,p=c.val||"";if(p=p.trim(),l[o]=p,!(a.indexOf(o)>=0)){var h={name:o[0].toLowerCase()+o.substr(1),value:p,readonly:s};u&&(h["bb.type"]=c.attr.type),t.length>0&&(h["bb:label"]=t),n&&(h["bb:viewhints"]=n),r.preferences.push(h)}}),r.id=e.valueWithPath(c.uuid)||null,r.name=e.valueWithPath(c.name)||"",r.title=l[s.title],r["bb:extendedItemName"]=e.valueWithPath(c.extendedItemName)||"",r["bb:parentItemName"]=e.valueWithPath(c.parentItemName)||"",r.shortName=l[s.shortName],r.description=l[s.description],r.author=l[s.author],r.authorEmail=l[s.authorEmail],r.authorHref=l[s.authorHref],r.license=l[s.license],r.licenseHref=l[s.licenseHref],r.locale=e.valueWithPath(c.locale)||o.defaultLocale,r.dir=e.valueWithPath(c.dir)||o.getDirection(r.locale),r["bb:securityProfile"]=e.valueWithPath(c.securityProfile),r["bb:lockState"]=e.valueWithPath(c.lockState);var p=e.valueWithPath(c.manageable);p&&(r["bb:manageable"]="true"===p.toLowerCase());var h=l[s.viewmodes],f=l[s.widgetChrome];h?r.viewmodes=h.split(/\s+/):f&&f.indexOf("widget_none")<0?r.viewmodes=["windowed"]:r.viewmodes=[],l[s.src]?r.content.src=l[s.src]:l[s.config]?r.content.src=l[s.config].replace("config.xml","index.html"):0===r["bb:extendedItemName"].indexOf("Manageable_Area_")&&(r.content.src="/manageable-area-index.html"),l[s.settingsContent]&&(r["bb:settingsContent"].src=l[s.settingsContent]),r.icons=[],l[s.thumbnailUrl]&&r.icons.push(l[s.thumbnailUrl]),l[s.icon]&&r.icons.push(l[s.icon]),l[s.isManageableArea]&&(r["bb:isManageableArea"]="true"===l[s.isManageableArea].toLowerCase()),r["bb:tags"]=[];var d=e.descendantWithPath(c.tags);d&&d.eachChild(function(e,t,n){r["bb:tags"].push({type:e.attr.type,name:e.val.trim()})});var g=e.descendantWithPath(c.children),m=null;return t&&g&&(r.children=[],m=g.children,m.sort(function(e,t){var r=e.descendantWithPath("properties").childWithAttribute("name","area").valueWithPath("value"),n=t.descendantWithPath("properties").childWithAttribute("name","area").valueWithPath("value");if(isNaN(parseFloat(r))||isNaN(parseFloat(n))?(r=r.toLowerCase(),n=n.toLowerCase()):(r=parseFloat(r),n=parseFloat(n)),n>r)return-1;if(r>n)return 1;var i=e.descendantWithPath("properties").childWithAttribute("name","order").valueWithPath("value"),o=t.descendantWithPath("properties").childWithAttribute("name","order").valueWithPath("value");return i=parseFloat(i),o=parseFloat(o),o>i?-1:i>o?1:0}),m.forEach(function(e){var t="container"===e.name;r.children.push(n(e,t))})),r}function i(e){if(!e||0===e.trim().length)return null;var t=e.split(/[,\s]/).filter(function(e){return e.trim().length>0});return t.length>0?t:[]}var o=e("../core/locale");t.exports={parse:n};var s={description:"Description",title:"title",shortName:"shortName",thumbnailUrl:"thumbnailUrl",icon:"icon",viewmodes:"viewmodes",author:"author",authorEmail:"authorEmail",authorHref:"authorHref",license:"license",licenseHref:"licenseHref",config:"config",src:"src",templateName:"TemplateName",order:"order",widgetChrome:"widgetChrome",settingsContent:"settingsSrc",isManageableArea:"isManageableArea"},a=[s.description,s.shortName,s.thumbnailUrl,s.icon,s.viewmodes,s.author,s.authorEmail,s.authorHref,s.license,s.licenseHref,s.templateName,s.widgetChrome,s.config,s.src,s.settingsContent,s.isManageableArea],c={properties:"properties",name:"name",extendedItemName:"extendedItemName",parentItemName:"parentItemName",tags:"tags",children:"children",uuid:"uuid",locale:"locale",dir:"dir",securityProfile:"securityProfile",lockState:"lockState",manageable:"manageable"}},{"../core/locale":200}],213:[function(e,t,r){"use strict";function n(e,r,n){var i="parse"+r[0].toUpperCase()+r.substr(1);return t.exports[i](e)}function i(e,t){var r=e.children;r.sort(function(e,t){var r=0,n=e.descendantWithPath("properties").childWithAttribute("name","area");n&&(r=n.valueWithPath("value"));var i=0,o=t.descendantWithPath("properties").childWithAttribute("name","area");if(o&&(i=o.valueWithPath("value")),isNaN(parseFloat(r))||isNaN(parseFloat(i))?(r=r.toLowerCase(),i=i.toLowerCase()):(r=parseFloat(r),i=parseFloat(i)),i>r)return-1;if(r>i)return 1;var s=e.descendantWithPath("properties").childWithAttribute("name","order").valueWithPath("value"),a=t.descendantWithPath("properties").childWithAttribute("name","order").valueWithPath("value");return s=parseFloat(s),a=parseFloat(a),a>s?-1:s>a?1:0}),r.forEach(function(e,r,n){var i="container"===e.name;t.children.push(d.parse(e,i))})}function o(e){var t=new f(e),r=g.parse(t);return i(t.descendantWithPath("children"),r),r}function s(e){var t=new f(e),r=[];return t.eachChild(function(e){var t=o(e);r.push(t)}),r}function a(e,t){var r=new f(e);return d.parse(r,t)}function c(e){var t=new f(e),r=[];return t.eachChild(function(e){var t=d.parse(e);r.push(t)}),r}function u(e){return a(e,!0)}function l(e){return c(e,!0)}function p(e){var t=new f(e);return m.parse(t)}function h(e){var t=new f(e);return v.parse(t)}var f=e("xmldoc").XmlDocument,d=e("./widget-xml-parser"),g=e("./page-xml-parser"),m=e("./sitemap-xml-parser"),v=e("./link-xml-parser");t.exports={parse:n,parseLink:h,parseLinks:p,parsePage:o,parsePages:s,parseWidget:a,parseWidgets:c,parseContainer:u,parseContainers:l}},{"./link-xml-parser":209,"./page-xml-parser":210,"./sitemap-xml-parser":211,"./widget-xml-parser":212,xmldoc:89}],214:[function(e,t,r){"use strict";function n(e){o.apply(this,[e])}function i(e){return new n(e)}var o=e("../core/model"),s=e("./xml-item-context"),a=e("./xml-item-collection-context");t.exports={XmlCxpModel:n,createInstance:i},n.prototype=Object.create(o.prototype),n.prototype.items=function(e){return new a(this.config,this._cache,e)},n.prototype.item=function(e,t){return new s(this.config,this._cache,e,t)},n.prototype.itemById=function(e,t){return new s(this.config,this._cache,e,t,!0)}},{"../core/model":203,"./xml-item-collection-context":215,"./xml-item-context":216}],215:[function(e,t,r){"use strict";function n(e,t,r,n){s.call(this,e,t,r,n),this.apiConsumer=a.createInstance(this.config)}var i=e("../parsers/xml-parser"),o=e("../generators/xml-generator"),s=e("../core/item-collection-context"),a=e("../core/rest-api-consumer");t.exports=n,n.prototype=Object.create(s.prototype),n.prototype.get=function(){var e=this.config.get("portalName"),t="portals/"+e+"/"+this.type+"s",r=this._filter,n=this._requiredParams,o=[],s=[];r&&(o=["f="+r.name+"("+r.operator+")"+encodeURIComponent(r.value)]),this._requiredParams&&(s=Object.keys(n).map(function(e){return encodeURIComponent(e)+"="+encodeURIComponent(n[e])}));var a=o.concat(s).join("&");return t+=a.length>0?"?"+a:"",this.apiConsumer.get(t).then(function(e){return e.text()}).then(function(e){this.logger.info("Parsing %s",t);var r=i.parse(e,this.type+"s","container"===this.type);return this.logger.info("%s parsed successfully"),r}.bind(this))},n.prototype.filter=function(e,t,r){var i={name:e,value:t,operator:r||"eq"};return new n(this.config,this._cache,this.type,i)},n.prototype.create=function(e){var t=["bb:parentItemName","bb:extendedItemName"];t.forEach(function(t){if("undefined"==typeof e[t]||"string"!=typeof e[t]||0===e[t].length)throw new Error("ItemCollectionContext.create needs the model has the field named: "+t)});var r=this.config.get("portalName");e["bb:contextItemName"]=r;var n=o.generate(e,this.type),s="portals/"+r+"/"+this.type+"s";return this.apiConsumer.post(s,n).then(function(e){return e.text()}).then(function(e){this.logger.info("Parsing newly created item's xml");var t=i.parse(e,this.type,"container"===this.type);return this.logger.info("Newly created item parsed successfully"),t}.bind(this))}},{"../core/item-collection-context":198,"../core/rest-api-consumer":204,"../generators/xml-generator":208,"../parsers/xml-parser":213}],216:[function(e,t,r){"use strict";function n(e,t,r,n,i){a.call(this,e,t,r,n,i),this.apiConsumer=s.createInstance(this.config)}var i=e("../parsers/xml-parser"),o=e("../generators/xml-generator"),s=e("../core/rest-api-consumer"),a=e("../core/item-context");t.exports=n,n.prototype=Object.create(a.prototype),n.prototype.get=function(e){return e&&this._cache.remove(this.itemType,this.itemName),this.findById?this._getItemById():this._getItemByName()},n.prototype._buildParams=function(){return Object.keys(this._requiredParams).map(function(e){return encodeURIComponent(e)+"="+encodeURIComponent(this._requiredParams[e])}.bind(this)).join("&")},n.prototype._getItemByName=function(){var e=this.config.get("portalName"),t="portals/"+e+"/"+this.itemType+"s/"+this.itemName+".xml",r=this._buildParams();if(r.length>0&&(t+="?"+r),this._cache.get(this.itemType,this.itemName))return this._cache.get(this.itemType,this.itemName);var n=this.apiConsumer.get(t).then(function(e){return e.text()}).then(function(e){this.logger.info("Parsing widgets/%s.xml",this.itemName);var t=i.parse(e,this.itemType,"container"===this.itemType);return this.logger.info("widgets/%s.xml parsed successfully",this.itemName),this._cache.update(this.itemType,t.id,n),this._cache.update(this.itemType,t.name,n),t}.bind(this));return n},n.prototype._getItemById=function(){if(this._cache.get(this.itemType,this.itemName))return this._cache.get(this.itemType,this.itemName);var e=this.config.get("portalName"),t=encodeURIComponent(this.itemName),r="portals/"+e+"/"+this.itemType+"s?f=uuid(eq)"+t,n=this._buildParams();n.length>0&&(r+="&"+n);var o=this.apiConsumer.get(r).then(function(e){return e.text()}).then(function(e){this.logger.info("Parsing widgets?f=uuid(eq)%s",t);var r=i.parse(e,this.itemType+"s","container"===this.itemType),n=r[0];return this.logger.info("widgets?f=uuid(eq)%s parsed succesfully",t),this._cache.update(this.itemType,n.id,o),this._cache.update(this.itemType,n.name,o),n}.bind(this));return o},n.prototype.update=function(e){var t=this.config.get("portalName"),r="portals/"+t+"/"+this.itemType+"s/"+this.itemName,n=o.generate(e,this.itemType);return this.apiConsumer.put(r,n).then(function(e){return e.text()}).then(function(t){this._cache.remove(this.itemType,e.id),this._cache.remove(this.itemType,e.name),this.logger.info("%s named %s updated successfully",this.itemType,this.itemName)}.bind(this))},n.prototype.remove=function(){var e=this.config.get("portalName"),t="portals/"+e+"/"+this.itemType+"s/"+this.itemName;return this.apiConsumer["delete"](t).then(function(){this._cache.remove(this.itemType,this.itemName)}.bind(this))}},{"../core/item-context":199,"../core/rest-api-consumer":204,"../generators/xml-generator":208,"../parsers/xml-parser":213}],217:[function(e,t,r){"use strict";function n(e){this.config=e}var i=e("util"),o=e("events").EventEmitter,s=null;t.exports={getInstance:function(e){return s=s||new n(e)}},i.inherits(n,o),n.prototype.init=function(e){this.sitemap=e},n.prototype._findLinkModel=function(e){return this._findInLinks(function(t){return t.generatedUrl===e||t.href===e||t.url===e},this.sitemap)},n.prototype._findInLinks=function(e,t){for(var r=this,n=null,i=t.length,o=0;i>o;o++){var s=t[o];if(e(s)){n=s;break}var a=r._findInLinks(e,s.children);if(a){n=a;break}}return n},n.prototype.notify=function(e){var t=this._findLinkModel(e);return null===t?void this.emit("error",{href:e}):void this.emit("navigate",t)}},{events:90,util:99}],218:[function(e,t,r){(function(r,n){"use strict";function i(){return{locate:function(t,r){var n=e("backbase-widget-engine/src/exports/portal-kit"),i=t.children?n.ContainerEngine:n.WidgetEngine,o=new i({log:r.log});return o.init({widgetUrl:r.widgetUrl,widgetEl:r.widgetEl,initialModel:t,configVars:r.configVars||{}}),o}}}r.env.Q_DEBUG=n.Q_DEBUG||!1;var o=e("./strategies/html5-item-renderer"),s=function(e){return e.get("itemEngineLocator")||e.set("itemEngineLocator",i()),e.get("contextRoot")||e.set("contextRoot",""),e.get("remoteContextRoot")||e.set("remoteContextRoot",""),new o(e)};s.Q=e("q"),t.exports={createInstance:s}}).call(this,e("_process"),"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"./strategies/html5-item-renderer":220,_process:92,"backbase-widget-engine/src/exports/portal-kit":116,q:223}],219:[function(e,t,r){"use strict";t.exports={allowViewmode:function(e,t){var r="none",n=this.viewmodes||[],i=e.toLowerCase(),o=n[0]||r,s=!1,a=i!==r&&o!==r&&n.indexOf(i)>-1&&i!==o;if(a){var c=[["windowed","maximized"],["windowed","minimized"],["windowed","fullscreen"],["maximized","minimized"],["maximized","fullscreen"]];s=c.some(function(e){return e.indexOf(i)>-1&&e.indexOf(o)>-1})}return a&&s?t.fn(this):t.inverse(this)},hasViewmode:function(e,t){var r=this.viewmodes||[],n=e?e.toLowerCase():"";return r.indexOf(n)>-1?t.fn(this):t.inverse(this)},currentViewmode:function(){return this.viewmodes&&this.viewmodes.length?this.viewmodes[0]:"none"},allowEdit:function(){var e=Array.prototype.slice.call(arguments),t=e.pop(),r=e,n=this.preferences.some(function(e){var t=e["bb:viewhints"]||[];return t.some(function(e){return r.indexOf(e)>-1})});return n?t.fn(this):t.inverse(this)},currentViewmodeIs:function(e,t){return this.viewmodes&&this.viewmodes[0]===e?t.fn(this):t.inverse(this)}}},{}],220:[function(e,t,r){(function(r){"use strict";var n=e("q"),i=e("fetchify")(n.Promise).fetch,o=e("browser-bunyan"),s=e("../../util")._,a=e("handlebars/dist/handlebars.min"),c=e("./chrome-helpers"),u=["windowed","maximized"],l={},p=a.create();Object.keys(c).forEach(function(e){p.registerHelper(e,c[e])});var h=function(e){if(this.config=e,!this.config.get("itemEngineLocator"))throw new Error("You must provide an item engine locator");this.log=e.getLogger().child({childName:"html5-item-renderer"}),this.plugins=[],this.features=[],this._widgetEngines=[]};t.exports=h,h.prototype.start=function(e,t,r){r=r||{};var i=this.log,a=this;i.info("Starting item tree rendering..."),i.level()<=o.TRACE&&i.trace("Item tree model is this:\n %s",JSON.stringify(e,null,"	"));for(var c=Date.now();t.firstChild;)t.removeChild(t.firstChild);var u=s.isArray(e)?e:[e],l=r.useChrome!==!1?a._loadChromeTemplate(a.config.get("chromeUri")):n(null);return l.then(function(e){var r=[];return u.forEach(function(n){var i=a._createChromeNode(n,t,e);r.push(a._renderItem(n,i,{chromeTemplate:e}))}),n.allSettled(r)}).then(function(e){i.info("Item tree rendering complete.");var t=Date.now()-c,r={time:t,failures:[]};r=e.reduce(function(e,t){if("rejected"===t.state){var r="function"==typeof t.reason.cause?t.reason.cause():t.reason;e.failures.push(r)}return e},r);var n=r.failures.length;if(n>0&&i.warn("%s/%s items failed to load.",n,e.length),n===e.length){var o=new Error("All items in a rendering tree failed to render");throw o.result=r,o}return r})},h.prototype.addFeature=function(e){return"object"==typeof e&&this.features.push(e),this},h.prototype.addPlugin=function(e){return"object"==typeof e&&this.plugins.push(e),this},h.prototype._renderItem=function(e,t,r){var i=this,o=this.config.get("itemEngineLocator"),s=e.content?e.content.src.replace(/\/[^\/]+$/,""):"";s=s.replace(/\$\(contextRoot\)/,this.config.get("contextRoot"));var a=o.locate(e,{widgetUrl:s,widgetEl:t,initialModel:e,locale:e.locale,configVars:{contextRoot:this.config.get("contextRoot")},log:this.log});this.plugins.forEach(function(e){"function"==typeof a.addPlugin&&a.addPlugin(e)}),this.features.forEach(function(e){"function"==typeof a.addFeature&&a.addFeature(e)});var c=a.start(e,t);return c.delay(0).then(function(t){i._widgetEngines.push(a);var o=[],s=t.areaNodes;if(s)for(var c in s)if(s.hasOwnProperty(c)){var u=e.children.filter(function(e){return i.config.util.getPreferenceValue(e,"area")===c});i.log.info("Rendering %s child item(s) for area [%s] of item [%s]...",u.length,c,t.id),u.forEach(function(e){var t=i._createChromeNode(e,s[c],r.chromeTemplate);o.push(i._renderItem(e,t,r))})}return n.all(o)})},h.prototype.destroyAllItems=function(){this._widgetEngines.forEach(function(e){e.destroy()}),this._widgetEngines=[]},h.prototype.destroyItem=function(e){var t=this._widgetEngines.filter(function(t){return t.widgetEngine.config.initialModel.id===e})[0];if(t){t.destroy();var r=this._widgetEngines.indexOf(t);this._widgetEngines.splice(r,1)}},h.prototype._createChromeNode=function(e,t,n){var i,o="data-widget-holder",s="*["+o+"]";if(n&&e.viewmodes&&u.indexOf(e.viewmodes[0])>=0){var a=n(e);t.insertAdjacentHTML||(t.insertAdjacentHTML=function(e,r){var n,i=this.ownerDocument.createElement("div");for(i.innerHTML=r;n=i.firstChild;)t.appendChild(n)});var c=r.document.createElement("div");if(c.innerHTML=a,c.querySelector(s)){t.insertAdjacentHTML("beforeend",a);var l=t.querySelectorAll(s);i=l[l.length-1]}else this.log.warn('Chrome layout doesn\'t have an element with "data-widget-holder" attribute. Falling back to blank chrome.')}return i||(i=r.document.createElement("div"),i.setAttribute("data-chrome",e.name),i.setAttribute(o,""),t.appendChild(i)),i},h.prototype._loadChromeTemplate=function(e){if(!e){var t="No chrome template is defined. Widgets with 'windowed' or 'maximized' viewmodes will not be displayed with chrome";return this.log.warn(t),n(null)}var r=this.config.get("contextRoot"),o=e.replace(/\$\(contextRoot\)/,r),s=this.log,a=l[o];return a||(s.debug("Requesting chrome template from %s",o),a=i(o).then(function(e){if(s.debug("Chrome template request resolved. Status: %s",e.status),0===e.status||200===e.status)return e._body;throw new Error(e.statusText)}).then(function(e){s.trace("Chrome template body\n: %s",e),s.debug("Compiling handlebars template instance from %s",o);try{return p.compile(e)}catch(t){throw s.error("There was a problem compiling a handlebars template"),t}})["catch"](function(e){return s.error(e),delete l[o],null}),l[o]=a),a}}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"../../util":221,"./chrome-helpers":219,"browser-bunyan":135,fetchify:136,"handlebars/dist/handlebars.min":137,q:223}],221:[function(e,t,r){"use strict";t.exports._={isArray:e("lodash/lang/isArray"),isObject:e("lodash/lang/isObject"),merge:e("lodash/object/merge")}},{"lodash/lang/isArray":181,"lodash/lang/isObject":184,"lodash/object/merge":190}],222:[function(e,t,r){!function(){function e(e){var t=e.__resizeTriggers__,r=t.firstElementChild,n=t.lastElementChild,i=r.firstElementChild;n.scrollLeft=n.scrollWidth,n.scrollTop=n.scrollHeight,i.style.width=r.offsetWidth+1+"px",i.style.height=r.offsetHeight+1+"px",r.scrollLeft=r.scrollWidth,r.scrollTop=r.scrollHeight}function t(e){return e.offsetWidth!=e.__resizeLast__.width||e.offsetHeight!=e.__resizeLast__.height}function r(r){var n=this;e(this),this.__resizeRAF__&&a(this.__resizeRAF__),this.__resizeRAF__=s(function(){t(n)&&(n.__resizeLast__.width=n.offsetWidth,n.__resizeLast__.height=n.offsetHeight,n.__resizeListeners__.forEach(function(e){e.call(n,r)}))})}function n(){if(!o){var e=(y?y:"")+".resize-triggers { "+(b?b:"")+'visibility: hidden; opacity: 0; } .resize-triggers, .resize-triggers > div, .contract-trigger:before { content: " "; display: block; position: absolute; top: 0; left: 0; height: 100%; width: 100%; overflow: hidden; } .resize-triggers > div { background: #eee; overflow: auto; } .contract-trigger:before { width: 200%; height: 200%; }',t=document.head||document.getElementsByTagName("head")[0],r=document.createElement("style");r.type="text/css",r.styleSheet?r.styleSheet.cssText=e:r.appendChild(document.createTextNode(e)),t.appendChild(r),o=!0}}var i=document.attachEvent,o=!1;if(!i){var s=function(){var e=window.requestAnimationFrame||window.mozRequestAnimationFrame||window.webkitRequestAnimationFrame||function(e){return window.setTimeout(e,20)};return function(t){return e(t)}}(),a=function(){var e=window.cancelAnimationFrame||window.mozCancelAnimationFrame||window.webkitCancelAnimationFrame||window.clearTimeout;return function(t){return e(t)}}(),c=!1,u="animation",l="",p="animationstart",h="Webkit Moz O ms".split(" "),f="webkitAnimationStart animationstart oAnimationStart MSAnimationStart".split(" "),d="",g=document.createElement("fakeelement");if(void 0!==g.style.animationName&&(c=!0),c===!1)for(var m=0;m<h.length;m++)if(void 0!==g.style[h[m]+"AnimationName"]){d=h[m],u=d+"Animation",l="-"+d.toLowerCase()+"-",p=f[m],c=!0;break}var v="resizeanim",y="@"+l+"keyframes "+v+" { from { opacity: 0; } to { opacity: 0; } } ",b=l+"animation: 1ms "+v+"; "}window.addResizeListener=function(t,o){i?t.attachEvent("onresize",o):(t.__resizeTriggers__||("static"==getComputedStyle(t).position&&(t.style.position="relative"),n(),t.__resizeLast__={},t.__resizeListeners__=[],(t.__resizeTriggers__=document.createElement("div")).className="resize-triggers",t.__resizeTriggers__.innerHTML='<div class="expand-trigger"><div></div></div><div class="contract-trigger"></div>',t.appendChild(t.__resizeTriggers__),e(t),t.addEventListener("scroll",r,!0),p&&t.__resizeTriggers__.addEventListener(p,function(r){r.animationName==v&&e(t)})),t.__resizeListeners__.push(o))},window.removeResizeListener=function(e,t){i?e.detachEvent("onresize",t):(e.__resizeListeners__.splice(e.__resizeListeners__.indexOf(t),1),e.__resizeListeners__.length||(e.removeEventListener("scroll",r),e.__resizeTriggers__=!e.removeChild(e.__resizeTriggers__)))}}()},{}],223:[function(e,t,r){(function(e){!function(e){"use strict";if("function"==typeof bootstrap)bootstrap("promise",e);else if("object"==typeof r&&"object"==typeof t)t.exports=e();else if("function"==typeof define&&define.amd)define(e);else if("undefined"!=typeof ses){if(!ses.ok())return;ses.makeQ=e}else{if("undefined"==typeof self)throw new Error("This environment was not anticiapted by Q. Please file a bug.");self.Q=e()}}(function(){"use strict";function t(e){return function(){return K.apply(e,arguments)}}function r(e){return e===Object(e)}function n(e){return"[object StopIteration]"===re(e)||e instanceof z}function i(e,t){if(H&&t.stack&&"object"==typeof e&&null!==e&&e.stack&&-1===e.stack.indexOf(ne)){for(var r=[],n=t;n;n=n.source)n.stack&&r.unshift(n.stack);r.unshift(e.stack);var i=r.join("\n"+ne+"\n");e.stack=o(i)}}function o(e){for(var t=e.split("\n"),r=[],n=0;n<t.length;++n){var i=t[n];c(i)||s(i)||!i||r.push(i)}return r.join("\n")}function s(e){return-1!==e.indexOf("(module.js:")||-1!==e.indexOf("(node.js:")}function a(e){var t=/at .+ \((.+):(\d+):(?:\d+)\)$/.exec(e);if(t)return[t[1],Number(t[2])];var r=/at ([^ ]+):(\d+):(?:\d+)$/.exec(e);if(r)return[r[1],Number(r[2])];var n=/.*@(.+):(\d+)$/.exec(e);return n?[n[1],Number(n[2])]:void 0}function c(e){var t=a(e);if(!t)return!1;var r=t[0],n=t[1];return r===q&&n>=$&&ae>=n}function u(){if(H)try{
throw new Error}catch(e){var t=e.stack.split("\n"),r=t[0].indexOf("@")>0?t[1]:t[2],n=a(r);if(!n)return;return q=n[0],n[1]}}function l(e,t,r){return function(){return"undefined"!=typeof console&&"function"==typeof console.warn&&console.warn(t+" is deprecated, use "+r+" instead.",new Error("").stack),e.apply(e,arguments)}}function p(e){return e instanceof g?e:b(e)?P(e):T(e)}function h(){function e(e){t=e,o.source=e,Y(r,function(t,r){p.nextTick(function(){e.promiseDispatch.apply(e,r)})},void 0),r=void 0,n=void 0}var t,r=[],n=[],i=Z(h.prototype),o=Z(g.prototype);if(o.promiseDispatch=function(e,i,o){var s=J(arguments);r?(r.push(s),"when"===i&&o[1]&&n.push(o[1])):p.nextTick(function(){t.promiseDispatch.apply(t,s)})},o.valueOf=function(){if(r)return o;var e=v(t);return y(e)&&(t=e),e},o.inspect=function(){return t?t.inspect():{state:"pending"}},p.longStackSupport&&H)try{throw new Error}catch(s){o.stack=s.stack.substring(s.stack.indexOf("\n")+1)}return i.promise=o,i.resolve=function(r){t||e(p(r))},i.fulfill=function(r){t||e(T(r))},i.reject=function(r){t||e(A(r))},i.notify=function(e){t||Y(n,function(t,r){p.nextTick(function(){r(e)})},void 0)},i}function f(e){if("function"!=typeof e)throw new TypeError("resolver must be a function.");var t=h();try{e(t.resolve,t.reject,t.notify)}catch(r){t.reject(r)}return t.promise}function d(e){return f(function(t,r){for(var n=0,i=e.length;i>n;n++)p(e[n]).then(t,r)})}function g(e,t,r){void 0===t&&(t=function(e){return A(new Error("Promise does not support operation: "+e))}),void 0===r&&(r=function(){return{state:"unknown"}});var n=Z(g.prototype);if(n.promiseDispatch=function(r,i,o){var s;try{s=e[i]?e[i].apply(n,o):t.call(n,i,o)}catch(a){s=A(a)}r&&r(s)},n.inspect=r,r){var i=r();"rejected"===i.state&&(n.exception=i.reason),n.valueOf=function(){var e=r();return"pending"===e.state||"rejected"===e.state?n:e.value}}return n}function m(e,t,r,n){return p(e).then(t,r,n)}function v(e){if(y(e)){var t=e.inspect();if("fulfilled"===t.state)return t.value}return e}function y(e){return e instanceof g}function b(e){return r(e)&&"function"==typeof e.then}function w(e){return y(e)&&"pending"===e.inspect().state}function E(e){return!y(e)||"fulfilled"===e.inspect().state}function x(e){return y(e)&&"rejected"===e.inspect().state}function _(){ie.length=0,oe.length=0,se||(se=!0)}function k(e,t){se&&(oe.push(e),t&&"undefined"!=typeof t.stack?ie.push(t.stack):ie.push("(no stack) "+t))}function S(e){if(se){var t=Q(oe,e);-1!==t&&(oe.splice(t,1),ie.splice(t,1))}}function A(e){var t=g({when:function(t){return t&&S(this),t?t(e):this}},function(){return this},function(){return{state:"rejected",reason:e}});return k(t,e),t}function T(e){return g({when:function(){return e},get:function(t){return e[t]},set:function(t,r){e[t]=r},"delete":function(t){delete e[t]},post:function(t,r){return null===t||void 0===t?e.apply(void 0,r):e[t].apply(e,r)},apply:function(t,r){return e.apply(t,r)},keys:function(){return te(e)}},void 0,function(){return{state:"fulfilled",value:e}})}function P(e){var t=h();return p.nextTick(function(){try{e.then(t.resolve,t.reject,t.notify)}catch(r){t.reject(r)}}),t.promise}function N(e){return g({isDef:function(){}},function(t,r){return C(e,t,r)},function(){return p(e).inspect()})}function I(e,t,r){return p(e).spread(t,r)}function O(e){return function(){function t(e,t){var s;if("undefined"==typeof StopIteration){try{s=r[e](t)}catch(a){return A(a)}return s.done?p(s.value):m(s.value,i,o)}try{s=r[e](t)}catch(a){return n(a)?p(a.value):A(a)}return m(s,i,o)}var r=e.apply(this,arguments),i=t.bind(t,"next"),o=t.bind(t,"throw");return i()}}function R(e){p.done(p.async(e)())}function L(e){throw new z(e)}function j(e){return function(){return I([this,M(arguments)],function(t,r){return e.apply(t,r)})}}function C(e,t,r){return p(e).dispatch(t,r)}function M(e){return m(e,function(e){var t=0,r=h();return Y(e,function(n,i,o){var s;y(i)&&"fulfilled"===(s=i.inspect()).state?e[o]=s.value:(++t,m(i,function(n){e[o]=n,0===--t&&r.resolve(e)},r.reject,function(e){r.notify({index:o,value:e})}))},void 0),0===t&&r.resolve(e),r.promise})}function U(e){return m(e,function(e){return e=X(e,p),m(M(X(e,function(e){return m(e,V,V)})),function(){return e})})}function F(e){return p(e).allSettled()}function D(e,t){return p(e).then(void 0,void 0,t)}function B(e,t){return p(e).nodeify(t)}var H=!1;try{throw new Error}catch(W){H=!!W.stack}var q,z,$=u(),V=function(){},G=function(){function t(){for(;r.next;){r=r.next;var e=r.task;r.task=void 0;var n=r.domain;n&&(r.domain=void 0,n.enter());try{e()}catch(o){if(s)throw n&&n.exit(),setTimeout(t,0),n&&n.enter(),o;setTimeout(function(){throw o},0)}n&&n.exit()}i=!1}var r={task:void 0,next:null},n=r,i=!1,o=void 0,s=!1;if(G=function(t){n=n.next={task:t,domain:s&&e.domain,next:null},i||(i=!0,o())},"undefined"!=typeof e&&e.nextTick)s=!0,o=function(){e.nextTick(t)};else if("function"==typeof setImmediate)o="undefined"!=typeof window?setImmediate.bind(window,t):function(){setImmediate(t)};else if("undefined"!=typeof MessageChannel){var a=new MessageChannel;a.port1.onmessage=function(){o=c,a.port1.onmessage=t,t()};var c=function(){a.port2.postMessage(0)};o=function(){setTimeout(t,0),c()}}else o=function(){setTimeout(t,0)};return G}(),K=Function.call,J=t(Array.prototype.slice),Y=t(Array.prototype.reduce||function(e,t){var r=0,n=this.length;if(1===arguments.length)for(;;){if(r in this){t=this[r++];break}if(++r>=n)throw new TypeError}for(;n>r;r++)r in this&&(t=e(t,this[r],r));return t}),Q=t(Array.prototype.indexOf||function(e){for(var t=0;t<this.length;t++)if(this[t]===e)return t;return-1}),X=t(Array.prototype.map||function(e,t){var r=this,n=[];return Y(r,function(i,o,s){n.push(e.call(t,o,s,r))},void 0),n}),Z=Object.create||function(e){function t(){}return t.prototype=e,new t},ee=t(Object.prototype.hasOwnProperty),te=Object.keys||function(e){var t=[];for(var r in e)ee(e,r)&&t.push(r);return t},re=t(Object.prototype.toString);z="undefined"!=typeof ReturnValue?ReturnValue:function(e){this.value=e};var ne="From previous event:";p.resolve=p,p.nextTick=G,p.longStackSupport=!1,"object"==typeof e&&e&&e.env&&e.env.Q_DEBUG&&(p.longStackSupport=!0),p.defer=h,h.prototype.makeNodeResolver=function(){var e=this;return function(t,r){t?e.reject(t):arguments.length>2?e.resolve(J(arguments,1)):e.resolve(r)}},p.Promise=f,p.promise=f,f.race=d,f.all=M,f.reject=A,f.resolve=p,p.passByCopy=function(e){return e},g.prototype.passByCopy=function(){return this},p.join=function(e,t){return p(e).join(t)},g.prototype.join=function(e){return p([this,e]).spread(function(e,t){if(e===t)return e;throw new Error("Can't join: not the same: "+e+" "+t)})},p.race=d,g.prototype.race=function(){return this.then(p.race)},p.makePromise=g,g.prototype.toString=function(){return"[object Promise]"},g.prototype.then=function(e,t,r){function n(t){try{return"function"==typeof e?e(t):t}catch(r){return A(r)}}function o(e){if("function"==typeof t){i(e,a);try{return t(e)}catch(r){return A(r)}}return A(e)}function s(e){return"function"==typeof r?r(e):e}var a=this,c=h(),u=!1;return p.nextTick(function(){a.promiseDispatch(function(e){u||(u=!0,c.resolve(n(e)))},"when",[function(e){u||(u=!0,c.resolve(o(e)))}])}),a.promiseDispatch(void 0,"when",[void 0,function(e){var t,r=!1;try{t=s(e)}catch(n){if(r=!0,!p.onerror)throw n;p.onerror(n)}r||c.notify(t)}]),c.promise},p.tap=function(e,t){return p(e).tap(t)},g.prototype.tap=function(e){return e=p(e),this.then(function(t){return e.fcall(t).thenResolve(t)})},p.when=m,g.prototype.thenResolve=function(e){return this.then(function(){return e})},p.thenResolve=function(e,t){return p(e).thenResolve(t)},g.prototype.thenReject=function(e){return this.then(function(){throw e})},p.thenReject=function(e,t){return p(e).thenReject(t)},p.nearer=v,p.isPromise=y,p.isPromiseAlike=b,p.isPending=w,g.prototype.isPending=function(){return"pending"===this.inspect().state},p.isFulfilled=E,g.prototype.isFulfilled=function(){return"fulfilled"===this.inspect().state},p.isRejected=x,g.prototype.isRejected=function(){return"rejected"===this.inspect().state};var ie=[],oe=[],se=!0;p.resetUnhandledRejections=_,p.getUnhandledReasons=function(){return ie.slice()},p.stopUnhandledRejectionTracking=function(){_(),se=!1},_(),p.reject=A,p.fulfill=T,p.master=N,p.spread=I,g.prototype.spread=function(e,t){return this.all().then(function(t){return e.apply(void 0,t)},t)},p.async=O,p.spawn=R,p["return"]=L,p.promised=j,p.dispatch=C,g.prototype.dispatch=function(e,t){var r=this,n=h();return p.nextTick(function(){r.promiseDispatch(n.resolve,e,t)}),n.promise},p.get=function(e,t){return p(e).dispatch("get",[t])},g.prototype.get=function(e){return this.dispatch("get",[e])},p.set=function(e,t,r){return p(e).dispatch("set",[t,r])},g.prototype.set=function(e,t){return this.dispatch("set",[e,t])},p.del=p["delete"]=function(e,t){return p(e).dispatch("delete",[t])},g.prototype.del=g.prototype["delete"]=function(e){return this.dispatch("delete",[e])},p.mapply=p.post=function(e,t,r){return p(e).dispatch("post",[t,r])},g.prototype.mapply=g.prototype.post=function(e,t){return this.dispatch("post",[e,t])},p.send=p.mcall=p.invoke=function(e,t){return p(e).dispatch("post",[t,J(arguments,2)])},g.prototype.send=g.prototype.mcall=g.prototype.invoke=function(e){return this.dispatch("post",[e,J(arguments,1)])},p.fapply=function(e,t){return p(e).dispatch("apply",[void 0,t])},g.prototype.fapply=function(e){return this.dispatch("apply",[void 0,e])},p["try"]=p.fcall=function(e){return p(e).dispatch("apply",[void 0,J(arguments,1)])},g.prototype.fcall=function(){return this.dispatch("apply",[void 0,J(arguments)])},p.fbind=function(e){var t=p(e),r=J(arguments,1);return function(){return t.dispatch("apply",[this,r.concat(J(arguments))])}},g.prototype.fbind=function(){var e=this,t=J(arguments);return function(){return e.dispatch("apply",[this,t.concat(J(arguments))])}},p.keys=function(e){return p(e).dispatch("keys",[])},g.prototype.keys=function(){return this.dispatch("keys",[])},p.all=M,g.prototype.all=function(){return M(this)},p.allResolved=l(U,"allResolved","allSettled"),g.prototype.allResolved=function(){return U(this)},p.allSettled=F,g.prototype.allSettled=function(){return this.then(function(e){return M(X(e,function(e){function t(){return e.inspect()}return e=p(e),e.then(t,t)}))})},p.fail=p["catch"]=function(e,t){return p(e).then(void 0,t)},g.prototype.fail=g.prototype["catch"]=function(e){return this.then(void 0,e)},p.progress=D,g.prototype.progress=function(e){return this.then(void 0,void 0,e)},p.fin=p["finally"]=function(e,t){return p(e)["finally"](t)},g.prototype.fin=g.prototype["finally"]=function(e){return e=p(e),this.then(function(t){return e.fcall().then(function(){return t})},function(t){return e.fcall().then(function(){throw t})})},p.done=function(e,t,r,n){return p(e).done(t,r,n)},g.prototype.done=function(t,r,n){var o=function(e){p.nextTick(function(){if(i(e,s),!p.onerror)throw e;p.onerror(e)})},s=t||r||n?this.then(t,r,n):this;"object"==typeof e&&e&&e.domain&&(o=e.domain.bind(o)),s.then(void 0,o)},p.timeout=function(e,t,r){return p(e).timeout(t,r)},g.prototype.timeout=function(e,t){var r=h(),n=setTimeout(function(){t&&"string"!=typeof t||(t=new Error(t||"Timed out after "+e+" ms"),t.code="ETIMEDOUT"),r.reject(t)},e);return this.then(function(e){clearTimeout(n),r.resolve(e)},function(e){clearTimeout(n),r.reject(e)},r.notify),r.promise},p.delay=function(e,t){return void 0===t&&(t=e,e=void 0),p(e).delay(t)},g.prototype.delay=function(e){return this.then(function(t){var r=h();return setTimeout(function(){r.resolve(t)},e),r.promise})},p.nfapply=function(e,t){return p(e).nfapply(t)},g.prototype.nfapply=function(e){var t=h(),r=J(e);return r.push(t.makeNodeResolver()),this.fapply(r).fail(t.reject),t.promise},p.nfcall=function(e){var t=J(arguments,1);return p(e).nfapply(t)},g.prototype.nfcall=function(){var e=J(arguments),t=h();return e.push(t.makeNodeResolver()),this.fapply(e).fail(t.reject),t.promise},p.nfbind=p.denodeify=function(e){var t=J(arguments,1);return function(){var r=t.concat(J(arguments)),n=h();return r.push(n.makeNodeResolver()),p(e).fapply(r).fail(n.reject),n.promise}},g.prototype.nfbind=g.prototype.denodeify=function(){var e=J(arguments);return e.unshift(this),p.denodeify.apply(void 0,e)},p.nbind=function(e,t){var r=J(arguments,2);return function(){function n(){return e.apply(t,arguments)}var i=r.concat(J(arguments)),o=h();return i.push(o.makeNodeResolver()),p(n).fapply(i).fail(o.reject),o.promise}},g.prototype.nbind=function(){var e=J(arguments,0);return e.unshift(this),p.nbind.apply(void 0,e)},p.nmapply=p.npost=function(e,t,r){return p(e).npost(t,r)},g.prototype.nmapply=g.prototype.npost=function(e,t){var r=J(t||[]),n=h();return r.push(n.makeNodeResolver()),this.dispatch("post",[e,r]).fail(n.reject),n.promise},p.nsend=p.nmcall=p.ninvoke=function(e,t){var r=J(arguments,2),n=h();return r.push(n.makeNodeResolver()),p(e).dispatch("post",[t,r]).fail(n.reject),n.promise},g.prototype.nsend=g.prototype.nmcall=g.prototype.ninvoke=function(e){var t=J(arguments,1),r=h();return t.push(r.makeNodeResolver()),this.dispatch("post",[e,t]).fail(r.reject),r.promise},p.nodeify=B,g.prototype.nodeify=function(e){return e?void this.then(function(t){p.nextTick(function(){e(null,t)})},function(t){p.nextTick(function(){e(t)})}):this};var ae=u();return p})}).call(this,e("_process"))},{_process:92}]},{},[1]);
function BigInteger(t,r,e){null!=t&&("number"==typeof t?this.fromNumber(t,r,e):null==r&&"string"!=typeof t?this.fromString(t,256):this.fromString(t,r))}function nbi(){return new BigInteger(null)}function am1(t,r,e,n,i,o){for(;--o>=0;){var s=r*this[t++]+e[n]+i;i=Math.floor(s/67108864),e[n++]=67108863&s}return i}function am2(t,r,e,n,i,o){for(var s=32767&r,h=r>>15;--o>=0;){var a=32767&this[t],_=this[t++]>>15,S=h*a+_*s;a=s*a+((32767&S)<<15)+e[n]+(1073741823&i),i=(a>>>30)+(S>>>15)+h*_+(i>>>30),e[n++]=1073741823&a}return i}function am3(t,r,e,n,i,o){for(var s=16383&r,h=r>>14;--o>=0;){var a=16383&this[t],_=this[t++]>>14,S=h*a+_*s;a=s*a+((16383&S)<<14)+e[n]+i,i=(a>>28)+(S>>14)+h*_,e[n++]=268435455&a}return i}function int2char(t){return BI_RM.charAt(t)}function intAt(t,r){var e=BI_RC[t.charCodeAt(r)];return null==e?-1:e}function bnpCopyTo(t){for(var r=this.t-1;r>=0;--r)t[r]=this[r];t.t=this.t,t.s=this.s}function bnpFromInt(t){this.t=1,this.s=0>t?-1:0,t>0?this[0]=t:-1>t?this[0]=t+DV:this.t=0}function nbv(t){var r=nbi();return r.fromInt(t),r}function bnpFromString(t,r){var e;if(16==r)e=4;else if(8==r)e=3;else if(256==r)e=8;else if(2==r)e=1;else if(32==r)e=5;else{if(4!=r)return void this.fromRadix(t,r);e=2}this.t=0,this.s=0;for(var n=t.length,i=!1,o=0;--n>=0;){var s=8==e?255&t[n]:intAt(t,n);0>s?"-"==t.charAt(n)&&(i=!0):(i=!1,0==o?this[this.t++]=s:o+e>this.DB?(this[this.t-1]|=(s&(1<<this.DB-o)-1)<<o,this[this.t++]=s>>this.DB-o):this[this.t-1]|=s<<o,o+=e,o>=this.DB&&(o-=this.DB))}8==e&&0!=(128&t[0])&&(this.s=-1,o>0&&(this[this.t-1]|=(1<<this.DB-o)-1<<o)),this.clamp(),i&&BigInteger.ZERO.subTo(this,this)}function bnpClamp(){for(var t=this.s&this.DM;this.t>0&&this[this.t-1]==t;)--this.t}function bnToString(t){if(this.s<0)return"-"+this.negate().toString(t);var r;if(16==t)r=4;else if(8==t)r=3;else if(2==t)r=1;else if(32==t)r=5;else{if(4!=t)return this.toRadix(t);r=2}var e,n=(1<<r)-1,i=!1,o="",s=this.t,h=this.DB-s*this.DB%r;if(s-- >0)for(h<this.DB&&(e=this[s]>>h)>0&&(i=!0,o=int2char(e));s>=0;)r>h?(e=(this[s]&(1<<h)-1)<<r-h,e|=this[--s]>>(h+=this.DB-r)):(e=this[s]>>(h-=r)&n,0>=h&&(h+=this.DB,--s)),e>0&&(i=!0),i&&(o+=int2char(e));return i?o:"0"}function bnNegate(){var t=nbi();return BigInteger.ZERO.subTo(this,t),t}function bnAbs(){return this.s<0?this.negate():this}function bnCompareTo(t){var r=this.s-t.s;if(0!=r)return r;var e=this.t;if(r=e-t.t,0!=r)return r;for(;--e>=0;)if(0!=(r=this[e]-t[e]))return r;return 0}function nbits(t){var r,e=1;return 0!=(r=t>>>16)&&(t=r,e+=16),0!=(r=t>>8)&&(t=r,e+=8),0!=(r=t>>4)&&(t=r,e+=4),0!=(r=t>>2)&&(t=r,e+=2),0!=(r=t>>1)&&(t=r,e+=1),e}function bnBitLength(){return this.t<=0?0:this.DB*(this.t-1)+nbits(this[this.t-1]^this.s&this.DM)}function bnpDLShiftTo(t,r){var e;for(e=this.t-1;e>=0;--e)r[e+t]=this[e];for(e=t-1;e>=0;--e)r[e]=0;r.t=this.t+t,r.s=this.s}function bnpDRShiftTo(t,r){for(var e=t;e<this.t;++e)r[e-t]=this[e];r.t=Math.max(this.t-t,0),r.s=this.s}function bnpLShiftTo(t,r){var e,n=t%this.DB,i=this.DB-n,o=(1<<i)-1,s=Math.floor(t/this.DB),h=this.s<<n&this.DM;for(e=this.t-1;e>=0;--e)r[e+s+1]=this[e]>>i|h,h=(this[e]&o)<<n;for(e=s-1;e>=0;--e)r[e]=0;r[s]=h,r.t=this.t+s+1,r.s=this.s,r.clamp()}function bnpRShiftTo(t,r){r.s=this.s;var e=Math.floor(t/this.DB);if(e>=this.t)return void(r.t=0);var n=t%this.DB,i=this.DB-n,o=(1<<n)-1;r[0]=this[e]>>n;for(var s=e+1;s<this.t;++s)r[s-e-1]|=(this[s]&o)<<i,r[s-e]=this[s]>>n;n>0&&(r[this.t-e-1]|=(this.s&o)<<i),r.t=this.t-e,r.clamp()}function bnpSubTo(t,r){for(var e=0,n=0,i=Math.min(t.t,this.t);i>e;)n+=this[e]-t[e],r[e++]=n&this.DM,n>>=this.DB;if(t.t<this.t){for(n-=t.s;e<this.t;)n+=this[e],r[e++]=n&this.DM,n>>=this.DB;n+=this.s}else{for(n+=this.s;e<t.t;)n-=t[e],r[e++]=n&this.DM,n>>=this.DB;n-=t.s}r.s=0>n?-1:0,-1>n?r[e++]=this.DV+n:n>0&&(r[e++]=n),r.t=e,r.clamp()}function bnpMultiplyTo(t,r){var e=this.abs(),n=t.abs(),i=e.t;for(r.t=i+n.t;--i>=0;)r[i]=0;for(i=0;i<n.t;++i)r[i+e.t]=e.am(0,n[i],r,i,0,e.t);r.s=0,r.clamp(),this.s!=t.s&&BigInteger.ZERO.subTo(r,r)}function bnpSquareTo(t){for(var r=this.abs(),e=t.t=2*r.t;--e>=0;)t[e]=0;for(e=0;e<r.t-1;++e){var n=r.am(e,r[e],t,2*e,0,1);(t[e+r.t]+=r.am(e+1,2*r[e],t,2*e+1,n,r.t-e-1))>=r.DV&&(t[e+r.t]-=r.DV,t[e+r.t+1]=1)}t.t>0&&(t[t.t-1]+=r.am(e,r[e],t,2*e,0,1)),t.s=0,t.clamp()}function bnpDivRemTo(t,r,e){var n=t.abs();if(!(n.t<=0)){var i=this.abs();if(i.t<n.t)return null!=r&&r.fromInt(0),void(null!=e&&this.copyTo(e));null==e&&(e=nbi());var o=nbi(),s=this.s,h=t.s,a=this.DB-nbits(n[n.t-1]);a>0?(n.lShiftTo(a,o),i.lShiftTo(a,e)):(n.copyTo(o),i.copyTo(e));var _=o.t,S=o[_-1];if(0!=S){var u=S*(1<<this.F1)+(_>1?o[_-2]>>this.F2:0),E=this.FV/u,I=(1<<this.F1)/u,g=1<<this.F2,f=e.t,p=f-_,l=null==r?nbi():r;for(o.dlShiftTo(p,l),e.compareTo(l)>=0&&(e[e.t++]=1,e.subTo(l,e)),BigInteger.ONE.dlShiftTo(_,l),l.subTo(o,o);o.t<_;)o[o.t++]=0;for(;--p>=0;){var A=e[--f]==S?this.DM:Math.floor(e[f]*E+(e[f-1]+g)*I);if((e[f]+=o.am(0,A,e,p,0,_))<A)for(o.dlShiftTo(p,l),e.subTo(l,e);e[f]<--A;)e.subTo(l,e)}null!=r&&(e.drShiftTo(_,r),s!=h&&BigInteger.ZERO.subTo(r,r)),e.t=_,e.clamp(),a>0&&e.rShiftTo(a,e),0>s&&BigInteger.ZERO.subTo(e,e)}}}function bnMod(t){var r=nbi();return this.abs().divRemTo(t,null,r),this.s<0&&r.compareTo(BigInteger.ZERO)>0&&t.subTo(r,r),r}function Classic(t){this.m=t}function cConvert(t){return t.s<0||t.compareTo(this.m)>=0?t.mod(this.m):t}function cRevert(t){return t}function cReduce(t){t.divRemTo(this.m,null,t)}function cMulTo(t,r,e){t.multiplyTo(r,e),this.reduce(e)}function cSqrTo(t,r){t.squareTo(r),this.reduce(r)}function bnpInvDigit(){if(this.t<1)return 0;var t=this[0];if(0==(1&t))return 0;var r=3&t;return r=r*(2-(15&t)*r)&15,r=r*(2-(255&t)*r)&255,r=r*(2-((65535&t)*r&65535))&65535,r=r*(2-t*r%this.DV)%this.DV,r>0?this.DV-r:-r}function Montgomery(t){this.m=t,this.mp=t.invDigit(),this.mpl=32767&this.mp,this.mph=this.mp>>15,this.um=(1<<t.DB-15)-1,this.mt2=2*t.t}function montConvert(t){var r=nbi();return t.abs().dlShiftTo(this.m.t,r),r.divRemTo(this.m,null,r),t.s<0&&r.compareTo(BigInteger.ZERO)>0&&this.m.subTo(r,r),r}function montRevert(t){var r=nbi();return t.copyTo(r),this.reduce(r),r}function montReduce(t){for(;t.t<=this.mt2;)t[t.t++]=0;for(var r=0;r<this.m.t;++r){var e=32767&t[r],n=e*this.mpl+((e*this.mph+(t[r]>>15)*this.mpl&this.um)<<15)&t.DM;for(e=r+this.m.t,t[e]+=this.m.am(0,n,t,r,0,this.m.t);t[e]>=t.DV;)t[e]-=t.DV,t[++e]++}t.clamp(),t.drShiftTo(this.m.t,t),t.compareTo(this.m)>=0&&t.subTo(this.m,t)}function montSqrTo(t,r){t.squareTo(r),this.reduce(r)}function montMulTo(t,r,e){t.multiplyTo(r,e),this.reduce(e)}function bnpIsEven(){return 0==(this.t>0?1&this[0]:this.s)}function bnpExp(t,r){if(t>4294967295||1>t)return BigInteger.ONE;var e=nbi(),n=nbi(),i=r.convert(this),o=nbits(t)-1;for(i.copyTo(e);--o>=0;)if(r.sqrTo(e,n),(t&1<<o)>0)r.mulTo(n,i,e);else{var s=e;e=n,n=s}return r.revert(e)}function bnModPowInt(t,r){var e;return e=256>t||r.isEven()?new Classic(r):new Montgomery(r),this.exp(t,e)}function bnClone(){var t=nbi();return this.copyTo(t),t}function bnIntValue(){if(this.s<0){if(1==this.t)return this[0]-this.DV;if(0==this.t)return-1}else{if(1==this.t)return this[0];if(0==this.t)return 0}return(this[1]&(1<<32-this.DB)-1)<<this.DB|this[0]}function bnByteValue(){return 0==this.t?this.s:this[0]<<24>>24}function bnShortValue(){return 0==this.t?this.s:this[0]<<16>>16}function bnpChunkSize(t){return Math.floor(Math.LN2*this.DB/Math.log(t))}function bnSigNum(){return this.s<0?-1:this.t<=0||1==this.t&&this[0]<=0?0:1}function bnpToRadix(t){if(null==t&&(t=10),0==this.signum()||2>t||t>36)return"0";var r=this.chunkSize(t),e=Math.pow(t,r),n=nbv(e),i=nbi(),o=nbi(),s="";for(this.divRemTo(n,i,o);i.signum()>0;)s=(e+o.intValue()).toString(t).substr(1)+s,i.divRemTo(n,i,o);return o.intValue().toString(t)+s}function bnpFromRadix(t,r){this.fromInt(0),null==r&&(r=10);for(var e=this.chunkSize(r),n=Math.pow(r,e),i=!1,o=0,s=0,h=0;h<t.length;++h){var a=intAt(t,h);0>a?"-"==t.charAt(h)&&0==this.signum()&&(i=!0):(s=r*s+a,++o>=e&&(this.dMultiply(n),this.dAddOffset(s,0),o=0,s=0))}o>0&&(this.dMultiply(Math.pow(r,o)),this.dAddOffset(s,0)),i&&BigInteger.ZERO.subTo(this,this)}function bnpFromNumber(t,r,e){if("number"==typeof r)if(2>t)this.fromInt(1);else for(this.fromNumber(t,e),this.testBit(t-1)||this.bitwiseTo(BigInteger.ONE.shiftLeft(t-1),op_or,this),this.isEven()&&this.dAddOffset(1,0);!this.isProbablePrime(r);)this.dAddOffset(2,0),this.bitLength()>t&&this.subTo(BigInteger.ONE.shiftLeft(t-1),this);else{var n=new Array,i=7&t;n.length=(t>>3)+1,r.nextBytes(n),i>0?n[0]&=(1<<i)-1:n[0]=0,this.fromString(n,256)}}function bnToByteArray(){var t=this.t,r=new Array;r[0]=this.s;var e,n=this.DB-t*this.DB%8,i=0;if(t-- >0)for(n<this.DB&&(e=this[t]>>n)!=(this.s&this.DM)>>n&&(r[i++]=e|this.s<<this.DB-n);t>=0;)8>n?(e=(this[t]&(1<<n)-1)<<8-n,e|=this[--t]>>(n+=this.DB-8)):(e=this[t]>>(n-=8)&255,0>=n&&(n+=this.DB,--t)),0!=(128&e)&&(e|=-256),0==i&&(128&this.s)!=(128&e)&&++i,(i>0||e!=this.s)&&(r[i++]=e);return r}function bnEquals(t){return 0==this.compareTo(t)}function bnMin(t){return this.compareTo(t)<0?this:t}function bnMax(t){return this.compareTo(t)>0?this:t}function bnpBitwiseTo(t,r,e){var n,i,o=Math.min(t.t,this.t);for(n=0;o>n;++n)e[n]=r(this[n],t[n]);if(t.t<this.t){for(i=t.s&this.DM,n=o;n<this.t;++n)e[n]=r(this[n],i);e.t=this.t}else{for(i=this.s&this.DM,n=o;n<t.t;++n)e[n]=r(i,t[n]);e.t=t.t}e.s=r(this.s,t.s),e.clamp()}function op_and(t,r){return t&r}function bnAnd(t){var r=nbi();return this.bitwiseTo(t,op_and,r),r}function op_or(t,r){return t|r}function bnOr(t){var r=nbi();return this.bitwiseTo(t,op_or,r),r}function op_xor(t,r){return t^r}function bnXor(t){var r=nbi();return this.bitwiseTo(t,op_xor,r),r}function op_andnot(t,r){return t&~r}function bnAndNot(t){var r=nbi();return this.bitwiseTo(t,op_andnot,r),r}function bnNot(){for(var t=nbi(),r=0;r<this.t;++r)t[r]=this.DM&~this[r];return t.t=this.t,t.s=~this.s,t}function bnShiftLeft(t){var r=nbi();return 0>t?this.rShiftTo(-t,r):this.lShiftTo(t,r),r}function bnShiftRight(t){var r=nbi();return 0>t?this.lShiftTo(-t,r):this.rShiftTo(t,r),r}function lbit(t){if(0==t)return-1;var r=0;return 0==(65535&t)&&(t>>=16,r+=16),0==(255&t)&&(t>>=8,r+=8),0==(15&t)&&(t>>=4,r+=4),0==(3&t)&&(t>>=2,r+=2),0==(1&t)&&++r,r}function bnGetLowestSetBit(){for(var t=0;t<this.t;++t)if(0!=this[t])return t*this.DB+lbit(this[t]);return this.s<0?this.t*this.DB:-1}function cbit(t){for(var r=0;0!=t;)t&=t-1,++r;return r}function bnBitCount(){for(var t=0,r=this.s&this.DM,e=0;e<this.t;++e)t+=cbit(this[e]^r);return t}function bnTestBit(t){var r=Math.floor(t/this.DB);return r>=this.t?0!=this.s:0!=(this[r]&1<<t%this.DB)}function bnpChangeBit(t,r){var e=BigInteger.ONE.shiftLeft(t);return this.bitwiseTo(e,r,e),e}function bnSetBit(t){return this.changeBit(t,op_or)}function bnClearBit(t){return this.changeBit(t,op_andnot)}function bnFlipBit(t){return this.changeBit(t,op_xor)}function bnpAddTo(t,r){for(var e=0,n=0,i=Math.min(t.t,this.t);i>e;)n+=this[e]+t[e],r[e++]=n&this.DM,n>>=this.DB;if(t.t<this.t){for(n+=t.s;e<this.t;)n+=this[e],r[e++]=n&this.DM,n>>=this.DB;n+=this.s}else{for(n+=this.s;e<t.t;)n+=t[e],r[e++]=n&this.DM,n>>=this.DB;n+=t.s}r.s=0>n?-1:0,n>0?r[e++]=n:-1>n&&(r[e++]=this.DV+n),r.t=e,r.clamp()}function bnAdd(t){var r=nbi();return this.addTo(t,r),r}function bnSubtract(t){var r=nbi();return this.subTo(t,r),r}function bnMultiply(t){var r=nbi();return this.multiplyTo(t,r),r}function bnDivide(t){var r=nbi();return this.divRemTo(t,r,null),r}function bnRemainder(t){var r=nbi();return this.divRemTo(t,null,r),r}function bnDivideAndRemainder(t){var r=nbi(),e=nbi();return this.divRemTo(t,r,e),new Array(r,e)}function bnpDMultiply(t){this[this.t]=this.am(0,t-1,this,0,0,this.t),++this.t,this.clamp()}function bnpDAddOffset(t,r){if(0!=t){for(;this.t<=r;)this[this.t++]=0;for(this[r]+=t;this[r]>=this.DV;)this[r]-=this.DV,++r>=this.t&&(this[this.t++]=0),++this[r]}}function NullExp(){}function nNop(t){return t}function nMulTo(t,r,e){t.multiplyTo(r,e)}function nSqrTo(t,r){t.squareTo(r)}function bnPow(t){return this.exp(t,new NullExp)}function bnpMultiplyLowerTo(t,r,e){var n=Math.min(this.t+t.t,r);for(e.s=0,e.t=n;n>0;)e[--n]=0;var i;for(i=e.t-this.t;i>n;++n)e[n+this.t]=this.am(0,t[n],e,n,0,this.t);for(i=Math.min(t.t,r);i>n;++n)this.am(0,t[n],e,n,0,r-n);e.clamp()}function bnpMultiplyUpperTo(t,r,e){--r;var n=e.t=this.t+t.t-r;for(e.s=0;--n>=0;)e[n]=0;for(n=Math.max(r-this.t,0);n<t.t;++n)e[this.t+n-r]=this.am(r-n,t[n],e,0,0,this.t+n-r);e.clamp(),e.drShiftTo(1,e)}function Barrett(t){this.r2=nbi(),this.q3=nbi(),BigInteger.ONE.dlShiftTo(2*t.t,this.r2),this.mu=this.r2.divide(t),this.m=t}function barrettConvert(t){if(t.s<0||t.t>2*this.m.t)return t.mod(this.m);if(t.compareTo(this.m)<0)return t;var r=nbi();return t.copyTo(r),this.reduce(r),r}function barrettRevert(t){return t}function barrettReduce(t){for(t.drShiftTo(this.m.t-1,this.r2),t.t>this.m.t+1&&(t.t=this.m.t+1,t.clamp()),this.mu.multiplyUpperTo(this.r2,this.m.t+1,this.q3),this.m.multiplyLowerTo(this.q3,this.m.t+1,this.r2);t.compareTo(this.r2)<0;)t.dAddOffset(1,this.m.t+1);for(t.subTo(this.r2,t);t.compareTo(this.m)>=0;)t.subTo(this.m,t)}function barrettSqrTo(t,r){t.squareTo(r),this.reduce(r)}function barrettMulTo(t,r,e){t.multiplyTo(r,e),this.reduce(e)}function bnModPow(t,r){var e,n,i=t.bitLength(),o=nbv(1);if(0>=i)return o;e=18>i?1:48>i?3:144>i?4:768>i?5:6,n=8>i?new Classic(r):r.isEven()?new Barrett(r):new Montgomery(r);var s=new Array,h=3,a=e-1,_=(1<<e)-1;if(s[1]=n.convert(this),e>1){var S=nbi();for(n.sqrTo(s[1],S);_>=h;)s[h]=nbi(),n.mulTo(S,s[h-2],s[h]),h+=2}var u,E,I=t.t-1,g=!0,f=nbi();for(i=nbits(t[I])-1;I>=0;){for(i>=a?u=t[I]>>i-a&_:(u=(t[I]&(1<<i+1)-1)<<a-i,I>0&&(u|=t[I-1]>>this.DB+i-a)),h=e;0==(1&u);)u>>=1,--h;if((i-=h)<0&&(i+=this.DB,--I),g)s[u].copyTo(o),g=!1;else{for(;h>1;)n.sqrTo(o,f),n.sqrTo(f,o),h-=2;h>0?n.sqrTo(o,f):(E=o,o=f,f=E),n.mulTo(f,s[u],o)}for(;I>=0&&0==(t[I]&1<<i);)n.sqrTo(o,f),E=o,o=f,f=E,--i<0&&(i=this.DB-1,--I)}return n.revert(o)}function bnGCD(t){var r=this.s<0?this.negate():this.clone(),e=t.s<0?t.negate():t.clone();if(r.compareTo(e)<0){var n=r;r=e,e=n}var i=r.getLowestSetBit(),o=e.getLowestSetBit();if(0>o)return r;for(o>i&&(o=i),o>0&&(r.rShiftTo(o,r),e.rShiftTo(o,e));r.signum()>0;)(i=r.getLowestSetBit())>0&&r.rShiftTo(i,r),(i=e.getLowestSetBit())>0&&e.rShiftTo(i,e),r.compareTo(e)>=0?(r.subTo(e,r),r.rShiftTo(1,r)):(e.subTo(r,e),e.rShiftTo(1,e));return o>0&&e.lShiftTo(o,e),e}function bnpModInt(t){if(0>=t)return 0;var r=this.DV%t,e=this.s<0?t-1:0;if(this.t>0)if(0==r)e=this[0]%t;else for(var n=this.t-1;n>=0;--n)e=(r*e+this[n])%t;return e}function bnModInverse(t){var r=t.isEven();if(this.isEven()&&r||0==t.signum())return BigInteger.ZERO;for(var e=t.clone(),n=this.clone(),i=nbv(1),o=nbv(0),s=nbv(0),h=nbv(1);0!=e.signum();){for(;e.isEven();)e.rShiftTo(1,e),r?(i.isEven()&&o.isEven()||(i.addTo(this,i),o.subTo(t,o)),i.rShiftTo(1,i)):o.isEven()||o.subTo(t,o),o.rShiftTo(1,o);for(;n.isEven();)n.rShiftTo(1,n),r?(s.isEven()&&h.isEven()||(s.addTo(this,s),h.subTo(t,h)),s.rShiftTo(1,s)):h.isEven()||h.subTo(t,h),h.rShiftTo(1,h);e.compareTo(n)>=0?(e.subTo(n,e),r&&i.subTo(s,i),o.subTo(h,o)):(n.subTo(e,n),r&&s.subTo(i,s),h.subTo(o,h))}return 0!=n.compareTo(BigInteger.ONE)?BigInteger.ZERO:h.compareTo(t)>=0?h.subtract(t):h.signum()<0?(h.addTo(t,h),h.signum()<0?h.add(t):h):h}function bnIsProbablePrime(t){var r,e=this.abs();if(1==e.t&&e[0]<=lowprimes[lowprimes.length-1]){for(r=0;r<lowprimes.length;++r)if(e[0]==lowprimes[r])return!0;return!1}if(e.isEven())return!1;for(r=1;r<lowprimes.length;){for(var n=lowprimes[r],i=r+1;i<lowprimes.length&&lplim>n;)n*=lowprimes[i++];for(n=e.modInt(n);i>r;)if(n%lowprimes[r++]==0)return!1}return e.millerRabin(t)}function bnpMillerRabin(t){var r=this.subtract(BigInteger.ONE),e=r.getLowestSetBit();if(0>=e)return!1;var n=r.shiftRight(e);t=t+1>>1,t>lowprimes.length&&(t=lowprimes.length);for(var i=nbi(),o=0;t>o;++o){i.fromInt(lowprimes[o]);var s=i.modPow(n,this);if(0!=s.compareTo(BigInteger.ONE)&&0!=s.compareTo(r)){for(var h=1;h++<e&&0!=s.compareTo(r);)if(s=s.modPowInt(2,this),0==s.compareTo(BigInteger.ONE))return!1;if(0!=s.compareTo(r))return!1}}return!0}function EncryptedMessage(){this.n=null,this.e=0}function PINBlock(t){PinString=t}function aCopy(t,r,e,n,i){for(var o=0;i>o;o++)e[n]=t[r],r++,n++}function fillByteArray(t,r){var e,n;for(n=t.length,e=0;n>e;e++)t[e]="F"}function createFormat12PINBlock(t){var r=0;if(PINLength=t.length,r=6>=PINLength?1:Math.floor(2+(PINLength-7)/NUM_OF_BYTES_IN_FMT2_PIN_BLOCK),PINBlockLength=r*NUM_OF_BYTES_IN_FMT2_PIN_BLOCK*2,PINBlockByteArray=new Array(PINBlockLength),fillByteArray(PINBlockByteArray,PIN_BLOCK_FILL_CHARACTER),PINBlockByteArray[0]="C",PINBlockByteArray[1]="1",15>=PINLength)PINBlockByteArray[2]="0",PINBlockByteArray[3]=PINLength.toString(16);else if(PINLength>=16&&30>=PINLength){var e=PINLength.toString(16);PINBlockByteArray[2]=e.charAt(0),PINBlockByteArray[3]=e.charAt(1)}for(var n=s2hex(t),i=new Array,o=0;o<n.length;o++)i.push(n.charAt(o));aCopy(i,0,PINBlockByteArray,4,n.length)}function IsLetterOrDigit(t){var r=t.charCodeAt(0);return r>=48&&57>=r||r>=65&&90>=r||r>=97&&122>=r?!0:!1}function PINMessage(t,r,e){if(e.toLowerCase()=="SHA1".toLowerCase())MAX_MESSAGE_SIZE_IN_BYTES=RSA_MODULUS_SIZE_IN_BYTES-OAEP_SHA1_OFFSET_IN_BYTES;else if(e.toLowerCase()=="SHA2-256".toLowerCase())MAX_MESSAGE_SIZE_IN_BYTES=RSA_MODULUS_SIZE_IN_BYTES-OAEP_SHA2_256_OFFSET_IN_BYTES;else if(e.toLowerCase()=="SHA2-384".toLowerCase())MAX_MESSAGE_SIZE_IN_BYTES=RSA_MODULUS_SIZE_IN_BYTES-OAEP_SHA2_384_OFFSET_IN_BYTES;else{if(e.toLowerCase()!="SHA2-512".toLowerCase())throw ERR_INVALID_HASH;MAX_MESSAGE_SIZE_IN_BYTES=RSA_MODULUS_SIZE_IN_BYTES-OAEP_SHA2_512_OFFSET_IN_BYTES}if(1>MAX_MESSAGE_SIZE_IN_BYTES)throw ERR_INVALID_PIN_LENGTH;var n=2*MAX_MESSAGE_SIZE_IN_BYTES;pinMessageArray=new Array(n),pinMessageArray[0]="0",pinMessageArray[1]="1",pinMessageLength=2,PINLengthInBytes=t.length/2,addPinBlockToMessageArray(t),addRandomStringToMessageArray(r)}function addPinBlockToMessageArray(t){if(null==t)throw ERR_INVALID_PIN_BLOCK;aCopy(t,0,pinMessageArray,pinMessageLength,t.length),pinMessageLength+=t.length}function addRandomStringToMessageArray(t){if(null==t)throw ERR_INVALID_RANDOM_NUMBER;var r=ifValidHex(t);if(!r)throw ERR_INVALID_RANDOM_NUMBER;var e=0,n=t.length;if(e=n%2)throw ERR_INVALID_RANDOM_NUMBER_LENGTH;var i=(MAX_MESSAGE_SIZE_IN_BYTES-pinMessageLength/2)*NUM_OF_NIBBLES_PER_BYTE;if(MIN_RANDOM_NUMBER_STRING_LENGTH>n||n>i)throw ERR_INVALID_RANDOM_NUMBER_LENGTH;aCopyStr(t,0,pinMessageArray,pinMessageLength,n),pinMessageLength+=n}function OAEPEncodedMessage(t,r,e){if(ENCODED_MESSAGE_SIZE_IN_BYTES=RSA_MODULUS_SIZE_IN_BYTES-1,e.toLowerCase()=="SHA1".toLowerCase())HASH_ALGO_SIZE_IN_BYTES=SHA1_HASH_SIZE_IN_BYTES,MAX_PIN_MESSAGE_SIZE_IN_BYTES=RSA_MODULUS_SIZE_IN_BYTES-OAEP_SHA1_OFFSET_IN_BYTES,DATA_BLOCK_SIZE_IN_BYTES=ENCODED_MESSAGE_SIZE_IN_BYTES-SHA1_HASH_SIZE_IN_BYTES;else if(e.toLowerCase()=="SHA2-256".toLowerCase())HASH_ALGO_SIZE_IN_BYTES=SHA2_256_HASH_SIZE_IN_BYTES,MAX_PIN_MESSAGE_SIZE_IN_BYTES=RSA_MODULUS_SIZE_IN_BYTES-OAEP_SHA2_256_OFFSET_IN_BYTES,DATA_BLOCK_SIZE_IN_BYTES=ENCODED_MESSAGE_SIZE_IN_BYTES-SHA2_256_HASH_SIZE_IN_BYTES;else if(e.toLowerCase()=="SHA2-384".toLowerCase())HASH_ALGO_SIZE_IN_BYTES=SHA2_384_HASH_SIZE_IN_BYTES,MAX_PIN_MESSAGE_SIZE_IN_BYTES=RSA_MODULUS_SIZE_IN_BYTES-OAEP_SHA2_384_OFFSET_IN_BYTES,DATA_BLOCK_SIZE_IN_BYTES=ENCODED_MESSAGE_SIZE_IN_BYTES-SHA2_384_HASH_SIZE_IN_BYTES;else{if(e.toLowerCase()!="SHA2-512".toLowerCase())throw ERR_INVALID_HASH;HASH_ALGO_SIZE_IN_BYTES=SHA2_512_HASH_SIZE_IN_BYTES,MAX_PIN_MESSAGE_SIZE_IN_BYTES=RSA_MODULUS_SIZE_IN_BYTES-OAEP_SHA2_512_OFFSET_IN_BYTES,DATA_BLOCK_SIZE_IN_BYTES=ENCODED_MESSAGE_SIZE_IN_BYTES-SHA2_512_HASH_SIZE_IN_BYTES}doOAEPEncoding(t,r,e)}function randomString(t){for(var r="0123456789ABCDEF",e=t,n="",i=0;e>i;i++){var o=Math.floor(Math.random()*r.length);n+=r.substring(o,o+1)}return n}function parseBigInt(t,r){return new BigInteger(t,r)}function aCopyStr(t,r,e,n,i){for(var o=new Array,s=0;s<t.length;s++)o.push(t.charAt(s));for(var h=0;i>h;h++)e[n]=o[r],r++,n++}function xorByteArrays(t,r){for(var e=[],n=[],i=toString(t),o=toString(r),s=new Array,h=new Array,a=0;a<i.length;a++)s[a]=parseInt(i.charAt(a),16);for(var a=0;a<o.length;a++)h[a]=parseInt(o.charAt(a),16);for(var a=0;a<s.length;a++)e.push(s[a]^h[a]);for(var a=0;a<e.length;a++)n[a]=e[a].toString(16);return n}function doOAEPEncoding(t,r,e){var n,i,o,s=new Array(2*DATA_BLOCK_SIZE_IN_BYTES),h=new Array(2*DATA_BLOCK_SIZE_IN_BYTES),a=new Array(2*DATA_BLOCK_SIZE_IN_BYTES),_=(new Array(2*HASH_ALGO_SIZE_IN_BYTES),new Array(2*HASH_ALGO_SIZE_IN_BYTES)),S=new Array(2*HASH_ALGO_SIZE_IN_BYTES),u=new Array(2*HASH_ALGO_SIZE_IN_BYTES),E=new Array(2+2*ENCODED_MESSAGE_SIZE_IN_BYTES),I=new Array,n=t.length/2;if(MIN_PIN_MESSAGE_SIZE_IN_BYTES>n||n>MAX_PIN_MESSAGE_SIZE_IN_BYTES)throw ERR_INVALID_PIN_MESSAGE_LENGTH;P=randomString(2*ENCODING_PARAMETER_SIZE_IN_BYTES);var g=new jsSHA(P,"HEX");if(e.toLowerCase()=="SHA1".toLowerCase())I=g.getHash("SHA-1","HEX");else if(e.toLowerCase()=="SHA2-256".toLowerCase())I=g.getHash("SHA-256","HEX");else if(e.toLowerCase()=="SHA2-384".toLowerCase())I=g.getHash("SHA-384","HEX");else{if(e.toLowerCase()!="SHA2-512".toLowerCase())throw ERR_INVALID_HASH;I=g.getHash("SHA-512","HEX")}var f;f=s.length;for(var p=0;f>p;p++)s[p]=0;aCopyStr(I,0,s,0,2*HASH_ALGO_SIZE_IN_BYTES),i=2*HASH_ALGO_SIZE_IN_BYTES,o=2*(DATA_BLOCK_SIZE_IN_BYTES-HASH_ALGO_SIZE_IN_BYTES-n-1),i+=o,s[i]="0",i++,s[i]="1",i++,aCopy(t,0,s,i,t.length),_=randomString(_.length);for(var l=new Array,A=0;A<_.length;A++)l.push(_.charAt(A));MGF(l,h,2*DATA_BLOCK_SIZE_IN_BYTES,e),a=xorByteArrays(s,h),MGF(a,S,2*HASH_ALGO_SIZE_IN_BYTES,e),u=xorByteArrays(_,S),E[0]="0",E[1]="0",aCopy(u,0,E,2,2*HASH_ALGO_SIZE_IN_BYTES),aCopy(a,0,E,2+2*HASH_ALGO_SIZE_IN_BYTES,2*DATA_BLOCK_SIZE_IN_BYTES),str1=toString(E),encodedMsg=new BigInteger(str1,16)}function I2OSP(t,r){var e,n=new Array(2*NUM_OF_BYTES_PER_WORD);for(e=0;2*NUM_OF_BYTES_PER_WORD>e;e++)n[e]=0;return n[r]=t.toString(16),n}function MGF(t,r,e,n){var i,o,s,h,a,_,S,u=new Array(2*ENCODED_MESSAGE_SIZE_IN_BYTES),E=new Array(2*HASH_ALGO_SIZE_IN_BYTES),I=new Array(2*NUM_OF_BYTES_PER_WORD),g="";s=t.length;var f=new Array(s+2*NUM_OF_BYTES_PER_WORD);for(o=Math.floor(e/(2*HASH_ALGO_SIZE_IN_BYTES)),a=e-o*HASH_ALGO_SIZE_IN_BYTES*2,a>0&&o++,_=2*HASH_ALGO_SIZE_IN_BYTES,S=0;2*ENCODED_MESSAGE_SIZE_IN_BYTES>S;S++)u[S]=0;for(i=0;o>i;i++){I=I2OSP(i,7),aCopy(t,0,u,0,s),aCopy(I,0,u,s,2*NUM_OF_BYTES_PER_WORD),aCopy(u,0,f,0,s+2*NUM_OF_BYTES_PER_WORD);var p=f.toString();g=p.split(",").join("");var l=new jsSHA(g,"HEX");if(n.toLowerCase()=="SHA1".toLowerCase())E=l.getHash("SHA-1","HEX");else if(n.toLowerCase()=="SHA2-256".toLowerCase())E=l.getHash("SHA-256","HEX");else if(n.toLowerCase()=="SHA2-384".toLowerCase())E=l.getHash("SHA-384","HEX");else{if(n.toLowerCase()!="SHA2-512".toLowerCase())throw ERR_INVALID_HASH;E=l.getHash("SHA-512","HEX")}h=i*(2*HASH_ALGO_SIZE_IN_BYTES),i==o-1&&a>0&&(_=a),aCopyStr(E,0,r,h,_)}}function ifValidHex(t){var r;for(r=0;r<t.length;r++)if(isNaN(parseInt(t.charAt(r),16)))return!1;return!0}function validate_Mod_Exp(t,r){var e=0,n=0;if(e=t.length%2,n=r.length%2,e||n)return ERR_INVALID_RSA_KEY_LENGTH;var i=t.length/2,o=r.length/2;if(64>i||i>256)return ERR_INVALID_RSA_KEY_LENGTH;if(o>i)return ERR_INVALID_RSA_KEY_LENGTH;var s=ifValidHex(t);return s?(s=ifValidHex(r),s?ERR_NO_ERROR:ERR_INVALID_RSA_KEY):ERR_INVALID_RSA_KEY}function clearData(){PinString="",PINLengthInBytes=0,PINBlockByteArray=new Array,PINBlockLength=0,pinMessageArray=new Array,pinMessageLength=0,PINLength=0,encodedMsg="",P="",encryptedMsg=""}function initialisePublicKeyData(t,r){var e=validate_Mod_Exp(t,r);if(e!=ERR_NO_ERROR)throw e;RSA_MODULUS_SIZE_IN_BYTES=t.length/2,MODULUS_STRING=t,EXPONENT_STRING=r,isPublicKeyDataValid=!0}function OBM_GetEncodingParameter(){return P_String}function OBM_GetEncryptedPassword(){return C_String}function OBM_EncryptPassword_Ex(t,r,e){try{if(!isPublicKeyDataValid)throw ERR_INVALID_RSA_KEY;var n=new EncryptedMessage;n.setPublic(MODULUS_STRING,EXPONENT_STRING);var i=new PINBlock(t);if(h=i.ValidateAndCreatePINBlockByteArray(t),h!=ERR_NO_ERROR)throw h;var o=new PINMessage(i.getBytes(),r,e),s=new OAEPEncodedMessage(o.getBytes(),r,e);return P_String=s.getEncodingParameter(),n.doRSAEncryption(s.getBytes(),MODULUS_STRING,EXPONENT_STRING),C_String=n.getBytes(),ERR_NO_ERROR}catch(h){return h}}function OBM_EncryptPassword(t,r){try{if(!isPublicKeyDataValid)throw ERR_INVALID_RSA_KEY;var e=new EncryptedMessage;e.setPublic(MODULUS_STRING,EXPONENT_STRING);var n=new PINBlock(t);if(s=n.ValidateAndCreatePINBlockByteArray(t),s!=ERR_NO_ERROR)throw s;var i=new PINMessage(n.getBytes(),r,"SHA1"),o=new OAEPEncodedMessage(i.getBytes(),r,"SHA1");return P_String=o.getEncodingParameter(),e.doRSAEncryption(o.getBytes(),MODULUS_STRING,EXPONENT_STRING),C_String=e.getBytes(),ERR_NO_ERROR}catch(s){return s}}function toString(t){var r,e=t.toString();return r=e.split(",").join("")}function s2hex(t){for(var r="",e=0;e<t.length;e++)c=t.charCodeAt(e),r+=(c<16?"0":"")+c.toString(16);return r}var SUPPORTED_ALGS=7;!function(t){"use strict";function r(t,r){this.highOrder=t,this.lowOrder=r}function e(t,r){var e,n=[],i=(1<<r)-1,o=t.length*r;for(e=0;o>e;e+=r)n[e>>>5]|=(t.charCodeAt(e/r)&i)<<32-r-e%32;return{value:n,binLen:o}}function n(t){var r,e,n=[],i=t.length;if(0!==i%2)throw"String of HEX type must be in byte increments";for(r=0;i>r;r+=2){if(e=parseInt(t.substr(r,2),16),isNaN(e))throw"String of HEX type contains invalid characters";n[r>>>3]|=e<<24-4*(r%8)}return{value:n,binLen:4*i}}function i(t){var r,e,n,i,o,s,h=[],a=0,_="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/";if(-1===t.search(/^[a-zA-Z0-9=+\/]+$/))throw"Invalid character in base-64 string";if(s=t.indexOf("="),t=t.replace(/\=/g,""),-1!==s&&s<t.length)throw"Invalid '=' found in base-64 string";for(e=0;e<t.length;e+=4){for(o=t.substr(e,4),i=0,n=0;n<o.length;n+=1)r=_.indexOf(o[n]),i|=r<<18-6*n;for(n=0;n<o.length-1;n+=1)h[a>>2]|=(i>>>16-8*n&255)<<24-8*(a%4),a+=1}return{value:h,binLen:8*a}}function o(t,r){var e,n,i="0123456789abcdef",o="",s=4*t.length;for(e=0;s>e;e+=1)n=t[e>>>2]>>>8*(3-e%4),o+=i.charAt(n>>>4&15)+i.charAt(15&n);return r.outputUpper?o.toUpperCase():o}function s(t,r){var e,n,i,o="",s=4*t.length,h="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/";for(e=0;s>e;e+=3)for(i=(t[e>>>2]>>>8*(3-e%4)&255)<<16|(t[e+1>>>2]>>>8*(3-(e+1)%4)&255)<<8|t[e+2>>>2]>>>8*(3-(e+2)%4)&255,n=0;4>n;n+=1)o+=8*e+6*n<=32*t.length?h.charAt(i>>>6*(3-n)&63):r.b64Pad;return o}function h(t){var r={outputUpper:!1,b64Pad:"="};try{t.hasOwnProperty("outputUpper")&&(r.outputUpper=t.outputUpper),t.hasOwnProperty("b64Pad")&&(r.b64Pad=t.b64Pad)}catch(e){}if("boolean"!=typeof r.outputUpper)throw"Invalid outputUpper formatting option";if("string"!=typeof r.b64Pad)throw"Invalid b64Pad formatting option";return r}function a(t,r){return t<<r|t>>>32-r}function _(t,r){return t>>>r|t<<32-r}function S(t,e){var n=null,i=new r(t.highOrder,t.lowOrder);return n=32>=e?new r(i.highOrder>>>e|i.lowOrder<<32-e&4294967295,i.lowOrder>>>e|i.highOrder<<32-e&4294967295):new r(i.lowOrder>>>e-32|i.highOrder<<64-e&4294967295,i.highOrder>>>e-32|i.lowOrder<<64-e&4294967295)}function u(t,r){return t>>>r}function E(t,e){var n=null;return n=32>=e?new r(t.highOrder>>>e,t.lowOrder>>>e|t.highOrder<<32-e&4294967295):new r(0,t.highOrder>>>e-32)}function I(t,r,e){return t^r^e}function g(t,r,e){return t&r^~t&e}function f(t,e,n){return new r(t.highOrder&e.highOrder^~t.highOrder&n.highOrder,t.lowOrder&e.lowOrder^~t.lowOrder&n.lowOrder)}function p(t,r,e){return t&r^t&e^r&e}function l(t,e,n){return new r(t.highOrder&e.highOrder^t.highOrder&n.highOrder^e.highOrder&n.highOrder,t.lowOrder&e.lowOrder^t.lowOrder&n.lowOrder^e.lowOrder&n.lowOrder)}function A(t){return _(t,2)^_(t,13)^_(t,22)}function c(t){var e=S(t,28),n=S(t,34),i=S(t,39);return new r(e.highOrder^n.highOrder^i.highOrder,e.lowOrder^n.lowOrder^i.lowOrder)}function B(t){return _(t,6)^_(t,11)^_(t,25)}function T(t){var e=S(t,14),n=S(t,18),i=S(t,41);return new r(e.highOrder^n.highOrder^i.highOrder,e.lowOrder^n.lowOrder^i.lowOrder)}function d(t){return _(t,7)^_(t,18)^u(t,3)}function N(t){var e=S(t,1),n=S(t,8),i=E(t,7);return new r(e.highOrder^n.highOrder^i.highOrder,e.lowOrder^n.lowOrder^i.lowOrder)}function O(t){return _(t,17)^_(t,19)^u(t,10)}function w(t){var e=S(t,19),n=S(t,61),i=E(t,6);return new r(e.highOrder^n.highOrder^i.highOrder,e.lowOrder^n.lowOrder^i.lowOrder)}function b(t,r){var e=(65535&t)+(65535&r),n=(t>>>16)+(r>>>16)+(e>>>16);return(65535&n)<<16|65535&e}function y(t,r,e,n){var i=(65535&t)+(65535&r)+(65535&e)+(65535&n),o=(t>>>16)+(r>>>16)+(e>>>16)+(n>>>16)+(i>>>16);return(65535&o)<<16|65535&i}function v(t,r,e,n,i){var o=(65535&t)+(65535&r)+(65535&e)+(65535&n)+(65535&i),s=(t>>>16)+(r>>>16)+(e>>>16)+(n>>>16)+(i>>>16)+(o>>>16);return(65535&s)<<16|65535&o}function R(t,e){var n,i,o,s;return n=(65535&t.lowOrder)+(65535&e.lowOrder),i=(t.lowOrder>>>16)+(e.lowOrder>>>16)+(n>>>16),o=(65535&i)<<16|65535&n,n=(65535&t.highOrder)+(65535&e.highOrder)+(i>>>16),i=(t.highOrder>>>16)+(e.highOrder>>>16)+(n>>>16),s=(65535&i)<<16|65535&n,new r(s,o)}function m(t,e,n,i){var o,s,h,a;return o=(65535&t.lowOrder)+(65535&e.lowOrder)+(65535&n.lowOrder)+(65535&i.lowOrder),s=(t.lowOrder>>>16)+(e.lowOrder>>>16)+(n.lowOrder>>>16)+(i.lowOrder>>>16)+(o>>>16),h=(65535&s)<<16|65535&o,o=(65535&t.highOrder)+(65535&e.highOrder)+(65535&n.highOrder)+(65535&i.highOrder)+(s>>>16),s=(t.highOrder>>>16)+(e.highOrder>>>16)+(n.highOrder>>>16)+(i.highOrder>>>16)+(o>>>16),a=(65535&s)<<16|65535&o,new r(a,h)}function M(t,e,n,i,o){var s,h,a,_;return s=(65535&t.lowOrder)+(65535&e.lowOrder)+(65535&n.lowOrder)+(65535&i.lowOrder)+(65535&o.lowOrder),h=(t.lowOrder>>>16)+(e.lowOrder>>>16)+(n.lowOrder>>>16)+(i.lowOrder>>>16)+(o.lowOrder>>>16)+(s>>>16),a=(65535&h)<<16|65535&s,s=(65535&t.highOrder)+(65535&e.highOrder)+(65535&n.highOrder)+(65535&i.highOrder)+(65535&o.highOrder)+(h>>>16),h=(t.highOrder>>>16)+(e.highOrder>>>16)+(n.highOrder>>>16)+(i.highOrder>>>16)+(o.highOrder>>>16)+(s>>>16),_=(65535&h)<<16|65535&s,new r(_,a)}function L(t,r){var e,n,i,o,s,h,_,S,u,E=[],f=g,l=I,A=p,c=a,B=b,T=v,d=[1732584193,4023233417,2562383102,271733878,3285377520],N=[1518500249,1518500249,1518500249,1518500249,1518500249,1518500249,1518500249,1518500249,1518500249,1518500249,1518500249,1518500249,1518500249,1518500249,1518500249,1518500249,1518500249,1518500249,1518500249,1518500249,1859775393,1859775393,1859775393,1859775393,1859775393,1859775393,1859775393,1859775393,1859775393,1859775393,1859775393,1859775393,1859775393,1859775393,1859775393,1859775393,1859775393,1859775393,1859775393,1859775393,2400959708,2400959708,2400959708,2400959708,2400959708,2400959708,2400959708,2400959708,2400959708,2400959708,2400959708,2400959708,2400959708,2400959708,2400959708,2400959708,2400959708,2400959708,2400959708,2400959708,3395469782,3395469782,3395469782,3395469782,3395469782,3395469782,3395469782,3395469782,3395469782,3395469782,3395469782,3395469782,3395469782,3395469782,3395469782,3395469782,3395469782,3395469782,3395469782,3395469782];for(t[r>>>5]|=128<<24-r%32,t[(r+65>>>9<<4)+15]=r,u=t.length,_=0;u>_;_+=16){for(e=d[0],n=d[1],i=d[2],o=d[3],s=d[4],S=0;80>S;S+=1)16>S?E[S]=t[S+_]:E[S]=c(E[S-3]^E[S-8]^E[S-14]^E[S-16],1),h=20>S?T(c(e,5),f(n,i,o),s,N[S],E[S]):40>S?T(c(e,5),l(n,i,o),s,N[S],E[S]):60>S?T(c(e,5),A(n,i,o),s,N[S],E[S]):T(c(e,5),l(n,i,o),s,N[S],E[S]),s=o,o=i,i=c(n,30),n=e,e=h;d[0]=B(e,d[0]),d[1]=B(n,d[1]),d[2]=B(i,d[2]),d[3]=B(o,d[3]),d[4]=B(s,d[4])}return d}function P(t,e,n){var i,o,s,h,a,_,S,u,E,I,L,P,D,H,C,Y,G,Z,U,F,V,X,x,k,K,q,j,z,W,J,Q=[];if(("SHA-224"===n||"SHA-256"===n)&&2&SUPPORTED_ALGS)P=64,D=(e+65>>>9<<4)+15,Y=16,G=1,j=Number,Z=b,U=y,F=v,V=d,X=O,x=A,k=B,q=p,K=g,z=[1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298],
L="SHA-224"===n?[3238371032,914150663,812702999,4144912697,4290775857,1750603025,1694076839,3204075428]:[1779033703,3144134277,1013904242,2773480762,1359893119,2600822924,528734635,1541459225];else{if("SHA-384"!==n&&"SHA-512"!==n||!(4&SUPPORTED_ALGS))throw"Unexpected error in SHA-2 implementation";P=80,D=(e+128>>>10<<5)+31,Y=32,G=2,j=r,Z=R,U=m,F=M,V=N,X=w,x=c,k=T,q=l,K=f,z=[new j(1116352408,3609767458),new j(1899447441,602891725),new j(3049323471,3964484399),new j(3921009573,2173295548),new j(961987163,4081628472),new j(1508970993,3053834265),new j(2453635748,2937671579),new j(2870763221,3664609560),new j(3624381080,2734883394),new j(310598401,1164996542),new j(607225278,1323610764),new j(1426881987,3590304994),new j(1925078388,4068182383),new j(2162078206,991336113),new j(2614888103,633803317),new j(3248222580,3479774868),new j(3835390401,2666613458),new j(4022224774,944711139),new j(264347078,2341262773),new j(604807628,2007800933),new j(770255983,1495990901),new j(1249150122,1856431235),new j(1555081692,3175218132),new j(1996064986,2198950837),new j(2554220882,3999719339),new j(2821834349,766784016),new j(2952996808,2566594879),new j(3210313671,3203337956),new j(3336571891,1034457026),new j(3584528711,2466948901),new j(113926993,3758326383),new j(338241895,168717936),new j(666307205,1188179964),new j(773529912,1546045734),new j(1294757372,1522805485),new j(1396182291,2643833823),new j(1695183700,2343527390),new j(1986661051,1014477480),new j(2177026350,1206759142),new j(2456956037,344077627),new j(2730485921,1290863460),new j(2820302411,3158454273),new j(3259730800,3505952657),new j(3345764771,106217008),new j(3516065817,3606008344),new j(3600352804,1432725776),new j(4094571909,1467031594),new j(275423344,851169720),new j(430227734,3100823752),new j(506948616,1363258195),new j(659060556,3750685593),new j(883997877,3785050280),new j(958139571,3318307427),new j(1322822218,3812723403),new j(1537002063,2003034995),new j(1747873779,3602036899),new j(1955562222,1575990012),new j(2024104815,1125592928),new j(2227730452,2716904306),new j(2361852424,442776044),new j(2428436474,593698344),new j(2756734187,3733110249),new j(3204031479,2999351573),new j(3329325298,3815920427),new j(3391569614,3928383900),new j(3515267271,566280711),new j(3940187606,3454069534),new j(4118630271,4000239992),new j(116418474,1914138554),new j(174292421,2731055270),new j(289380356,3203993006),new j(460393269,320620315),new j(685471733,587496836),new j(852142971,1086792851),new j(1017036298,365543100),new j(1126000580,2618297676),new j(1288033470,3409855158),new j(1501505948,4234509866),new j(1607167915,987167468),new j(1816402316,1246189591)],L="SHA-384"===n?[new j(3418070365,3238371032),new j(1654270250,914150663),new j(2438529370,812702999),new j(355462360,4144912697),new j(1731405415,4290775857),new j(41048885895,1750603025),new j(3675008525,1694076839),new j(1203062813,3204075428)]:[new j(1779033703,4089235720),new j(3144134277,2227873595),new j(1013904242,4271175723),new j(2773480762,1595750129),new j(1359893119,2917565137),new j(2600822924,725511199),new j(528734635,4215389547),new j(1541459225,327033209)]}for(t[e>>>5]|=128<<24-e%32,t[D]=e,W=t.length,H=0;W>H;H+=Y){for(i=L[0],o=L[1],s=L[2],h=L[3],a=L[4],_=L[5],S=L[6],u=L[7],C=0;P>C;C+=1)16>C?Q[C]=new j(t[C*G+H],t[C*G+H+1]):Q[C]=U(X(Q[C-2]),Q[C-7],V(Q[C-15]),Q[C-16]),E=F(u,k(a),K(a,_,S),z[C],Q[C]),I=Z(x(i),q(i,o,s)),u=S,S=_,_=a,a=Z(h,E),h=s,s=o,o=i,i=Z(E,I);L[0]=Z(i,L[0]),L[1]=Z(o,L[1]),L[2]=Z(s,L[2]),L[3]=Z(h,L[3]),L[4]=Z(a,L[4]),L[5]=Z(_,L[5]),L[6]=Z(S,L[6]),L[7]=Z(u,L[7])}if("SHA-224"===n&&2&SUPPORTED_ALGS)J=[L[0],L[1],L[2],L[3],L[4],L[5],L[6]];else if("SHA-256"===n&&2&SUPPORTED_ALGS)J=L;else if("SHA-384"===n&&4&SUPPORTED_ALGS)J=[L[0].highOrder,L[0].lowOrder,L[1].highOrder,L[1].lowOrder,L[2].highOrder,L[2].lowOrder,L[3].highOrder,L[3].lowOrder,L[4].highOrder,L[4].lowOrder,L[5].highOrder,L[5].lowOrder];else{if(!("SHA-512"===n&&4&SUPPORTED_ALGS))throw"Unexpected error in SHA-2 implementation";J=[L[0].highOrder,L[0].lowOrder,L[1].highOrder,L[1].lowOrder,L[2].highOrder,L[2].lowOrder,L[3].highOrder,L[3].lowOrder,L[4].highOrder,L[4].lowOrder,L[5].highOrder,L[5].lowOrder,L[6].highOrder,L[6].lowOrder,L[7].highOrder,L[7].lowOrder]}return J}var D=function(t,r,a){var _=null,S=null,u=null,E=null,I=null,g=0,f=[0],p=0,l=null;if(p="undefined"!=typeof a?a:8,8!==p&&16!==p)throw"charSize must be 8 or 16";if("HEX"===r){if(0!==t.length%2)throw"srcString of HEX type must be in byte increments";l=n(t),g=l.binLen,f=l.value}else if("ASCII"===r||"TEXT"===r)l=e(t,p),g=l.binLen,f=l.value;else{if("B64"!==r)throw"inputFormat must be HEX, TEXT, ASCII, or B64";l=i(t),g=l.binLen,f=l.value}this.getHash=function(t,r,e){var n=null,i=f.slice(),a="";switch(r){case"HEX":n=o;break;case"B64":n=s;break;default:throw"format must be HEX or B64"}if("SHA-1"===t&&1&SUPPORTED_ALGS)null===_&&(_=L(i,g)),a=n(_,h(e));else if("SHA-224"===t&&2&SUPPORTED_ALGS)null===S&&(S=P(i,g,t)),a=n(S,h(e));else if("SHA-256"===t&&2&SUPPORTED_ALGS)null===u&&(u=P(i,g,t)),a=n(u,h(e));else if("SHA-384"===t&&4&SUPPORTED_ALGS)null===E&&(E=P(i,g,t)),a=n(E,h(e));else{if(!("SHA-512"===t&&4&SUPPORTED_ALGS))throw"Chosen SHA variant is not supported";null===I&&(I=P(i,g,t)),a=n(I,h(e))}return a},this.getHMAC=function(t,r,a,_,S){var u,E,I,l,A,c,B,T,d,N=[],O=[],w=null;switch(_){case"HEX":u=o;break;case"B64":u=s;break;default:throw"outputFormat must be HEX or B64"}if("SHA-1"===a&&1&SUPPORTED_ALGS)I=64,d=160;else if("SHA-224"===a&&2&SUPPORTED_ALGS)I=64,d=224;else if("SHA-256"===a&&2&SUPPORTED_ALGS)I=64,d=256;else if("SHA-384"===a&&4&SUPPORTED_ALGS)I=128,d=384;else{if(!("SHA-512"===a&&4&SUPPORTED_ALGS))throw"Chosen SHA variant is not supported";I=128,d=512}if("HEX"===r)w=n(t),T=w.binLen,E=w.value;else if("ASCII"===r||"TEXT"===r)w=e(t,p),T=w.binLen,E=w.value;else{if("B64"!==r)throw"inputFormat must be HEX, TEXT, ASCII, or B64";w=i(t),T=w.binLen,E=w.value}if(l=8*I,B=I/4-1,T/8>I){if("SHA-1"===a&&1&SUPPORTED_ALGS)E=L(E,T);else{if(!(6&SUPPORTED_ALGS))throw"Unexpected error in HMAC implementation";E=P(E,T,a)}E[B]&=4294967040}else I>T/8&&(E[B]&=4294967040);for(A=0;B>=A;A+=1)N[A]=909522486^E[A],O[A]=1549556828^E[A];if("SHA-1"===a&&1&SUPPORTED_ALGS)c=L(O.concat(L(N.concat(f),l+g)),l+d);else{if(!(6&SUPPORTED_ALGS))throw"Unexpected error in HMAC implementation";c=P(O.concat(P(N.concat(f),l+g,a)),l+d,a)}return u(c,h(S))}};t.jsSHA=D}(window);var dbits,canary=0xdeadbeefcafe,j_lm=15715070==(16777215&canary);j_lm&&"Microsoft Internet Explorer"==navigator.appName?(BigInteger.prototype.am=am2,dbits=30):j_lm&&"Netscape"!=navigator.appName?(BigInteger.prototype.am=am1,dbits=26):(BigInteger.prototype.am=am3,dbits=28),BigInteger.prototype.DB=dbits,BigInteger.prototype.DM=(1<<dbits)-1,BigInteger.prototype.DV=1<<dbits;var BI_FP=52;BigInteger.prototype.FV=Math.pow(2,BI_FP),BigInteger.prototype.F1=BI_FP-dbits,BigInteger.prototype.F2=2*dbits-BI_FP;var BI_RM="0123456789abcdefghijklmnopqrstuvwxyz",BI_RC=new Array,rr,vv;for(rr="0".charCodeAt(0),vv=0;9>=vv;++vv)BI_RC[rr++]=vv;for(rr="a".charCodeAt(0),vv=10;36>vv;++vv)BI_RC[rr++]=vv;for(rr="A".charCodeAt(0),vv=10;36>vv;++vv)BI_RC[rr++]=vv;Classic.prototype.convert=cConvert,Classic.prototype.revert=cRevert,Classic.prototype.reduce=cReduce,Classic.prototype.mulTo=cMulTo,Classic.prototype.sqrTo=cSqrTo,Montgomery.prototype.convert=montConvert,Montgomery.prototype.revert=montRevert,Montgomery.prototype.reduce=montReduce,Montgomery.prototype.mulTo=montMulTo,Montgomery.prototype.sqrTo=montSqrTo,BigInteger.prototype.copyTo=bnpCopyTo,BigInteger.prototype.fromInt=bnpFromInt,BigInteger.prototype.fromString=bnpFromString,BigInteger.prototype.clamp=bnpClamp,BigInteger.prototype.dlShiftTo=bnpDLShiftTo,BigInteger.prototype.drShiftTo=bnpDRShiftTo,BigInteger.prototype.lShiftTo=bnpLShiftTo,BigInteger.prototype.rShiftTo=bnpRShiftTo,BigInteger.prototype.subTo=bnpSubTo,BigInteger.prototype.multiplyTo=bnpMultiplyTo,BigInteger.prototype.squareTo=bnpSquareTo,BigInteger.prototype.divRemTo=bnpDivRemTo,BigInteger.prototype.invDigit=bnpInvDigit,BigInteger.prototype.isEven=bnpIsEven,BigInteger.prototype.exp=bnpExp,BigInteger.prototype.toString=bnToString,BigInteger.prototype.negate=bnNegate,BigInteger.prototype.abs=bnAbs,BigInteger.prototype.compareTo=bnCompareTo,BigInteger.prototype.bitLength=bnBitLength,BigInteger.prototype.mod=bnMod,BigInteger.prototype.modPowInt=bnModPowInt,BigInteger.ZERO=nbv(0),BigInteger.ONE=nbv(1),NullExp.prototype.convert=nNop,NullExp.prototype.revert=nNop,NullExp.prototype.mulTo=nMulTo,NullExp.prototype.sqrTo=nSqrTo,Barrett.prototype.convert=barrettConvert,Barrett.prototype.revert=barrettRevert,Barrett.prototype.reduce=barrettReduce,Barrett.prototype.mulTo=barrettMulTo,Barrett.prototype.sqrTo=barrettSqrTo;var lowprimes=[2,3,5,7,11,13,17,19,23,29,31,37,41,43,47,53,59,61,67,71,73,79,83,89,97,101,103,107,109,113,127,131,137,139,149,151,157,163,167,173,179,181,191,193,197,199,211,223,227,229,233,239,241,251,257,263,269,271,277,281,283,293,307,311,313,317,331,337,347,349,353,359,367,373,379,383,389,397,401,409,419,421,431,433,439,443,449,457,461,463,467,479,487,491,499,503,509],lplim=(1<<26)/lowprimes[lowprimes.length-1];BigInteger.prototype.chunkSize=bnpChunkSize,BigInteger.prototype.toRadix=bnpToRadix,BigInteger.prototype.fromRadix=bnpFromRadix,BigInteger.prototype.fromNumber=bnpFromNumber,BigInteger.prototype.bitwiseTo=bnpBitwiseTo,BigInteger.prototype.changeBit=bnpChangeBit,BigInteger.prototype.addTo=bnpAddTo,BigInteger.prototype.dMultiply=bnpDMultiply,BigInteger.prototype.dAddOffset=bnpDAddOffset,BigInteger.prototype.multiplyLowerTo=bnpMultiplyLowerTo,BigInteger.prototype.multiplyUpperTo=bnpMultiplyUpperTo,BigInteger.prototype.modInt=bnpModInt,BigInteger.prototype.millerRabin=bnpMillerRabin,BigInteger.prototype.clone=bnClone,BigInteger.prototype.intValue=bnIntValue,BigInteger.prototype.byteValue=bnByteValue,BigInteger.prototype.shortValue=bnShortValue,BigInteger.prototype.signum=bnSigNum,BigInteger.prototype.toByteArray=bnToByteArray,BigInteger.prototype.equals=bnEquals,BigInteger.prototype.min=bnMin,BigInteger.prototype.max=bnMax,BigInteger.prototype.and=bnAnd,BigInteger.prototype.or=bnOr,BigInteger.prototype.xor=bnXor,BigInteger.prototype.andNot=bnAndNot,BigInteger.prototype.not=bnNot,BigInteger.prototype.shiftLeft=bnShiftLeft,BigInteger.prototype.shiftRight=bnShiftRight,BigInteger.prototype.getLowestSetBit=bnGetLowestSetBit,BigInteger.prototype.bitCount=bnBitCount,BigInteger.prototype.testBit=bnTestBit,BigInteger.prototype.setBit=bnSetBit,BigInteger.prototype.clearBit=bnClearBit,BigInteger.prototype.flipBit=bnFlipBit,BigInteger.prototype.add=bnAdd,BigInteger.prototype.subtract=bnSubtract,BigInteger.prototype.multiply=bnMultiply,BigInteger.prototype.divide=bnDivide,BigInteger.prototype.remainder=bnRemainder,BigInteger.prototype.divideAndRemainder=bnDivideAndRemainder,BigInteger.prototype.modPow=bnModPow,BigInteger.prototype.modInverse=bnModInverse,BigInteger.prototype.pow=bnPow,BigInteger.prototype.gcd=bnGCD,BigInteger.prototype.isProbablePrime=bnIsProbablePrime;var ERR_NO_ERROR=0,ERR_INVALID_PIN_LENGTH=10,ERR_INVALID_PIN=11,ERR_INVALID_PIN_BLOCK=20,ERR_INVALID_RANDOM_NUMBER_LENGTH=21,ERR_INVALID_RANDOM_NUMBER=22,ERR_INVALID_HASH=27,ERR_INVALID_OPERATION=29,ERR_RSA_ENCRYPTION=26,ERR_INVALID_PIN_MESSAGE_LENGTH=31,ERR_INVALID_RSA_KEY_LENGTH=41,ERR_INVALID_RSA_KEY=42,MAX_PIN_STRING_SIZE=30,MIN_PIN_STRING_SIZE=4,PIN_BLOCK_FILL_CHARACTER=255,FMT_2_CONTROL_BYTE=2,FMT_12_CONTROL_BYTE=193,ISO_FORMAT_2_TYPE=1,ISO_FORMAT_12_TYPE=2,MAX_NUMERIC_PIN_STRING_SIZE=12,MAX_NUMERIC_PIN_BYTE_SIZE=6,DECIMAL_RADIX=10,NUM_OF_BYTES_IN_FMT2_PIN_BLOCK=8,NUM_OF_BYTES_PER_CNTRL_AND_PIN_LENGTH=2,NUM_OF_BYTES_PER_WORD=4,RSA_MODULUS_SIZE_IN_BYTES=0,SHA1_HASH_SIZE_IN_BYTES=20,SHA2_256_HASH_SIZE_IN_BYTES=32,SHA2_384_HASH_SIZE_IN_BYTES=48,SHA2_512_HASH_SIZE_IN_BYTES=64,OAEP_SHA1_OFFSET_IN_BYTES=42,OAEP_SHA2_256_OFFSET_IN_BYTES=66,OAEP_SHA2_384_OFFSET_IN_BYTES=98,OAEP_SHA2_512_OFFSET_IN_BYTES=130,MIN_PIN_MESSAGE_SIZE_IN_BYTES=17,MAX_PIN_MESSAGE_SIZE_IN_BYTES=0,ENCODED_MESSAGE_SIZE_IN_BYTES=0,DATA_BLOCK_SIZE_IN_BYTES=0,HASH_ALGO_SIZE_IN_BYTES=0,ONE_PIN_BLOCK_IN_MESSAGE=1,NUM_OF_NIBBLES_PER_BYTE=2,MIN_PIN_BLOCK_SIZE=8,MIN_RANDOM_NUMBER_STRING_LENGTH=MIN_PIN_BLOCK_SIZE*NUM_OF_NIBBLES_PER_BYTE,ENCODING_PARAMETER_SIZE_IN_BYTES=16,C_String="",P_String="",MODULUS_STRING,EXPONENT_STRING,isPublicKeyDataValid=!1,encryptedMsg="",MOD="",EXP="";EncryptedMessage.prototype.setPublic=function(t,r){if(!(null!=t&&null!=r&&t.length>0&&r.length>0))throw ERR_INVALID_RSA_KEY_LENGTH;this.n=parseBigInt(t,16),this.e=parseInt(r,16)},EncryptedMessage.prototype.doRSAEncryption=function(t,r,e){var n=t.modPowInt(this.e,this.n);if(null==n)throw ERR_RSA_ENCRYPTION;var i=n.toString(16);encryptedMsg=0==(1&i.length)?i.toUpperCase():"0"+i.toUpperCase()},EncryptedMessage.prototype.getBytes=function(){return encryptedMsg};var PinString,PINLength=0,PINBlockByteArray=new Array,PINBlockLength=0;PINBlock.prototype.getBytes=function(){return PINBlockByteArray},PINBlock.prototype.ValidateAndCreatePINBlockByteArray=function(t){if(null==t)return ERR_INVALID_PIN;if(PINLength=t.length,PINLength>MAX_PIN_STRING_SIZE||MIN_PIN_STRING_SIZE>PINLength)return ERR_INVALID_PIN_LENGTH;for(var r=new Array(MAX_PIN_STRING_SIZE),e=!1,n=0;PINLength>n;n++){var i=t.charAt(n);if(!IsLetterOrDigit(i)){e=!0;break}r[n]=i}return e?ERR_INVALID_PIN:(createFormat12PINBlock(t),ERR_NO_ERROR)};var PINLengthInBytes=0,pinMessageArray=new Array,pinMessageLength=0,MAX_MESSAGE_SIZE_IN_BYTES=0;PINMessage.prototype.getBytes=function(){var t=new Array(pinMessageLength);return aCopy(pinMessageArray,0,t,0,pinMessageLength),t};var encodedMsg="",P="";OAEPEncodedMessage.prototype.getBytes=function(){return encodedMsg},OAEPEncodedMessage.prototype.getEncodingParameter=function(){return P};